<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>其他</title>
      <link href="/2022/08/03/%E5%85%B6%E4%BB%96/"/>
      <url>/2022/08/03/%E5%85%B6%E4%BB%96/</url>
      
        <content type="html"><![CDATA[<p>杂谈。</p><span id="more"></span><h1 id="快输"><a href="#快输" class="headerlink" title="快输"></a>快输</h1> <figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123; <span class="built_in">putchar</span>(c); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123; <span class="keyword">while</span>(*s) <span class="built_in">putchar</span>(*s ++); &#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T, class ...ARC&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res, ARC ...com)</span></span>&#123; <span class="built_in">write</span>(res), <span class="built_in">write</span>(com...);&#125;</span><br></pre></td></tr></table></figure><p>什么都能输，字符串的话传个首指针即可。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 其他 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>类欧几里得</title>
      <link href="/2022/08/03/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/"/>
      <url>/2022/08/03/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/</url>
      
        <content type="html"><![CDATA[<p>求解$\sum_{i=0}^n\left \lfloor \frac{ai+b}{c} \right \rfloor$之类的式子。</p><span id="more"></span><h1 id="第一类"><a href="#第一类" class="headerlink" title="第一类"></a>第一类</h1><p>令$f(a,b,c,n)=\sum_{i=0}^n\left \lfloor \frac{ai+b}{c} \right \rfloor$</p><p>我们对此分类讨论：</p><p>1.$a\ge c \ or \ b \ge c$</p><p>考虑去掉向下取整：<br>$$<br>\begin{aligned}<br>f(a,b,c,n)&amp;=\sum_{i=0}^n\left \lfloor \frac{ai+b}{c} \right \rfloor\\<br>    &amp;=\sum_{i=0}^n\left \lfloor \frac{(a\% c+ \left \lfloor \frac{a}{c} \right \rfloor c)i+b \% c+\left \lfloor \frac{b}{c} \right \rfloor c}{c} \right \rfloor\\<br>    &amp;=\left \lfloor \frac{a}{c} \right \rfloor \times\frac{n(n+1)}{2}+\left \lfloor \frac{b}{c} \right \rfloor \times (n+1) + \sum_{i=0}^n\left \lfloor \frac{a \% c \times i+ b \% c}{c} \right \rfloor<br>\end{aligned}<br>$$<br>2.$a&lt;c \ and \ b &lt; c$</p><p>令$m=\left \lfloor \frac{an+b}{c} \right \rfloor$。</p><p>则有：<br>$$<br>\begin{aligned}<br>f(a,b,c,n)&amp;=\sum_{i=0}^n\sum_{j=1}^m[j \le \left \lfloor \frac{ai+b}{c} \right \rfloor]\\<br>&amp;= \sum_{i=0}^n\sum_{j=0}^{m-1}[j +1\le \left \lfloor \frac{ai+b}{c} \right \rfloor]\\<br>&amp;=\sum_{i=0}^n\sum_{j=0}^{m-1}[i \ge \left \lfloor \frac{jc+c-b}{a} \right \rfloor]\\<br>&amp;=\sum_{i=0}^n\sum_{j=0}^{m-1}[i &gt; \left \lfloor \frac{jc+c-b-1}{a} \right \rfloor]\\<br>&amp;=\sum_{j=0}^{m-1}\sum_{i=0}^n[i &gt; \left \lfloor \frac{jc+c-b-1}{a} \right \rfloor]\\<br>&amp;=\sum_{j=0}^{m-1}\sum_{i=0}^n[i &gt; \left \lfloor \frac{jc+c-b-1}{a} \right \rfloor]\\<br>&amp;=\sum_{j=0}^{m-1}n- \left \lfloor \frac{jc+c-b-1}{a} \right \rfloor\\<br>&amp;=nm - f(c, c-b-1,a,m-1)\\<br>\end{aligned}<br>$$<br>故：<br>$$<br>f(a,b,c,n)=nm-f(c,c-b-1,a,m-1)<br>$$<br> 展开$m$：<br>$$<br>f(a,b,c,n)=n\left \lfloor \frac{an+b}{c} \right \rfloor -f(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1)<br>$$<br>直接递归处理即可，递归边界显然应该是$a=0$。</p><p>则：</p><p>$$<br>f(a,b,c,n)=<br>\begin{cases}<br>  &amp; \left \lfloor \frac{a}{c} \right \rfloor \times\frac{n(n+1)}{2}+\left \lfloor \frac{b}{c} \right \rfloor \times (n+1) + f(a \% c,b \% c,c, n), \ a\ge c \ or \ b \ge c \\<br>  &amp; n\left \lfloor \frac{an+b}{c} \right \rfloor -f(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1), \ a&lt;c \ and \ b &lt; c<br>\end{cases}<br>$$</p><h1 id="第二类"><a href="#第二类" class="headerlink" title="第二类"></a>第二类</h1><p>令$g(a,b,c,n)=\sum_{i=0}^n i \left \lfloor \frac{ai+b}{c} \right \rfloor$</p><h2 id="小结论"><a href="#小结论" class="headerlink" title="小结论"></a>小结论</h2><p>$$<br>\sum_{i=1}^n i^2 = \frac{n(n+1)(2n+1)}{6}<br>$$</p><p>1.$a \ge c \ or b \ge c$</p><p>像$f$一样考虑：<br>$$<br>\begin{aligned}<br>g(a,b,c,n)&amp;=\sum_{i=0}^ni\left \lfloor \frac{ai+b}{c} \right \rfloor\\<br>    &amp;=\sum_{i=0}^ni \left \lfloor \frac{(a\% c+ \left \lfloor \frac{a}{c} \right \rfloor c)i+b \% c+\left \lfloor \frac{b}{c} \right \rfloor c}{c} \right \rfloor\\<br>    &amp;=\left \lfloor \frac{a}{c} \right \rfloor \times\frac{n(n+1)(2n+1)}{6}+\left \lfloor \frac{b}{c} \right \rfloor \times \frac{n(n+1)}{2} + g(a \% c, b \% c, c, n)<br>\end{aligned}<br>$$<br>2.$a&lt;c \ and \ b &lt; c$</p><p>那么同样的，设：<br>$$<br>m=\left \lfloor \frac{an+b}{c} \right \rfloor<br>$$<br>同上可得：<br>$$<br>g(a,b,c,n)=\sum_{i=0}^ni\sum_{j=0}^{m-1}[i &gt; \left \lfloor \frac{jc+c-b-1}{a} \right \rfloor]<br>$$<br>这里有一个等差数列（我愣是没能看出来）</p><p>则：<br>$$<br>\begin{aligned}<br>g(a,b,c,n) &amp;=\sum_{j=0}^{m-1} \frac{(\left \lfloor \frac{jc+c-b-1}{a} \right \rfloor +1+n)(n-\left \lfloor \frac{jc+c-b-1}{a} \right \rfloor)}{2}\\<br>&amp;= \left \lfloor \frac{mn(n+1)-f(c,c-b-1,a,m-1)-h(c,c-b-1,a,m-1)}{2} \right \rfloor<br>\end{aligned}<br>$$<br>即：<br>$$<br>g(a,b,c,n)= \left \lfloor \frac{\left \lfloor \frac{an+b}{c} \right \rfloor n(n+1)-f(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor - 1)-h(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1)}{2} \right \rfloor<br>$$<br>则：</p><p>$$<br>g(a,b,c,n)=<br>\begin{cases}<br>  &amp; \left \lfloor \frac{a}{c} \right \rfloor \times\frac{n(n+1)(2n+1)}{6}+\left \lfloor \frac{b}{c} \right \rfloor \times \frac{n(n+1)}{2} + g(a \% c, b \% c, c, n), \ a\ge c \ or \ b \ge c \\<br>   &amp; \left \lfloor \frac{\left \lfloor \frac{an+b}{c} \right \rfloor n(n+1)-f(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor - 1)-h(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1)}{2} \right \rfloor, \ a&lt;c \ and \ b &lt; c \\<br>\end{cases}<br>$$</p><p>上面的$h$是不是很蒙，因为它是第三类。</p><h1 id="第三类"><a href="#第三类" class="headerlink" title="第三类"></a>第三类</h1><p>令$h(a,b,c,n)=\sum_{i=0}^n \left \lfloor \frac{ai+b}{c} \right\rfloor^2$。</p><p>推导太恶心了，看着办吧。</p><p>$$<br>h(a,b,c,n) =<br>\begin{cases}<br> &amp; h(a \% c, b \% c, c, n)+ 2\left \lfloor \frac{a}{c} \right \rfloor f(a \% c,b \% c,c, n) +\frac{n(n+1)(2n+1)}{6}\left \lfloor \frac{a}{c} \right \rfloor^2+n(n+1)\left \lfloor \frac{a}{c} \right \rfloor\left \lfloor \frac{b}{c} \right \rfloor, \ a\ge c \ or \ b \ge c \\<br> &amp; n\left \lfloor \frac{an+b}{c} \right \rfloor(\left \lfloor \frac{an+b}{c} \right \rfloor+1)-2f(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1)-2g(c,c-b-1,a,\left \lfloor \frac{an+b}{c} \right \rfloor-1)-f(a,b,c,n), \ a&lt;c \ and \ b &lt; c\\<br>\end{cases}<br>$$</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><h2 id="记忆化搜索"><a href="#记忆化搜索" class="headerlink" title="记忆化搜索"></a>记忆化搜索</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> uLL unsigned long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">ARC</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, ARC &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">10</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, inv2 = (mod + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, inv6 = <span class="number">166374059</span>, Mod = <span class="number">1e9</span> + <span class="number">7</span>, bas = <span class="number">43963</span>;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, a, b, c;</span><br><span class="line">unordered_map&lt;LL, <span class="keyword">int</span>&gt;F, G, H;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">Hash</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (((LL)x * bas % Mod + y) % Mod * bas + z) % Mod * bas + n;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">f</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> <span class="number">1ll</span> * b / c * (n + <span class="number">1</span>) % mod;</span><br><span class="line">    LL res = <span class="built_in">Hash</span>(a, b, c, n);</span><br><span class="line">    <span class="keyword">if</span>(F.<span class="built_in">find</span>(res) != F.<span class="built_in">end</span>()) <span class="keyword">return</span> F[res];</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c) <span class="keyword">return</span> F[res] = ((LL)a / c * n % mod * (n + <span class="number">1</span>) % mod * inv2 + <span class="number">1ll</span> * b / c * (n + <span class="number">1</span>) + <span class="built_in">f</span>(a % c, b % c, c, n)) % mod;</span><br><span class="line">    <span class="keyword">int</span> m = ((LL)a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> F[res] = (<span class="number">1ll</span> * n * m - <span class="built_in">f</span>(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pw</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1ll</span> * x * x % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">h</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> <span class="number">1ll</span> * <span class="built_in">pw</span>(b / c) * (n + <span class="number">1</span>) % mod;</span><br><span class="line">    LL res = <span class="built_in">Hash</span>(a, b, c, n);</span><br><span class="line">    <span class="keyword">if</span>(H.<span class="built_in">find</span>(res) != H.<span class="built_in">end</span>()) <span class="keyword">return</span> H[res];</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c) <span class="keyword">return</span> H[res] = (<span class="built_in">h</span>(a % c, b % c, c, n) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (<span class="number">2ll</span> * n + <span class="number">1</span>) % mod * inv6 % mod * <span class="built_in">pw</span>(a / c) + <span class="number">1ll</span> * (n + <span class="number">1</span>) * <span class="built_in">pw</span>(b / c) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (a / c) % mod * (b / c) + b / c * <span class="number">2ll</span> * <span class="built_in">f</span>(a % c, b % c, c, n) + a / c * <span class="number">2ll</span> % mod * <span class="built_in">g</span>(a % c, b % c, c, n)) % mod;</span><br><span class="line">    <span class="keyword">int</span> m = ((LL)a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> H[res] = (<span class="number">1ll</span> * m * n % mod * (m + <span class="number">1</span>) - <span class="built_in">f</span>(a, b, c, n) - <span class="number">2</span> * ((LL)<span class="built_in">g</span>(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) + <span class="built_in">f</span>(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>)) + mod + mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">g</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!a) <span class="keyword">return</span> (LL)b / c * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod;</span><br><span class="line">    LL res = <span class="built_in">Hash</span>(a, b, c, n); </span><br><span class="line">    <span class="keyword">if</span>(G.<span class="built_in">find</span>(res) != G.<span class="built_in">end</span>()) <span class="keyword">return</span> G[res];</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c) <span class="keyword">return</span> G[res] = (<span class="built_in">g</span>(a % c, b % c, c, n) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (<span class="number">2ll</span> * n + <span class="number">1</span>) % mod * inv6 % mod * (a / c) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * inv2 % mod * (b / c)) % mod;</span><br><span class="line">    <span class="keyword">int</span> m = ((LL)a * n + b) / c;</span><br><span class="line">    <span class="keyword">return</span> G[res] = (<span class="number">1ll</span> * m * n % mod * (n + <span class="number">1</span>) - <span class="built_in">h</span>(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>) - <span class="built_in">f</span>(c, c - b - <span class="number">1</span>,a, m - <span class="number">1</span>) + mod + mod) % mod * inv2 % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">mt19937 <span class="title">rnd</span><span class="params">(<span class="number">114514</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, a, b, c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d\n&quot;</span>, (<span class="built_in">f</span>(a, b, c, n) + mod) % mod, (<span class="built_in">h</span>(a, b, c, n) + mod) % mod, (<span class="built_in">g</span>(a, b, c, n) + mod) % mod);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">rnd</span>() % <span class="number">100</span> == <span class="number">9</span>) F.<span class="built_in">clear</span>(), G.<span class="built_in">clear</span>(), H.<span class="built_in">clear</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="同步计算（faster）"><a href="#同步计算（faster）" class="headerlink" title="同步计算（faster）"></a>同步计算（faster）</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">ARC</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, ARC &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">char</span> c)</span></span>&#123; <span class="built_in">putchar</span>(c); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;&gt;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s)</span> </span>&#123; <span class="keyword">while</span>(*s) <span class="built_in">putchar</span>(*s ++); &#125;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;class T, class ...ARC&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res, ARC ...com)</span></span>&#123; <span class="built_in">write</span>(res), <span class="built_in">write</span>(com...);&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> mod = <span class="number">998244353</span>, inv2 = (mod + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>, inv6 = <span class="number">166374059</span>, Mod = <span class="number">1e9</span> + <span class="number">7</span>, bas = <span class="number">43963</span>;</span><br><span class="line"><span class="keyword">int</span> T;</span><br><span class="line"><span class="keyword">int</span> n, a, b, c;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> f, h, g;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">pw</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1ll</span> * x * x % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">Node <span class="title">get_ans</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c, <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node now;</span><br><span class="line">    <span class="keyword">if</span>(!a)</span><br><span class="line">    &#123;</span><br><span class="line">        now.f = <span class="number">1ll</span> * b / c * (n + <span class="number">1</span>) % mod;</span><br><span class="line">        now.h = <span class="number">1ll</span> * <span class="built_in">pw</span>(b / c) * (n + <span class="number">1</span>) % mod;</span><br><span class="line">        now.g = <span class="number">1ll</span> * b / c * n % mod * (n + <span class="number">1</span>) % mod * inv2 % mod;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(a &gt;= c || b &gt;= c)</span><br><span class="line">    &#123;</span><br><span class="line">        Node last = <span class="built_in">get_ans</span>(a % c, b % c, c, n);</span><br><span class="line">        now.f = ((LL)a / c * n % mod * (n + <span class="number">1</span>) % mod * inv2 + <span class="number">1ll</span> * b / c * (n + <span class="number">1</span>) + last.f) % mod;</span><br><span class="line">        now.h = (last.h + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (<span class="number">2ll</span> * n + <span class="number">1</span>) % mod * inv6 % mod * <span class="built_in">pw</span>(a / c) + (LL)(n + <span class="number">1</span>) * <span class="built_in">pw</span>(b / c) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (a / c) % mod * (b / c) + b / c * <span class="number">2ll</span> * last.f + a / c * <span class="number">2ll</span> % mod * last.g) % mod;</span><br><span class="line">        now.g = (last.g + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * (<span class="number">2ll</span> * n + <span class="number">1</span>) % mod * inv6 % mod * (a / c) + <span class="number">1ll</span> * n * (n + <span class="number">1</span>) % mod * inv2 % mod * (b / c)) % mod;</span><br><span class="line">        <span class="keyword">return</span> now;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> m = (<span class="number">1ll</span> * a * n + b) / c;</span><br><span class="line">    Node last = <span class="built_in">get_ans</span>(c, c - b - <span class="number">1</span>, a, m - <span class="number">1</span>);</span><br><span class="line">    now.f = (<span class="number">1ll</span> * n * m - last.f) % mod;</span><br><span class="line">    now.h = (<span class="number">1ll</span> * n * m % mod * (m + <span class="number">1</span>) - now.f + <span class="number">2</span> * (<span class="number">2ll</span> * mod - last.g - last.f) + mod) % mod;</span><br><span class="line">    now.g = (<span class="number">1ll</span> * n * m % mod * (n + <span class="number">1</span>) - last.h - last.f + <span class="number">2ll</span> * mod) % mod * inv2 % mod;</span><br><span class="line">    <span class="keyword">return</span> now;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, a, b, c);</span><br><span class="line">    Node ans = <span class="built_in">get_ans</span>(a, b, c, n);</span><br><span class="line">    <span class="built_in">write</span>(ans.f, <span class="string">&#x27; &#x27;</span>, ans.h, <span class="string">&#x27; &#x27;</span>, ans.g, <span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 笔记 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>线性拉格朗日插值</title>
      <link href="/2022/08/03/%E7%BA%BF%E6%80%A7%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/"/>
      <url>/2022/08/03/%E7%BA%BF%E6%80%A7%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC/</url>
      
        <content type="html"><![CDATA[<p>rt</p><span id="more"></span><p><a href="https://codeforces.com/problemset/problem/622/F">题目传送门</a></p><p>记录一下。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">ARC</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, ARC &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">10</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">100</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, k;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = <span class="number">1ll</span> * res * x % mod;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">        x = <span class="number">1ll</span> * x * x % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> fac[N], inv1[N], inv2[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k + <span class="number">2</span>;i ++) fac[i] = <span class="built_in">qpow</span>(i, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k + <span class="number">2</span>;i ++) fac[i] = (fac[i] + fac[i - <span class="number">1</span>]) % mod;</span><br><span class="line">    inv1[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k + <span class="number">2</span>;i ++) inv1[i] = <span class="number">1ll</span> * inv1[i - <span class="number">1</span>] * <span class="built_in">qpow</span>(i, mod - <span class="number">2</span>) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">1</span>, pw[N], pw1[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">calc</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ans = <span class="number">0</span>;</span><br><span class="line">    pw[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= k + <span class="number">2</span>;i ++) pw[i] = <span class="number">1ll</span> * pw[i - <span class="number">1</span>] * (x - i) % mod;</span><br><span class="line">    pw1[k + <span class="number">3</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = k + <span class="number">2</span>;i &gt;= <span class="number">0</span>;i --) pw1[i] = <span class="number">1ll</span> * pw1[i + <span class="number">1</span>] * (x - i) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u;i &lt;= k + <span class="number">2</span>;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        o = <span class="number">1ll</span> * inv1[i - <span class="number">1</span>] % mod * inv1[k + <span class="number">2</span> - i] * ((k - i) &amp; <span class="number">1</span> ? <span class="number">-1</span> : <span class="number">1</span>) % mod;</span><br><span class="line">       u = <span class="number">1ll</span> * pw[i - <span class="number">1</span>] % mod * pw1[i + <span class="number">1</span>] % mod;</span><br><span class="line">        ans = (ans + <span class="number">1ll</span> * fac[i] % mod * o % mod * u % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (ans % mod + mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, k);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    cout &lt;&lt; <span class="built_in">calc</span>(n) &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 数学 </tag>
            
            <tag> 笔记 </tag>
            
            <tag> 拉格朗日插值 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF888G Xor-MST</title>
      <link href="/2022/08/03/CF888G-Xor-MST/"/>
      <url>/2022/08/03/CF888G-Xor-MST/</url>
      
        <content type="html"><![CDATA[<p><code>Trie</code>+生成树。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>感觉挺妙的。</p><p>首先我们考虑怎样合并最小，可以发现，当我们将这些节点建成$Trie$树时，最优的方案一定是每次合并$Trie$树的两个子树最优，为什么呢，画张图之后就可以发现只有$n- 1$个节点有两个儿子，而对于每一个叶子节点，想要合并到联通块之中的话最优一定是在两两的$lca$处合并，所以我们对于每一个存在两个儿子的$Trie$树，从它的两个子树中分别找一个节点，使他们的异或和最小（启发式即可），依次合并即可。</p><p>一个卡常小技巧：将节点排序之后插入$Trie$树，这样$Trie$树中节点编号更加连续，常数更小。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(c &lt; <span class="string">&#x27;0&#x27;</span> || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>(); &#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">ARC</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, ARC &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...); &#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">10</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>); </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL Inf = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="keyword">int</span> ch[N * <span class="number">31</span>][<span class="number">2</span>], tot = <span class="number">1</span>, l[N * <span class="number">31</span>], r[N * <span class="number">31</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> root = <span class="number">1</span>;</span><br><span class="line">    l[<span class="number">1</span>] = <span class="number">1</span>, r[<span class="number">1</span>] = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">30</span>, op;i &gt;= <span class="number">0</span>;i --)</span><br><span class="line">    &#123;</span><br><span class="line">        op = (x &gt;&gt; i) &amp; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(ch[root][op]) root = ch[root][op];</span><br><span class="line">        <span class="keyword">else</span> ch[root][op] = ++ tot, root = tot;</span><br><span class="line">        <span class="keyword">if</span>(!l[root]) l[root] = id;</span><br><span class="line">        r[root] = id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(depth &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> op = (k &gt;&gt; depth) &amp; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(ch[x][op]) <span class="keyword">return</span> <span class="built_in">query</span>(ch[x][op], k, depth - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">query</span>(ch[x][op ^ <span class="number">1</span>], k, depth - <span class="number">1</span>) + (<span class="number">1</span> &lt;&lt; depth);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">LL <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> depth)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(depth &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">0</span>] &amp;&amp; ch[x][<span class="number">1</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        LL ans = Inf;</span><br><span class="line">        <span class="keyword">if</span>(r[ch[x][<span class="number">0</span>]] - l[ch[x][<span class="number">0</span>]] &lt;= r[ch[x][<span class="number">1</span>]] - l[ch[x][<span class="number">1</span>]])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l[ch[x][<span class="number">0</span>]];i &lt;= r[ch[x][<span class="number">0</span>]];i ++)</span><br><span class="line">                ans = <span class="built_in">min</span>(ans, <span class="built_in">query</span>(ch[x][<span class="number">1</span>], a[i], depth - <span class="number">1</span>) + (<span class="number">1</span> &lt;&lt; depth));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = l[ch[x][<span class="number">1</span>]];i &lt;= r[ch[x][<span class="number">1</span>]];i ++)</span><br><span class="line">                ans = <span class="built_in">min</span>(ans, <span class="built_in">query</span>(ch[x][<span class="number">0</span>], a[i], depth - <span class="number">1</span>) + (<span class="number">1</span> &lt;&lt; depth));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(ch[x][<span class="number">0</span>], depth - <span class="number">1</span>) + <span class="built_in">dfs</span>(ch[x][<span class="number">1</span>], depth - <span class="number">1</span>) + ans;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">0</span>]) <span class="keyword">return</span> <span class="built_in">dfs</span>(ch[x][<span class="number">0</span>], depth - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(ch[x][<span class="number">1</span>]) <span class="keyword">return</span> <span class="built_in">dfs</span>(ch[x][<span class="number">1</span>], depth - <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + n + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">insert</span>(a[i], i);</span><br><span class="line">    <span class="built_in">write</span>(<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">30</span>));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> Trie </tag>
            
            <tag> 生成树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>强制在线莫队</title>
      <link href="/2022/08/02/%E5%BC%BA%E5%88%B6%E5%9C%A8%E7%BA%BF%E8%8E%AB%E9%98%9F/"/>
      <url>/2022/08/02/%E5%BC%BA%E5%88%B6%E5%9C%A8%E7%BA%BF%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<p>感觉好牛逼的样子。</p><span id="more"></span><p>在此之前先放一个莫队优化。</p><h1 id="奇偶性优化"><a href="#奇偶性优化" class="headerlink" title="奇偶性优化"></a>奇偶性优化</h1><p>对于奇数块的右端点递增排序，对于偶数块递减排序。</p><p>$10^5$的数据大概可以快$150ms$。</p><p>然后才是正文。</p><h1 id="强制在线莫队"><a href="#强制在线莫队" class="headerlink" title="强制在线莫队"></a>强制在线莫队</h1><p>跟分块没有什么区别，先将序列分成$\sqrt n$块，预处理出每两块之间的信息，然后每次询问找到离它最近的两个端点移动即可。</p><p>其实就是在序列上平衡的放$\sqrt n$条路径，这些路径都已经被预处理好了，每次查询时只需要找到曼哈顿距离最近的路径即可。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 莫队 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test/2022/8/2</title>
      <link href="/2022/08/02/test-2022-8-2/"/>
      <url>/2022/08/02/test-2022-8-2/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="0e4512de84d6b43057d2fd915d276d0af927f7bf90f775e00af128070d179763">f7c84d52981e04730e0cb33ecf03c038910740211be4281c6f3eace9abc81e1ea11c0745fa7f4ddb00c85c6cd520f02ea0992689e0881866141a7ad9d087ab009df270a92f271960675ba1a2bde65b0aa85bd305c0bc42e0f9d51d1afc3db4852aeda9cd90038874dfef200d5ac945597309f5fc21320715729ef3adbcc0a261cf0d5817773ad349c41924faa46c115f939bf18ac30c19eb8df2c20a548e5ebc7b1eb06d11308bb741c54e6b5e9d03942d9c4b189f98ff2b0cf542ae72dc3aeda9f2e109bde3cfc680497a1e627f3b6ebb94dbe57e1c84a29da89477f03c55b8231eaa66201a8f693358fbe557df6039815ea805191e27f831144b55cbfe9c4bbf6f64add02736f9db2ada1d3fb273806e947941ca59457fecd0032768951b7eb103ba2667fb3121ec4907e13f20c1d1a9615af1ac71049b44a83a78012b4a5ebdd9f1dc6f6643ecd8020b8157f99e0922d54e7b0868087690b507f246b18b32788c71e3764fe998da063dc85f1939b4500e1747e079fa376aaa52cc1cd069f11dc7a70d4dfc85610a7a1ffb783f4e7b7ea8d483a46c7934526f03c34a41d60e5c0a621185fe9fc565a4c7348ec0c38d884be2d96798a7fa376052d4db7aa4129e4af81747d861c8b28c14b488690fcb7b24bd729442d461ae4d0b44937b6ba3823da64df8e6acc62e86090cdf5cfcacbe6f7bfcb6eb192008e0d3ce3b1bc6a2de5fa96c6f56644eafdbc734c9823a3fd6194ac14883dc3ffdba93a418fb4373ebc4c6326f7ac2a0b6ad83fd020094487109d8310b0c0f9c3b1f730f0a222111bc28c625b4a7c077439e142a076fac38ba5ec881860ae1cb56883fd33554eb5b68394f960923e4beea7f192ae64f01fcd255f270642ad12df616dbfc3ce9872224748f1e4ddc0ec3b2021c539695be454c793dc9999d00a7284cc512b3cee36d844dc8e871e2300dd999ce6ec5cf1f3c03ceb2b99408333e439939e43e554a934adbe47e3195459641ec7bbd127745fbb2d07b1a4b00f7509983f4c0c3222b70251b6b4137b18c20796ae1e59f5f088593212738ff4ccf34a1388719eee16c053eeb0dd03ec3afa17aee978394a6ade0c2968100be670001ae7d51deea15f08760d1b6c3d144de6fd7ffd5a4f0b29bf82cdcbcdf16a62d82a17ab9c509beab358f9ef7cc770850a336d5641fc8707d50afc0cbaff2913653eebbe97947d24270e466ee642444828bbd6c9bdee68b5b7fb2cd04171e31da156c3931c898ab98a6b6f152abb09cb4d5668b0923d7d698d162ed29250a5ad8bedf4fe8dcae64855e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">パスワードが必要だ</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI2020 制作菜品</title>
      <link href="/2022/08/01/NOI2020-%E5%88%B6%E4%BD%9C%E8%8F%9C%E5%93%81/"/>
      <url>/2022/08/01/NOI2020-%E5%88%B6%E4%BD%9C%E8%8F%9C%E5%93%81/</url>
      
        <content type="html"><![CDATA[<p>构造+背包+<code>bitset</code>。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>牛逼题。</p><p>题目意外的保证了$m\ge n-2$所以肯定往这上面想。</p><p>首先观察样例猜结论，肯定是用大的数去补小的数，仔细想想，对于$m=n-1$这样操作在前$n-2$次就会消掉$n-2$个数，最后一对数一定会在最后一次操作时消掉。</p><p>再来想想$m&gt;n-1$的情况，这也比较好办，只要将多的菜用一种材料完成，即可将问题转化成$m=n-1$。</p><p>最阴间的$m=n-2$，我们依旧延续上文的想法，将其和$m=n-1$联系起来，可以发现将$n,m$拆两部分，每一部分都满足$\sum_{i\in S}d_i=(|S|-1)k$即可，这个东西是可以$dp$的，但是发现这么做显然不优，于是考虑再进行一步转化，对左右两边都减一个$|S|k$，原式就等于$\sum_{i\in S} d_i-k=-k$，这个东西就可以直接跑背包，这是可以用$bitset$优化的（<del>但我就是想不到</del>），首先将负数全部转正，然后左移右移即可。</p><p>复杂度：$O(\frac{n^2k}{w})$。本人跑的贼慢。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">500</span> + <span class="number">5</span>, M = <span class="number">5000000</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, T, m, k;</span><br><span class="line"><span class="keyword">int</span> d[N];</span><br><span class="line">priority_queue&lt;PII&gt;q;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) q.<span class="built_in">push</span>(&#123;d[i], i&#125;);</span><br><span class="line">    <span class="keyword">while</span>(m != n - <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        PII o = q.<span class="built_in">top</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        o.first -= k;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d\n&quot;</span>, o.second, k);</span><br><span class="line">        q.<span class="built_in">push</span>(o);</span><br><span class="line">        m --;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) d[q.<span class="built_in">top</span>().second] = q.<span class="built_in">top</span>().first, q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">while</span>(m --)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> minn = <span class="number">1e9</span> + <span class="number">7</span>, id_minn, maxn = <span class="number">0</span>, id_maxn;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">            <span class="keyword">if</span>(d[i] != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(minn &gt;= d[i]) id_minn = i, minn = d[i];</span><br><span class="line">                <span class="keyword">if</span>(maxn &lt;= d[i]) id_maxn = i, maxn = d[i];</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d\n&quot;</span>, id_minn, minn, id_maxn, k - minn);</span><br><span class="line">        d[id_maxn] -= k - minn, d[id_minn] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">bitset&lt;M&gt;s[<span class="number">505</span>];</span><br><span class="line"><span class="keyword">int</span> vis[N];</span><br><span class="line">PII st[N];</span><br><span class="line"><span class="keyword">int</span> hh;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pout</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = hh - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(cnt --)</span><br><span class="line">    &#123;</span><br><span class="line">        PII minn = &#123;<span class="number">1e9</span> + <span class="number">7</span>, <span class="number">0</span>&#125;, maxn = &#123;<span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">        <span class="keyword">int</span> id_maxn, id_minn;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= hh;i ++)</span><br><span class="line">            <span class="keyword">if</span>(st[i].first != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(minn &gt;= st[i]) id_minn = i, minn = st[i];</span><br><span class="line">                <span class="keyword">if</span>(maxn &lt;= st[i]) id_maxn = i, maxn = st[i];</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d %d %d %d\n&quot;</span>, minn.second, minn.first, maxn.second, k - minn.first);</span><br><span class="line">        st[id_minn].first -= minn.first, st[id_maxn].first -= k - minn.first;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> sum = n * k;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">3</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt;= n;i ++) s[i].<span class="built_in">reset</span>(), vis[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) d[i] -= k;</span><br><span class="line">    s[<span class="number">0</span>][sum] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(d[i] &gt; <span class="number">0</span>) s[i] = s[i - <span class="number">1</span>] | (s[i - <span class="number">1</span>] &lt;&lt; d[i]);</span><br><span class="line">        <span class="keyword">else</span> s[i] = s[i - <span class="number">1</span>] | (s[i - <span class="number">1</span>] &gt;&gt; (-d[i]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!s[n][sum - k]) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">int</span> last = sum - k;</span><br><span class="line">    hh = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n;i &gt;= <span class="number">1</span>;i --)</span><br><span class="line">        <span class="keyword">if</span>(s[i - <span class="number">1</span>][last - d[i]]) last -= d[i], vis[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) </span><br><span class="line">        <span class="keyword">if</span>(vis[i]) st[++ hh] = &#123;d[i] + k, i&#125;;</span><br><span class="line">    <span class="built_in">pout</span>();</span><br><span class="line">    hh = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) st[++ hh] = &#123;d[i] + k, i&#125;;</span><br><span class="line">    <span class="built_in">pout</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(d[i]);</span><br><span class="line">    <span class="keyword">if</span>(m &gt;= n - <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">split</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 构造 </tag>
            
            <tag> 背包 </tag>
            
            <tag> bitset </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZR2022/8/1讲课</title>
      <link href="/2022/08/01/ZR2022-8-1%E8%AE%B2%E8%AF%BE/"/>
      <url>/2022/08/01/ZR2022-8-1%E8%AE%B2%E8%AF%BE/</url>
      
        <content type="html"><![CDATA[<p><code>Rt</code>。</p><span id="more"></span><h1 id="Boruvka"><a href="#Boruvka" class="headerlink" title="Boruvka"></a>Boruvka</h1><p>每次选择一条联通不同的连通块的最小的边，然后将其加入生成树，合并两个联通块，共做$n$次，复杂度：$O(n\log m)$。</p><p>例题：<a href="https://codeforces.com/problemset/problem/888/G">CF888G</a></p><p>注意将$xor$改为相加之和取模也可做。</p><h1 id="树上背包"><a href="#树上背包" class="headerlink" title="树上背包"></a>树上背包</h1><h1 id="Best-Thm"><a href="#Best-Thm" class="headerlink" title="Best  Thm"></a>Best  Thm</h1><p>求$n$个点的有向图的欧拉回路的条数。</p><p>令答案为$ans$，$T(x)$表示以$x$为根的内向树的个数，$deg(x)$为$x$的出度（等于入读，否则不可能有欧拉回路），则：<br>$$<br>ans = T(root)\times \prod_{v\in V}(deg(v)-1)!<br>$$<br>$root$取哪个点都可以。</p><h1 id="拟阵交"><a href="#拟阵交" class="headerlink" title="拟阵交"></a>拟阵交</h1><p>不会</p><h1 id="斯坦纳树"><a href="#斯坦纳树" class="headerlink" title="斯坦纳树"></a>斯坦纳树</h1><p><a href="https://loj.ac/p/6433">最大前缀和</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 听课 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test/2022/7/26</title>
      <link href="/2022/07/26/test-2022-7-26/"/>
      <url>/2022/07/26/test-2022-7-26/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="b6fde309fa1f9806af6fa8b854dece0d0e8966622601060288ca78648b7ba811">f7c84d52981e04730e0cb33ecf03c03898e92a63adb4fac27ed03cc068ea609f7a1311d025fd3c2002f08ab2963bb98eaed75ce30a90ed21fc9f2cfe40a595f4459f31c17c918aa8c957f1fe0d98008587fb57a3c4a5f97819d0d26a4c0511cd1a72292d65e4d2b0d93eccd2e46c06dfd3021f543e5a48c49d44fedbe129a3b01065a7f560737124b721b5cec92664c96b0606f3a10867f71897fb27fb879312f0aa933f0aad3a51474d7c22a671e7dbd3887bb8dfb0751096adaeeefc861a29c91c86643740cc3df37114f38a079317cdbf197d1d4acf4f14c1f9071378256316d73c0f87190bf73c05510dc65f778fae4417c197c6797046b0df47ba5f5fa04a50da5c22ed25d6ce3b4d9eed609c616b43de724a403fa4b57d3341d71635202b9affb1bae71459ede2e38e916772cbcf6f0eef9e6c4fb9635e52e4f305c249f2e7def71c1338a855dcb18c0fed435d4c0d225f0aa2a6dfe4e79ddef418ec300c852fa32ea9b3b57857d46f7fe7741a1ad6cc861b768bb660f975f71850b1054d91c0a06be3687785cc7d889ff0cece271f120538403e692a7c8280ffe15b1044aa78d603c41f5c01e5e9eb9582d4cf02effb7c854ae9e2e49082c6efac55a314277f193d60f7d38520e450a661dfbb9433b6d8846b10947c71882d30eff731c1c8450a7a69f368585d5a1f7de563e13880b55339f9439ad6bb040deb55dd7b98924a1094accd6e727d0712316df9f60d47c8b322e37bebc7e81621f63bcd7f4cbc64ad695df9485983a17fd722f3db9850af42e584483da41b8484c095a7080f4bbbc342c7ba6b4686cd6f9206bdf13480c24d764da7d1093807e893224e7b439bc4ad4bed2d09fc06c837818242c836e55598e14c240fa2e75b5bcb1b654fe942d6fbbe3c5afedf4bcedf35fe3845c88ad494636c572829e50f85223a781b26279935f33f0f7dc41b1981613f6a642736174df2c232f130c143087fb4b53101fc0293c8fb15996c05891921ca6a04258f5af78562f4ba742bfe87ebaaa56ed8d140a78e925a6959c4a64d70c9e3d09fd10309694f8143c100806ed108e87b66231e5287892589b00923c0d55d7eb32e4f6d726999c35e2b3c1c3a4f17913e5d1f52dc959cdfe4922aa5f8b859479469fdd67e90e2a1e863915609f302144ff324186605cd4e65a3a672696fce512ba0e92c38ef4edee5dd5d9455d44925389b98f082131d8a758637898ebcb996a041ef7ac878a257501cf6bbb31cbc20381b19b395a1c00bf33b7da8dc31c8671d033717571d3c155e01e2dbbdbe290de4341adcd57415d764377505fdc66ed34abd96a783f9d3f5f1353f18a4a636532196126c75d358c19c48ac8b0f0403b86b4ca3b79df5f5ee816d32f70e3b6a6d45130ee251b6182774ee33d753908fb8155971d2a0026d2e2262d803f0d3702a0730936b786bf34260f695bdd9f1ff1bb2d46c5b7721afec4b67ec800b11533069f0d443dd7223801647c64ca43e67eaecee5e6fac327688a35cfa09090cff5faf8b1aea0821241466da3b93b9cebf9cd5a5a086233f9e07d5f47d9bac0186ee665520c9d549d85f030efb7c1834e1912e4c27fc4c36aec6945afb7a04bdf13d1b3f104685ecf4828a6ad4b9c1f168b5ea92623317b807c42378d3185eb2de61af4529b75bc6addc24d3948843552e0fd751ac386ca1d01d70739c9bdb487e5f9dff0f3015b8e86bd652fe7366359d259e13abffcc20ebc4aed0d0523e19ec13e63c1b89c321424ca745a35379e889695dee8579efebd8f1a001a4c9fca768d6ca6a2431d7ac704717d9e9a48457be81b708d7fee4fa46ca64767465d27975b85369e58170f6d2588ba94d10bab2f8bc2c66c9cf7629917b2d6db3be705ce7f5c436a5b7c0a903ddb1e73804986e49113197023e4f9de5fc17cd2d654e9dd028f1c63484a94887f678c0b7cf4e369cdd332b5e4e1e84a4f3759112aff32aa276ae19c9f04918133cdb1597e244f59c80acbb5a88d655d31cadef024ec106e57ce2ca9c79e97a713ddd6b7d41175b2d27d593d31496c97a0432b67508318e68cb229e53fd2c7a5ad6576e0aa05a2a696598b6f9ddd8954a17e4582bb1ea2fa38d03390fcb6f0c64e18b0171dfe93ab5f6becaacf672285aa661f13d2335f76e84f9f9a7306984dcad2e5a5a050a8ae491f3194299e342cc7c3c70cceb5651a7ecf2ce9a54cbff19fde5846181bd3e483d638d8cd6a1d17384f3e0b99848807a48b3cd61bb86fb595e09b78b4b4414070c4726d70825471d6c4aad53eb01e7ea5c35b5a0ce4e72cf183e6c397bfdc1e5287c0c54314dc8321b87a34e12a239ac220edf76c4e3928a48e54f1079e0dc1f754186f6589269660124a4a871250d42d0f1f463f863e49bded5405c0a2bc15c39d4e5bed038a4d119a470561835732119ae5a1931723ecc404f945a6bfee23a9f489f66e7fb351978f6766a17b5e1d2f7d8fd2deb1c037fb5ff1cdb0721836a73d64c4aa9f388a7565458769348a949522c68804e6384aecf2bca7d337078b5711b55b756081e48a8726aae758f293673139bcda4332545954750fd1ce9bcffe802fd6601d2d4e91888bd89bc0ecd4359eaf85896c74991b48974e550026b3d36c8182eaecc2cfbac2ead162e9eda22752ce320f018f2ccc3b26c6358a7c02297e59e5258a9014293936c1022cf583fff4aabd2d9307203a0c8c0d49f23b5dd04d57ebd1a9f45be5cbb50162bc9f5ab14bda8edc9261e2da01c04a7cb86a5606750a7cac3603045c54e5a40d7a6e235f482982a51064045a3f471f16b8265437c78586b5af401b38c527efc9e6d888e841fd9ee3b9efc611a56116aa2d407394db1863dd6551dc42be67a45eeb231f43c8b92c09429e0a5342d2338847d186acaa5ccc6060a6a20f5ca2e0149d4ebafd2c947925b36b552caacb06851cd978efcbd39e615872d042e2355a360f01e73289115044a0bd8bc9b38c3d72a7980c50d361da647ab04e48ada270ff4fdafc79ed27cfeb49669141221e80a2feb5d02e5bee769f180d58ae830b2324f5550c8aa2e7aa54d61e0a846fd3c947791b8ed29951895f4d431d0f1d83cd6276dc05f23ef7f5c439870a46ec6e06afb26779a4e57393a2b7a2035e40b75a530cf8c1bfd4cc8d7657d6802211322bcb99db5cd0e526ecb244011fa4908385ff2ff05f35a54adc114a74944223a01f17a8ec36548ea0c187997118333338e11b1f4c6d472cf4e90065057b8acfa84c8f10b18d47fe313bc2da3acc2c9f4c85f6f0b658b28d9bf3672179cf1196af0559610b6cbddeb5daf59b823cb7a1477de3471ee33c1821304e4d6c657c87dfee1610865e622e77b07ae041ae6cdd5adf54c7790e0249a2495fe8a6fea791be474bd36b8323275729e29996f9c9b43bd8c5be60731698d310e8e8267498ed84959e780b15ea9eca67007b4192935eb928fff86257e401c099e97ed661ccf402fc7784eb20b149befaeb9c1e65a817e823c081dec6f9bee6c87f6f5981888b68ec2b656eba4325ac1aa3cbdca12a8a7c6129736ece5d0e175e85010a0dfcd7a7b56ae7771f43d6bcb52f70933a7c452be2ced7780a240d9591efc2d56b4a3d7003e4ae5519856dae932a4ae13d0d4d79ac30969ab82a3986445a0e3ff2a8c65460a07a854cf3a992fb36508df002b80fcbf66be954714303df11d7992615a8c8351026264f845ff1d3627c068876bf4f1a50f013181e9bf8232d07fbba10081ed4eee3b9c37a8e4e04c39cc04d456420e781fad0178709321ac2f217c0fbfe5c10c9d27a9889ab33d40307ced4d16c65b5a3d53ee4e193e7a7ba1987f6026c6b4bf20236130170d0244ea376a60f53f860de1c4065a29163b6a3294c0da3f45f9e4ed0004feff6566a6b84bd8ad5e415aa6166930231e936ac6684863c1f1d5b78f2267257addf03bf15dba236ca41a9b2ba3bf84e4dcc629227fcb37d673ca48048256716179b6fef7a8b0088d2cd683c87e025c6dc68317063a6ac75846253479c036f3885033c0ce0b7c58b5ddd6fb174417392850a0e9b689a396c9c1f2c3f5ecae3ffb2825d761db177c2163edf85eb7a84c8538099b37c4118d0f7c77d3380fed05f511729c6e984de7a8f9ad866061aeca2d3732913b2620b201421f063281856d092fe85a9c0ad06d304ddbbe5616eacd2951958d3fe4dc792280b368e61b49341a596f6434010c90839f0e80509e8231ab263b03e926c9435381d3170164a217bd93174febdeae69bfee696c10172bb7b4dfc2d012b47d0ba9aa588d6cd9a1b20a0841d860d9e701d601c5121e8f5cbb2c41c01cb495d413ef91cd06d877a231fc4186715cb254a7d6e8c7f33d501335d0fa60a68623c5575755f29e2024e93337df78ab8e81f259fcc2634b9ffdcc5f2525d0cb33cee69d57f586f1b4f990010b314b0f46405536c014b9e869bb14df12eed67b14ca46ce32653141e7a34b695ed6262e317b4c01bd2e0bfc18e7b00390e2cac1badec9e0c1a285b977df5db930ff7e51619bc5d9d1f76fe5d0f3702c776c1bfec88edab25523f89f8814f1f21aa717d418b37a64930bf2c0a7887cc15f0e5756ce74f340a180e4060afc51316cbe3bb7efc434a74cbec8e7503d8f1478ad908df6e7fee9375e85f4d7b27be0cde3cd28b288c038792a464a1b557c6a1a6666efe32d622353ecea9b38289471c2ecd75ff35bee8a3ca8251081060a3b5461eed87abd323597430fe0c2bc5f19a1751dcaabdc3373e9680ae08b6017d0c1503208e6386b6a3201954f237f6afb04e070a3d0630650db857ad7de57078aecbcc2f849e5d30f257f7bc88f6ed505b1d4ce0aedf28e9ad86226f34f39d0db7157b1a9d7a805df7761ab609ee0ed1516f50cb7031c4ebc0c03c4f4637ba96460c12c7397328709a6b9dfbd4ecc856e5ac4568bea20dd82347df6a4b3577dad848db510556a0c842a4d54df94b69e551e4248daa4ef7e11cab2adfab70a41774013b036de622b36e27d14974bac79b02f7f202560ffca4bcf9b95fe767732348499dcc66af6de140ba8c5a1d25050e69ba42313a4dee482d725bca05f7f84ed4ae944eeff2cde1c23db75c82fb8ff6496e53d31608b0400cf4b03ae62c1e837640f1abfe55fbe134b5fb73215353d5328c90121624f8157e70e05273eed16daa25fe8ba5f4041499bc427ef34ebc3f7fb24ab8b7cbc2325f5d8516206656ef85accf51ae0c13b16cdce78b8abef3b969099da09e4a3268c4ad3a331643d2cf9a183dcbc9cbe6f32668b0055d690a83edc6c9a1159e8c12df4e3bc132e702908f94e5911cd93a514bbd7491da82fc8ad252156ccfd2d2bd6edbfde46d2d916dab5d94a5f7ec208ce1b339c1c5fe732d02cf795e8ab048b60f9c292ee37cdc6d691cc75294d874eaebc6653983947ed67df91c0b1c70236d8a0c52f4c9d19b84ee84286b6dffb95ec5da6230dba710fd63010f7b1871e263d628a965cc15e5dde800d0de45c495df5e6d54330e4940397be7d1d8a78d9b65d9c20f16c880df4ef4dc1e0c3c3fe59dd04ce4c8325113eee1aa3aaa78de446f210b34f63d88bedf89e49ea94f8d0ee584c973e3a5c4bcc9ac5f42588d11f143be2a12783a3151e2caacd7e97b61c8ca6a2af552579a4ab92d675e0b18359ba3b41c38376c0cde1010e04bd3f1a3ab782b65099185b429cf89308d1ba0664cf83f6aa423d7ce956f027c05d22675eebaba6162b07142bf4e82bba5f647a1db2609dd21e34988842869e93360ee63c5d1b76b2b7524d6ae872fd157698bc81ea0597a95f506a0134830c2f7ee84b6bcece3f5bceb82fe3d5151025bba313b6f209dd3f8fe7a88cccb0d51a4106233bd7c36cd05c715dd2b9452093274c5c19d1e74361f4f9fab0c0b30dfda926709198abccceb3d6241711fed14f626f4217ce17507291e319aa5fd935f81610c7c51b2fcf3bfc0b54119ac918f6365272f03b85c10ffcd1b8a2fdf2de6842a4d94d99115472dcaf7ff0e8488bafba5ec3851b6b8faf462e73bdeaa935892771348b43e36d5ee37db7bea206d202298bb26379e8dd59dfd020cb043d121f3796f70354c10826f14e2550c9465d14c66c6a4ab3bf7818bb54432c1ad88ca32b868813dd527866241e88b16fedf4a5d6fdf403336b382eea4fe9f8f67fbde81804383d325b12f766ef9bfd5b33e7311a5f8ffaa784c16f553151ee00ba035d4c683bccf6516202b215597f4f20eddfd1f6d4165f087f7e1752f3c777835c4a42b2676b7d2cb7c8e690b2bfb51f1bf31fe34b08638c90ae91f640a1d7107719592d77814a0c2cba1fa3b1357c61f155dcd0faf540ef587dfbd6a4990e2beb07b317dbe36e74c88e9cf79dea40ce4b1813782a91efe4c095c1b2e1dcb976964142da410224515aec950b6cec328d357169907e1fc2c3816c2444b494ca6ecab924b0af5bd94a2be1c016f4ac9dcbf70922ffa89c5c3ae836245798833e23037c2079a0c568ab7a896b4fb6a44f5df230b9506dbca959e096381ba7c2d7377b61d826b56f55f6d478eac9e57acb45f5e87804291c9e64340beffc31cbe7c378097e258285e629f46a955f059fe321e2e7a1523304e2650c5e5a3f4ac1715688abff773817bccb30d14c94326aebbfb8ccc1c8e782c40201f9806bef6860ff891e18a26dc157abcf1a572899c15fb687140cd35232bfc8fa0028cbe032963f255b3e19a407e8566e58dcf05d0fd72380f6bd5f3c4ec107266c4bc2df492d703571cf25eedca24505b5baf2fd4ecfe0e6e5a84e26665afdf0b5d40026f783aad96a925e8c9c900ac45dafb6b613beeb666e87779ba27bc834ccebb049beecd64cd27433a325af396788269816632c994f4d5855e39977ddb2a699f3f89d14d9439b3d8f90e619d3811cca710c25c316d193e39b3c89c744188a65b83f3880098807ef3360aef81d93f971938b9c55380ad0909619a2ad5ce523f249e57b0ecbf197ac762e097a56e41ad9bc837e228e6351c45d6b889212729c7870872a98c108808e51c07d83c00b83bca00859368dfc5fe4788381646898f82b76529800867d406bb2939f530325279098fc109b9172aaae0965b597dd41f350bf50e69edbf74872f419a1f511e7bc535efa62f8a8a8361e6b6911bdf4011b09dc5724bfda7b244fab33807de8f0cabfff3a95236570581f1a7c44f7165281ac2a71b9f26c8843ea4b22143eb1b8838ec3c581f26e9e46f2f8686c2a7b2f5ddcdc457133ef7d7c8ce6ee3d8d25e2601d8bd4d4fd0eba93b74e9929aff920caa1257d27a642eab8f7aca2201045bec3a4ef089785f5735d7ab1fe040e1c717daa3235dcf7371cd101ff743236d02f6f9d4ac52643dee75eab0bb476ef04027f5e064f69755433a421bd36813d43f9612046c5f1f25eb382eb6f70ada8f3cd646e820227bffc5df59aca3ada96b10c83f98ce4f4101d739cfb69e4ea4e67178870a755efa9e415f3674cbf0b2718ca5699b3550847c014b5fcd759965cd83c96c9bb2782f01924079cec743b9a7ca6eeadee8a2f0353057516712215989b506185faaad0e9e9069070a6e93ac274bbe04496f8838c06ebabdae4989c98073d02fc1f92e6370e151c2d70e1526952c61ed9a7fba8101efbb1e52c565a418abb35f580997c343aa62b6ee994c6d5a492c957567db75a76618e8032471bb00aadf2e7d9eb632b4af06dd4c617b0ff50bd6a34cb7fe8473d6d82a16972d3ae11c0f8867e8f188907a727a23a14323944b513c967f10800f528c1da67c43b9b7a61c1fcb65f8721c7d0ab1ad4320159aaee460ce9c318db053b75382f27593e5c1c42004d51185e2895ec80ad1f0691a7dfe18d2227140fe0f079704faaf8184e5d9949cf6fb8d4779cd078156e8e04c7da8c9516e652f4c3ab9dc82ca59f72ae19c41d5eef719edd02fae65ce3c6fd17f5b48ce29f9c49b572eaf9a1333f8b8101ad79d5beaaab4d0be004b011ca8d1db373cd61a682380787eae3bd24fab44d3939ad83a2b49590e727fbb8517f9c87e7610d7a29ab9469ad624dcefe099c5fc563b2fae099683a5466fb7af5510a072764023c0051b7bfd136b6ef1be6c86b16f12b25fdb27427f4de5d09a7c246f33b5d9a3038d0a35b3f0158d5db21003a36d817df55aed7342a04a4f124abda8dd1df3d116d0d07865dc34803ec77a43e294383450eb82d8c20e166b680194115475634c736466ea6491eae57635165e9045a2f632d5a42c0022769a2a628e4e262b67660d68c257deb56fc6cfa68a032339a2593194b0fa9c647a80b8bdb47eb40b231023f9c7e5851053ce91f1925610a6e870f45eaabd19cb7e5bd34b6463eb5577f7071554bab1d785bbbdab4d5342f8d215e5943a6016fc769976a5bac90774d8cd5e768bead3c3151ea5812b045b8a424e5b005558e40179ba0fa156600d9d1994092ef91995f0a99c1359511606fb200165128fd6490e6598d707880737d58b9c97eb1712a70221ec4ce5582b68fdf62fa2f4b3b2319a16cd272e4fd6a180ca2aadbd7376eb0fc1afcaae06e3a67ff7263f348164111366d62332521c8c3daa37a15a92ad034d0e9cdf64c5def630955f37937f5d8e32b5ca5b0249e1dca0cfd6c43fc6b1565dc70aa36185414654305290108516010ad50822f455529d6f11dbc0f858524eba0eee394ebe4bd817400af045d49e0bfbd2bbb40460e2c38870a1c28bc13c20ef8dabdac52cc97abc565695483b14784510a508907d54932c9a4c999e2ab06f0e09cdaca76489be31e2176dd1c57c6d9e98a08e1b525db216bd6467a59e0eb7ff4d3ae9ddd346199ed89f26dae9fb21d884e4353ba22f0a7fa8c05f3e50c8d8086a9f96f1e1cad5b88c18ecbe8237168385678c2b7347c5ebe0e9327e85644e625bd1a4f1d62f965e8f0bd20e5b9b08dea85fbe1d71d3d2e43bb8a6f9483fd86119a342c1e65fac45844297e6da80937fc6bd4e3a8410d8e9e5590b8a6caf892c60b50e4fbfa0b6727bd05d62c2ca5cd4f9f1b228824b1c6d6e405598737a82ccee2c506fb22ac4ada4af94762024888cc778b04f21d4684d47172d50c35f5d6ac1579acd93e8f62a0d1e7bf43a2a3c4cf14bc7c1faf9281c9f6eee313a7538987a404f54083fc6ee97c30454cf3a3862201d41f332ca70cfea56f54903fcba1edeb406cc56b715f6a6b567d68d92f6603bc32fe15e454d425041621101669c2c1a15a2e2c2db705c83ec0794f36bd6bf7c8949a8f78947e7ca0d269b5dba5309f0c2a033a6187c21d7b8f5522eea6fcad43c79c34d03ed8a51799523a5bf568b912c33ba40e376a322ee6af0ef413b2ed5830eb971c3a3defa32f8c28edaba696c65c6054975a2a33568a4b5d14cc878165da7bf58d0524514f810cb770a108afb1f75b675d2f40557a2b49b29183840746e070aecbb2c8af7ff4e45a3d37758bb092b80857945dab604da28d50ca58567328130a32097ec1cba909f2c2a760b79fda13d305ef413b437afbe1e95a633ffb6f7aa11f97eb33dccbcd2156c41de902c4f0af2c54c32d869517a3151daa0c45a6a44ae90599706808b7da2f554ab1f7963239acb8bd996ec7801a612f20d5849aff30a12737200a33892e7026daf67c4d14430d4600710192e91d559ddec5bcc82bf9a237c088c90e3ebbefbc8dec20a6791b5473517418f3836022383f1d774a4a89313f4c6c62154cbd79903ce2226fffca718a31881fdb4eb642f5919d7932f9cc8a90b061dfc32731a8d463531dcac4daeb29c7dbe4ccd4704a54e9e5aa3bf9d911acb3fbcc7662e27788163763c7af64c0cf4e53616e4a76cac945b4cd572b2561772e933a10da9befbeb4d614ba166ba3d3537c4e6491aa63fe2dd6fe5f1a208d8545740556d857221f4442d1c96b7c6c73ce52bc65fc3ee7199cd7b138519b7b0a044383191e5ec434858dbf464d8ad0014bc1dd571754af341d43b05237de1d83001f42ba5dbe7b74d9d6f196609520ea1b2f8fe25cc10b312fc5d6e85f320cf5d4fb07ffe0db5ab4eee86b4466cfff243286603546d6aeb0b2ad043ad3133fbf42dba08e9cc64beac9740027538bea78e6bd0517f2430ecf8807164aeea503bcc464397846c0c9d1718c48283e334311685d30fdc8f2239eb98684b0e06e01aee051e9c042fa219586103e14e4dc9565937deb2738a06eee22a41ed6eddeba0cce7bfd04e1336ebf8bf508b57bdf52f9481bbf19d9259c562895d0604e6da1ed42f3b6cd4ce8aba626983128430f1429cf1e96789447206a4766c801fc8234112e2c5edceca7e03a007e6312c9384bbe47ff8b79d52c2f3c13c09a60c70dd6607befb3726106dd583aa9b975ab0fef8d98c3a58f476b40fea961b02116cd03ae7b4f9062ff1dcab81f3ef3214da6af601c804e2757e6a688e06f053eb67a6d2cf8b912757aa9fcf8ec3008d1c3f45ef996770891ba3d72411fcab2930fbfa3c8463355a66605d687012e01a85aeb6cae0ba8658dfdb2b207715ba7d76ba01636252182d611f47a88c5164760b0446b6a819c775764ea1c3795554dabb213d14d9dd2f2aaebc93808bdb36b412d02df757806e2b3e9924fb2f31fb9c40e0b5fea84797829952af9d14bec891123767087c9748fb489c0ff5636376eccea885884a4583bb12c0b8d0472190584d21dc21680b007c6f772d28d759da351d9273c1976912614b0157226ab2ecfc41a0245729b77b1112ba683e9ab3a6dab1844d50e80d31fd6f621b92a050d96886977506551c5b4204a70c6b2fe4be62511f58b1428f9d113b99cb261754170b8f0550e3a8c09784116ba3cdacb9539b8ec928ec51703ba0c70a19458c2f47e7c18008b3f24a80d48d2037132d5fcc1b01233502d27dbe00bacc90b6250276e4f3df7e228354ef439048ba3f9c95e1e0ef70955b0a02415c4ad8c49519cbb909ec73153aa684aaaed42f912497c38e264249825d507273afddb06c158940ffcf883e28ce74d95053fc9ec572021c6ab1b4575e9dae96ed90768d0d38d6c4c6799ed619b76e02ba612d4fcf90c7d2714c55089d6007907490d6e54faf5e6375861225ae10062bf36d5215ee5ae3ca0d48df1de2a432cd71284ba3744d890649733374f11d6799274f941dcd84d4164eaac918f321275cd6381eb027454bd5588df04c9653a26a1bfccc3fd578db41ce2818e27390a8df1dad093d66236c35a76e257872527b5dd3ba07a88bfd915db2ef21f47ab36a9b9cdef47576bdfa2dcd648da6a768f1b39dcc7906bcf26c972ff07be8c32e5d52aa3245d66b9def8417a0ddf7295efa97bf11cfbc931102eb37b1f565dc3bf9253e6ac1821e91254e9d2e5ed16e13222a6d77427bfb0c827f2fe8ba38c2c30c2d17fb7838e14f7c4f6491bb843efb279ffe2d79f33d59dc09856275ed20567cf9084c4c8936d0196ce5e80c42bbce3e42b184984cc71843f44a16a4cc52f45487657db9c3998585897df32e735a3cede174b1a49e55c7f1500eff488fe8f5a89dbea6f1f8baa28e7afb45fd79fec95e3b70033d0742d6101c74271216a6584f96ca02fa59e6ed334aed11e536905d8b30c0c547d7c1dc1e8ac390202e53b927405b5e62eb35f3aad70389cdc52314bb473fabd002edbcfbff31e90d48a967f117f77d7d6a16bfb38b189c091519cafd80083208a454dce91431b0ac3ea5a097e1bcecbc211a6e8e7ec5321c492856fb0520ec9450a07efd6faffea4eb001da80b1296b7f28c1b6225020eb4e00b8caf51b2c1159a79ae377c07c38567af0675c13a276b561db4cc90cc03617485dbac9e1f17b3838af907755875756d0bb4d64f00d02995793fb2c30ca6936acdc5cc46ae4776a9cb7cbc456714b7bfdc44be200a67a9a8da68b8df178f0706c6cf69b5f1ceba094cec79d7248fffc289d16c8c7be9885b4071607220ae0bff19260de6f1da89997e82bdf07a40e650177ab1f440934d57be660853b8b37ad51cb72c9f971d2c97fca9d5e6adc33473205e12e46b7718521d770a43690cae9fbf6e6e51ceaac88f9afbe0eb60c04ae1f2c9bc9da044177b18795e052b1128bd547af8c633215c470207f568fa5f2d1de871b7ef92eaef0295114d089955d14a367682794a1087486e5770ef32ed15534f708f20c497268e7309cbdb6b8d7c4c20f01093ba5c28cc6ddcb7155b1733edb54631001b9f51360aef588a30f52ee4f73c85d8443b667ea0825b48c1fe738258f8e6840195e636a60b28d6f88286258fb7c36f4e5bf6e360e21b5d568432c8f8ce1c8065ff0a670a698bcdb3bdb088a39a1531dc382ca80effd8638f7fdd1503685e99b1f26bcb88469b76c8e343bb9f48826a2165df709dcfef3cc8b2ed84d29c82019909fbde9eb602dee48707fdcfeee76ca881ebb9fced4312a53b9c6bef750c75be8cb0d73a55a7b61ffeb376bf3c8680b69f7b40e0e43f99669cc9fef35e91ace8ec8a5e3d25206fc9c320ece49e98ad3aa6ca9a0b0f88b87ed8e94fdf7f136087333afed3310c4c9b268f75089dd58bb24b3dd6e82794e28fcb81680c974ce4b59703fda4711216b1c940ca2b72d26b696c6e9345c611c62b74d497495f2f53ba30846776df95e3d64046fc95e3d6688b7948da11299526241d8d6cdf0711480b9b27b58826a87600591e7354c5309e5e84038c90e5870b2928299d176f0dba2c8e0ca2641a952aaaae24571965bb100d662bf817c5c80e84401be6b173c3892a3c2f0d1b94d771631f863a1dee78c4571a933464a11acd1bff0c9afddcb0ae1002e7b6454120243cfb2a261b54033a567d02b7b5205d85bb6b9486501ff99ed98b31024a704a6d64c5c85c6b4e4eeae8975e14c11c55c43178b219a456db9245a4c81570ca9fca2e46bb781e7e00df383162173a02c4636140b33c7da85482494207cdc7cb556dedc5a0a0db2cc1de6df5f9a409cf2c643321a02e5913ea5ba357bebb585d7b7ca4dc6afcb053d9dcf525c3874ee668797a6cd9b2d1387a26ab4802c86f0745bc12022f93583304427f15872e9a8608fb0f1980995cc0d16b1486611ce845b0243a344dbb3b40a262e636621de822024b1b426cbc9035f86d53c5d71a48bc8d5507b01f724341ad935fd5668f83d52851f523983ecd788cd590aec0a53965189571d6519ae2f7a5c6b6a85bfe8e8d6befc6dace9e4c936ce6ed5ca22bf2cff7f91087c6f67feb9a78f2c87ab96648a5e87d354a24e7ae5601eeacf1c5e146d83217c4da04bfccd64809b09298de50892ae54aabd3ddcfc600c9b8bb34e9e3bfefdff98032ba3116a18d712971685b0692d6b47b257d4e6b384f9295798bf74507fbd76a7a5c1ddb831286a59857e3512bcf029152f9813eee1a5320a1608b57455aa136ec8a95ba511dfd3fcd5d1ad64c3fcb5cb9fd7f3c85711176ee2f74fed5a8d442b33c98abf481a567561cee45f67bf6564ac67ef3126d98bbd7cfabf06ed68032af31aaf9329c31dd7e893c1eab4197629a80ddc9181238f59421881cce6686e885b26238c1d58e2e3e8bba2cb4817305d8dc7c21c6999a9fbef8b1b0a05ad209682259f3847373c7cf34835fa9f362a5792965acb3b58cd4b59db0368fcf2c9117e11408ddf2f318301cb7e271e34ff42929051e69b74c15866c54a1e5cebac952dbffc075a6960ace4450fdaa4236814df3ee1dec015f39b6cad4958e0934d361dd16c3efebf49e1214f5217672cde45620531752fdb5bbf2bae9dc430967b0a4d96c673fc67a27ed230e0fe62c35fabaf60a55b31a1c94b9cc51909f84a211c9438f3017e1740faaf4ac3e166e5d0238bdb1be2fdfba8befbe6a4c8476cc7ba64c793e51b4128a90fd773eb56ae83c93f04edb20d32a2f5d33c663bf161811678e0256324413c1e0332a61314a9b4470f31490576d60d3f43e31992d8f8e55ea987c85f67dfbb48affef038dbe42aa883d32dadbd75f7d1ca799183da3bef49d0153d14d179efc8e5ca243d674d143ad0cf85a32dc1109c68cda15bd49167f63361ba256630a55185835450fa56deaf6d337f91e2bd7f1d40fc3ea3cc7f48b8053b17b4a56ca44626cdce195124e056be57cb5b7d9c63e592f249e34c4a8bc4291559d38f269243a2b439e657768148be2bd2241748c92bfcdbc34ebcfcdd63fc86534698fd5642f1157e035d354398f1bb52450dd61f7e70d3a293c963127e7fc66b6dbd725855e592de16dffadd7136705431f0336e0f452ddb9280b6e91847edbb88a8c790c19a61e3535fe9c8ee0d1b83ba3abc3bc0deb4b32e96a4820c92fee5d50191046734715f87904ad8c813c0f0adaf5c21c5570d1e06b82a94dfc6fdf1dbb2bf101950823fc8b9e163df39ac4be95f708a9413b6b5c756711c1b0e93862cb0cb36dcd08aba02d1f365a96930ab861a0da04cda2a8d71060f9f8efc548d37d80875fac30a613158b261ca8dc4338b439b8bd98165797845fcfaf2cbd65162b8efee330b5729590495acc142baea54da4cc610605bb00f6ac029b79b9338f2e019036665aeab65c231e4df9baf8fd274d7b16a2954da4e99090da1ecf973cd9fa7790cddc2405620404f0ed89fd166dde9dc513d1df947996b4850981e0cc627100efa0d25f31c2c463be82d0f69a856cf804e5a728af2771aa362ea04dde3cc5a6c15149fe8c80ae3ed14959708313ac803201f20fd58e9a6c6987448d3688b63eb3f920710737b736ebc4fcb4d666968225627f0e1aa76d5d8a13f99b15e79448d767e14ab8fd7bc4fd538fd8869ffa1f5e724c9bd0a5c9bc735f1fd93ad2a0158ef87c53a9401f6a0f9f9e750ab8ce3ce9c622d3f75f76d429ce87061e1c1f694f8855d3b769774d56a6ada7d49d862aa2a60767f4eb91bc230f7ca6e1007a0522236dfbbc2b989ae418b80c6163da50c5b91ecd2b1f58c94bd1a192b3d0e0c019b738a598d97ce32a592e44a1e48a4c40177d4bf9071792ca76262b5f04f2f534f1252eea61faabd78b5758633fdca386e47af67ba9122d3a598ebc2f500da48eaddba03361490efd56a68ba2cfc76a0d4af8e2303a91ffc54f81f96b224e815825b35b3915c37e3a11809cb7962b31ad1789d64492020336cd55de7199ff79ea5a5b5b7cbb958d26cfa2afe0f6342da22a880008485b29a30cd393715519a1cb510d30a2c78febed7e04b6be62f2ce79e19b04d85ce85e27e1a19a21bd6b372cb59ffd28c3bbf93120ed90021b158d1619332996bc2f86953ae17d0dc7ea66f87ba75493928b2920690b3d4e16f899202fd0a9a181168ffd779e453984a36d313ed1f23a94d6f305934f080b0dc846bc6d06a6b5228eb0a11ecebf6eba15a022fc24c73f536823103056a23372dbbe262bba8df9b64db56c852e4dd71c00373d4337583c18c1342b7c9aeb883396402308fa5fbbd625b8dd17bdc6108ed1ba0aebe5594eabf4d06098c5ae6cd1d4c3078e1716f0a98b4611b7a43f84f54aae10fe7da3ac7b39e314eeb54f225c2d90a1f669c332127ce53e0be4bea7693653e1dd21b3dd38fbb15e0f6c578f51f4128a5cf306613b150602733646f476cadad814cefde720d2706d755b8eaa40cca5935a6e9603c577dcdf95a0e48c11e7dfa08f03f7f31b07ee96832396d880751a2f553590d88b19b4d5cfe9a64b1703d0a5a9e7b31cf0fd6054947073023e01d6b98187b20b010981f3607c49caeeb5a5585923376400a3bc55ea24176ca7927702ba44f6ec4da5cc90a177fc59cd42e176f1b36d941f1fe84028026590b199fb25e7d33e64c70768be2bc53cfddd96fea146ba24d3699884818067d4635b979aa7a8d8bc7b234e4ffb974f68e6b69f8e902ce362c32435ce083fcea22189d65de2f92d7c0cc067ab9118650c2f36ac3ca005173b2586685c3819d007340855d52a7ee0c246a5df61ff3b3028a75214299693faa9dae1bdc1e81e732df627ce70b13f3f9c1b733d338c4248750b72329c966ab88a26d5b81e68e2a0706bbc9f7b23557812e64bb0c751041e93e2487d6c980d3912b5ea88ec4e0121a804ec71543b626079eb4b58af4b6bf473d4c3b7555354de4e897c39d2b4e03fafc0f8c570ebc5c8695c8b5ed9c43ea530ad8c0b7e209530c783bbaf269dd281da2dd5c3a04133bd9b6a769c4dc16c9fad3477a7698d43ab3e4a3a10608f676466b1133e9672d9aeef14351283d3a7e17faaa2138fa9b3ca700041fffc430e622cd3a32a1f606cd40830ba11292f031245e26625421530b5a374632d14ea6cab0407fa78589467cc619b5927fe3c11fe38974acb63673f6bfea8b7d6edc9a401f922143f4387047f42cc63a24c6e73da0f7d2fabf8a49d980361fc326bcd0333478845152411290d06de3fa7a1711584497ca1619dc82d5c59d4b524b6fd0d9b307a59994038fa524fd1355080555b9f156fef7ede69a53f6c9dde832a5ac76cb436593db1d87f82019d01b58f9c250da83e96e7cec0166945858f8c0397ba3f7db96e830e8161cda91d3fa95011763ef54ddd9a1190d58ed8729ac9dc1fd429aa6d901ccc21665cac25eccf44eead33c4bb73456e3536dbbbb08c5240b3f6f5ce6e398853babf5eeee834e30bfe777fd67e45c695fcc36c0155fb9fdaa8003c7d1ef4d661bbab63e0de7b1f4c373a913e1d8f23bf126b6b2a81d6e7f99bf3ec5f5c81c349a4be590abbace05aadb95cd4badc3abe51dff47b2039180a62f90f0a322ce935233071df1c13dd332e0507714379118409c8627d96c136d7194af4651df594193c6316d9c8011c178159080c8a943d05e62498ae5c67f51cb252a198d5390c91a9b1429e2793bd14c128b067cca94d103dc90d23d8744769b179d7d5a35a1fda8babaaa24e7c381290976737e7cc8240239f824001eca5ba6c92c5ff07ae8385145a14f20a18f16e6570ecf6abb786dd3562eb739f03bb4d5a9c8fe475e9b883ca4ef8ace04bdc2bd076be9be53ac7fb0f9a18486d9ecd4ff6447c48f0f53f1d68e044f83341c26a40df22318e634f28f466a8e6a33e74c9fc7ca307d68ba2f736a05ec5420d172fcc333d94a98fd5f6e9176d3cfa0fae77813c8f865f959974123758fd9104330950947814767e662fb41db90b468a9a8ece4bc33d2a80571940ec706d84b42679d5038d3ccf5ad8e0c76ee1d35c74be36f8c71a31641e2b2f177dfc93d8b8ee3d5390b5845c7d777e1d3d28319e32401f6ee613f89011d0a61ca50d08b558267d3c8ada930f2f94a745f44d20ed1d207a3ad564683878609d1ba0f7f5f5e7563ad791634bc1005e566e4bc9d36868d279f062f1ef050a26eef875862f923dbca7e490ff0d4ff0f7fc226811bbf2232682418ee2aa0312cb5483e1bd73ecc2966013477866fc96a22e78e14d4b9a7b805d844be17e2e8e68c9003fce3d7f3f326f5ebfd2cd0c3043a8f50c39a3186462040c8e7b39cd60d87a5d95270ec160807526bf62e7c5da42c8fb6ae4e324718dc7390c80917a0d4b75685623b3d63d14acac53f43ddfb28446eafd63142d7ef075c508295cd214c8d410ff7752c249e687bfa19bd4c93f5c3400e936b23245e8ef2c08543042ee50c38d488ee91f442074a3e0cbd1ee90991f58f3f092109fb6730d30807ff82ce5f7b0d7c4e5321a21732f891c1ce10d75873a579c2410646b9a4e3ceb39e0951117a20c8b5b0ab5ec64c2dcd8dd7bf58b689bd9d9ae58f36c10b7976dad58458615b47764d27a0f52d866768bfaaad3f3550025420cb97cdb5f6483a1942e4303265eb616437799b0e4016dc46ae32a2c772f8d8ff1be31d06e71d3c1096f8786dad3e7593f7de7c4d89268844d195a3dc71ba08f71476bde9e89852e56cc60841390ccd5f7394566ac36a0efc076f9b74aea003fd3c035d0672818f4cffa7356f6c7d676e14210d5cb96ab0c71749f6b15b8fcc7d2633e253c7049f8458a4e347a65c760fc59f4c5d6b4f2945f453c5c13879576fc5ef87f9756b1fc6d8acbb19e6e6a5e6968f9b071eacb6e1f4ebdb191f798946966d969028f86f0325399a9a641d65bd6b6e43b0107c21104f640ff5005396513c040d5f89c34977dd04db71ddf58b5a33e861a38d48084c9214f99f762cb2ce7acc3fd165973e1bcced19f563d65c42c8d7c04eae8dbdb3fbd90a186919d1768cdff23aa671f69b44bc229d2319e16543787e03260dab16bbc1fbbe9e214f5900697173f67263342a87e6eabae05453cee9d4de22da34858f6f3efab32fac66098fa0bd7a98c330a47ec5940125952eb35717d8a68bfbc11b02d8588aa18e004bac84be9597041bc8f953037a43c0f3a5b31cf374b3308a464c9b5df533b33303908b93725f1f5dc84fc938fe619a6542547b5261795ae657dfd92aec1b4f6c6b3c084a4df7a1129074a9658e39179a89bc2405f50b8b68d8296aef19d675ecd0ea340388773f19f1415d07374f1a57dc01ce22f5ff9d1caca9c63abfe125ef31c00ed8e787f6ee20b06f618a15d3a40417f6e6d31f46f8ae82cc0cdd16fe615002c40797347063bab963d799afcd752edabe24fcb0d81556f387f597fe3e64ac642591fe914ffe13d6eac766c8c8a26c02bf66f89e10a9a37835faf89e07db86504a40cb547d7f4a66c4330ba2db6d6266cc4924cea90f51225f2ff538b9ee1e56e0e00513a925e135d4db2ad92f82a72dc158f5787942c4b4cad1d385dd6d6715cc16dda62418f75ba9c7045dbf0319a1f803020cffaba387c21b12b1470a6f78541acae7bff2c098a6538071a91073da3a639d9b023ba96e2f4fcbd1b519381be185d409cedcfde8c803f141d8040ede0eb7d8ba274ba38b6938bf46462f517404818c84daaff6730a336f08a3e9587798376415f675ad7d802103daf3bc35f69a95afe8b9be05d44403529cca8924ccc19dfc4a0507b78078b1cdac3d2d5a9eba0791262adb2c2bad65a1964313d9a071581d3bf8cc68412ff1b46af6b47500abc952215ca5d6fc977947554a1fb916dfa686dd4d3dbb0fb622586f3d72b55365016863261a1e5ded21a484184c79e74cbd824f04845b81946d392d7b2b510984fc622cef8642f53028e362c543f0b689534172b439edc7aca594f7bb2ed56183b664ae58cc11ea794c5e628afe1f8a0869561344add43bb0e75aea02faf8c7cb6e0ad66333d37e7cdfae056c336f10f064932d5361f3b5fea8078d89045ac1ec0bdd8513ebaf046ad2bb37d21aa6718b834d2458dde21aff70857639a171af4194d8851e76269ea0542f0151fd89a94c7991cd0aaeaf79770313763f413aabd29da925043306403f7470296d20884b3f22572fc29fd0f62d4529bc5b251ba0d33fb33ca634e394cf8d4e5e3bc9824ab8a765f05226ae307d3b8fc4da8c54f2897614abff6f86a0dfe1a95e73e87fc3513db1a5e4eab7ef6df357cd9135ffc3e2e8e464c9d858b6f3cd3b4d634fac2ecd29f0702b2de07d0f58605abf63079caed39f8c0ef093e9a1d6b9807afe2c5931147288d65c7e1bb9da75bf4962e91a1dc5c9fc4c3bea13430b10a3e6804e632b18ad961cb2c900eb18febf9af81c9a6e0e42307f72ab39703eab49b7cfe8a43503e2e70a7427e3fc9a2ad963658662fa0e3461dfd7df09d2ad6406762437fdd620b3deda395ab8eb2aa50a6114cf453dce226ff6e772d0c982d0e26e393ca1fb0862d350abca4fd41cd47e3b111784e2c5dc7d8a24097bb41aab0d797918e81c7ddf4ee252fccfa34cb5b92efa6a56839ef1a5cecc04fd2b0336befd1b2135b34ba542d51bbdfaf0b3ec5e5aa71bfd63a4572d724f9dbd6b84f01b9efe98543c87e0b3fac362acfe3f2b2a5d34bdb9c9f854b9b2f069d48a9ad9bd0bc5e6b3d6bacc28f03ba0ecda58110ab1f79905297cc1002904327bc57398492e8ebb100b0b69aa0819bb8613ff4f5d8c75133c79573c7f60fdad3e06f9464d2cf642816544785a6ff93794c878ce0b4e85fb64416f9fa6e4dda45b6f050c17208bc64f9b1d6168af3be35081b23157b210f3cd3ccc2ad574e1339e70fafafb95a04417365e28339d90cd6499a02be97bce3582e3b07e15b0a5eedae1bb3317c4d1ea69b29f2934372a056a5dbf7c492e40abfc6b0c34c2da82689c452ad5813856c19fa2b271f0a609622dde011b35bb16243e8b0c533d08d75c27d5436582ca7f6f811d7d969e62b3ce9e243e1eab5669b8626a47fff075518364c78abe4b13c589b7d1f3a4b24aa1fd4343915493b743309c81071e53a7df52f7725dd77fc9b665ca4ac76ccea0ee1b2a79e8251229ab56f5a12eaf0197ca803343940605ab07bde3ac538b23455e44788ff995ea0371dcf13ef906fb9d1b8b6ba46108097d184ff0809358fbabdb42a9e5a79da8c06c94e6056ebfadcb6c25121a78a5bd958c85667377a3ded180265507e18dae2509775e5a14fcd7db3d7977ac70f459eac67582cd69ef962f49ea477ff2be7889a0bdfe1f338d340036b4c59809c63478b7a4752767189d1f542e2c9b188a73eb86e13da625b4c594f746f436b1f6f715fc6b0e112563cb85ac703edebc3201c04483d9a02bb15924fe19886aad8f37d65f01d55c8f10079b4900b3176021953af0ac760784f0ebccaca8782210077134d332c705714defabcd53738a9e14efd9da478fce1fd93c67e41b014804686386a6434dbf0526796960cf81602d8df70567d2df588bfb9c46b4968c945365b47a543668af021d677e4cb3b919c03d2afaefa8cf66fc12e947e7926a88f2a733f60ddcfc70d0ca7ca1d9c91001f96d0eaef5cedbeeda5dbe11a95d96a63b1e262dad8915a4ddbd97d90df16c57023fd7289c9e5f648c0e515ace996f20cb405d13c29504463a6eb4521345ba9446eaec8601af5ad87191647c95f624256580b10009b2887d2ffeae2143dddb88f00c84dbc00fcd9282210ac70516ca6df88e5848941a89edf69bcecc7e58c96dd8c0026459d77a196fea5aacb819e9b546ea2efc2699026d4ed475f59c558ee4903f9e6ef26573989a282794a085e0211ecf85280f6821892ca937a887b1582b232bf736a14ae0be5d82dae897f2fa84cb495e46f6e8749a783afffd8eca8fb307f587bd54f6157f80010b9bdbb14244da24881b548de5d7783a600663833c43f5713c2939b4c63af3ba95de8f0a350bc9cb413301352b551a75ab65eab16f5ebe36263343c41d84de7a2e93e0603ad57b67a5956c2ee131ec467de0383767d1ac0130b32c7a5f26935a2c9a3661dc2983305cb30f15879a59f1d7dd6a7886245372288ed2046c10b704fb327c27f88bd77e68316d6d696376cbb44b32a776607a068a68952428930cfedd4cb1a146ae6c395fa307d28a56305d586ba8d8faf8338ad7e9938bea855f92173265fe786b4354875a58e7d556a2a79555e49e6543325b9f16126901d0e1775105d8e35c58d4dc50bd3cb64e3f38fbf77c4668217b5e6fe7a7095ae3df3cb1edf6c872d9db59d708935ff97aeabce2e0bd44e739e643100569d501e9fe2953f677a50ff764204cc46b9e2c96b6973894b3211721a7e2699d95418bbdc00699adffb804cc91087c213b0a065adc307974d73821c06529fdb3d4b6a3505f6f6c53f8734b6fe6f1bf98e4179ac88d5043e415a9426efae65b32228a769ac6946aa1c3418bdd6feda57f350383bc4bb4eb96908919f130a8388e3d6f8e7f5acbffe561a2b4048046744b21eaf4248c3b4d000d1d0e617316411ee0edd66ee0b8b5890a9d53c24a93f32e622c4370145401bdc4502b8035e47bee38279425012e9b27337ecd335fa69fd2e7862fe475e04783552212f98d3fa646cdf14d64102a699a86e204b32fe1fff90affcab2c880d0a5777ae84fe1000bbcabedcf5b87f143268e0cd42d3c8dd30a2ea58d0d31166fcd2868ad16975df084e62d0567def519f667c2373633db6a4a3bf63d8b132887878fed1b4b8378a7b7c259d0b12cb18e3ef4e47e144a6b4423be5b2b505d246b29278597983a549edaebac45e67c860fa3a104f547a722d46bfe42f5443f339c2c34ae308129a33eaa9ca343629ec97fe1711ebfe373db4b86c17bd4cd05e2684f5939bdebeba7cfc295d6724e74db33e1a99a38969d6b4a8baea171871502571c9efd30da76634317ef0d6e898e8369b0fddb91e6c27c0179c342e12a21e83f6960c51923de9adde759d26bc77e8735262fe58e0d4f45ad4a74fdc146521c824c9fd0b0b326dc8324792a718a6a1ce6090408cb6fe4941d598fcc19995bba9f99a2881e1d648a6452373ada865b17f2191352930ca5add5ba4fc54683271d0a678e64070f3990119503d7d30f6584aef484a217181c440bb989e9da1e550a58928a8fbb56c5fda2a4e485dff67e92153c02605ab41aebf61346dc21c6aa25f51a69f601a39a905e12bd1c35515758e630970050bca6be29532538d30fbb9dbd8533027c1a9ac15f6234c4464993b30ccf51b2fceb1d544b0687294a67a300c3bac0c238930f90d1ea4c3a703b1f3e5344b12f0659d62471c66fdebeadbdfe607deb0615a2e3268b03c631264925589b80aa98bb254dfe6eb6f7d7d95c98450f62519c0833fc1fc46ea5f1165ca29487238e6c2072592fbc04df19e580482d29c61353c4a5ee7aea8cc479afbf248197728e9a26a82307321b816e3344248bcadb97c4a601d6b84b8b7f21ea69b52d37a58924b278b5c4acd1714b7dcfd48fe4625ae705d742539db05e8ab78944e13355c80e5bcfce9e96cdf69c0c4f327fc3b7b744ff0d11a10774ed0cf05ca85923e78242bbf223056785b04e2b83fc89ed90ac873f62299e9beff5014d17119e880131ff7705acb65b7a625adf72f6012297a363d29634b149201cfeb9c6fd9bf9082e2a51cc3908dea680603cc7964cad6d2f37f21152e0930459c1a2423d19e044c0a4b00adb64d52855932a5385a7a1197bb24b4d5412c2006f34c4852b553298c5ffaf7144201d228b96149491eb696e672a771f7a78217f2143c074cd1fb4b8ee8fb5a5d53a70c3abc4a705c8bb0d499aad0b6772543c2d4cdf4742be6265120fd31357a1b84f88a803281747e42198f1dfda7e7fe30cebe38b9558f73d035d599c8c50dec0f75561a5a0df45cadd5d9c93f739324b7e0840f44df0cd260d9b1d9f34d2bfe401a4bfbfa745f745c572c725ccec566619cd8fba02d915cfe9cc6d0ee76160fabd73e39b68d8040e6e842b74be63b6281145264ede1d7a49e5f15cfd0bcd25e9f4c6d091909d754d71a43cf93aa35f0d633aafcc1d682ecfe5d7d3d247326e9eba95f70d5a9ee5d50d538d172161d41afa8db2e0737b8cd99a52d65d3a773e946ae5e0db6374f1278cc52dd6dd1565dbb39522ec1c234d572499a331a0d23005ea018576a078844edc242ddc17d1a4ce9c8cbf62d4f0a6b2a2a056418af072b12c66d633944c9b077ac34f4029f7329c5a1423691644f6016d6a33fa39595e574e0e6b3c70ba178675240557c1f22673c2bc002ff7628663e5efe6ec6857eafd88a5b3c3d98fbcccf38dcf4319991ed4037d9f68680940ba692946924aeb57d669198ef3fb7247c42a701347588e18cd5d93b40025ef357ca7fa8fd6f98501d63ca580103dddb34596cf97a51f426b80f50cf4db8a3a9d30f9315facd5128ba72a8c5ac12e9c752ada7ddb654e51bb6554da0d1e7df62b98bcd20a7e618d9706fcef7c446ae2831a3fa0f3fbfcec1085b0faccdd07c74d4584a652138de1904a386725e230d06002e7fc58784695a17b772357a359b94af89acab9fe116cf0168044dc42cee5167753040faba7c5b1889170242f88b2e6857a63b61f301d1d4d81bdf5a15456dfee7b891aa43ab40c46181283ea3abc99d6145d9ff6f0b88bb841cfe02b1ee28371962bff9239e118f0f66221c402db792b2bc7c7a99426c13be39f574ddb9a71dabe4913ce1e0a0867952aa63ffb6e55abe0074cf73643cf7be4c5a61ca6cc2bc21da0c3507e00a1efa3eb159957fd1dacd5d3b10ae4f26219d2f86b1f7483b26d56948f4437e6e5b88bcaa258b7b200812f48ba509b2ab34ba9d8eaa5c6caae8d1f2144e9d4bec4fb7a09e6a0ab1767cab013108ea3d328de0d3789375a84b5912a62a331968fc05e171d117b7ffcb91e5e09b4509b76b8ecb43f7fe0c94a2b434c55cf759805f4a75978a5f7a8d90c9c73b2f46e2fb8fca9666535084a930c378b0d6b77199e2de5355abb38e742848a271718e11ef6510e3c7f6a7817f403799c90757cf90d9e9ec3102a859906ae275b57b4dde70c91bb3c97f6608275234ff91e1bafdbe05bd0407a97b6dd3f23963f3425cf8839fd23d8c8c953041c94d805d48d52de67dc8c6d639cf769a7a60f942a05f1ca3458bb625e826fdd4b55bafdad479155cdbb3a3a680c1390b214952f1421d4fcf4e123ea08a9ef88e0fad11ee6099e26c7409aed40ceb80c43d25c27f1927e8e114218afc36e04df4c82d6241fb24d05f0656ca364ea4e31fe0a5aa23459c37fa9f36412b16ccc63ba50b0bb2314fa2f3d84e1426f99f37a0f88cbc0ee8cd433fa6a0d18b2e2239e4d66eb782fee1f17a14408b3f16c037e3163ef3537b2a41f01d64e1a7e58283b36afdbcfa20c5cca50d7612a0f876c649e632791714ec0a065c21ab0258d9511c8f6066cb025b0c3a8f653b6403992e818fee4e3b2b7ffa48ee5d625c3d93e14afb5a07f5e024eedd462c7f239546d782e8c82cea0d6459430562f95fae863b6e46bf654d09920306188404b02ffa5624b23c96d8aa680df107ab922aa4f2318db443337c1e583418c66f7bb3174bb8d807a4e9f57bc823cf29918d6f71fe09522f024de214dc469e6b56479fee8e5021e401dde01ac4c41a94a21e0267a343792dbca222821744b7fc39c638a32cf2c44e05de7df45e70d53d2466f9619a25fcd26a8048778ff456f76083aaeaeadeef2b9bb4886987e1295c9615c038f0027b6646e0dbe3eef5d3ee4c3605a047330903873df6d3e1baf3abb2d11a2c2f4b96fa2175f2b80a4a1d6cfd8e415147f55fa5e4915fc1a11b29ea130fdfa48dd6774abbbc042c689ef472ae6fe9cce76af22e7eebfae615eee27f286aed3de27a8335616e3b6b084939711debca11ed01d83855e51749f2e4b8fb73506e5a1ebb809fbe0ef5f240b03632e1b013436b236b9b29c066b396ada0abcd032f7daef501aff2c94d98475b9db00099f7007a64d17752ab8ccf8ce8d37d05089ab55276d8fc77eefd46f613fcf6577e3e602e4dae3ffcecfe54fc0758f53cf022af8b0929c070d6b697bb94f218af55d28700431466823fbd2b19e0e13cdd46f81267238570c2cb200a035e16f758143a104032e0824c82c614afa517b8cfece6926fa6d03708d644906f8343e01aafe7155cd5861558cb6dd6666deca6857defed56114b0a35f6411ccbe43fb122a2793a26363472013460a0714a7815074898b2f6ecf6f14332cab3899eff7581ed03086bc76da530accba32ed7b159b43140f39d178b0685874a804515d0aa8dda42d238106cf60e030f22bff8c7df2f5b34c8fda926cafb1c4cd3a0435eae24ee5eeaa772a4ccabdf3a1c4a4f7e8e9ac99e0593f8f39a28dae214918f6578584be03fcd02b83c7098c4fa51b047990587974dd22d37c6083207f82ae5ea7425d4c02aee74f7a22b39923bbbd4ae9b320951d0c953b8fdbef6e700a1d01cf84941d476083cb6241d1da7a9f59de90d19c53230406a270d5bf70628989c7b905be874db98b346a86e9bde59ab28d62ee9279642b16f0d457a2d29bf0fd2588a5f18aa71df27b2b98c76ec1352a9c183de32795524b31116f219699d8ce381c434b4a1ef26b4b65845e5479ca7605cb19a96cc82e75bc38dd79cff5a88e3d6f076c6460b5c6a8a37717712235485104814ce7b62fcc67e035a51a1f58359037d2ab483d851cd98aff9b0ea40c13bca875936fc0908cf921368cf626e2a810be55b2f1b96fb58701a6e2f73099c9ceb11407ea86305f7c0bf1d63df448886a544edce74ff9a27d6f47963b748222df63f56aaf9e095ea17c19759beb4f1797c5aa28891ddeaaa5c2e980f4a121b554d41e94c19350dc6239bfddbd0498ad8eb76084e4326429e6fda843974598a9ff1d69f8bbf60c21c0f3ee9ed8158c26ac060f356a17f5bc08b535b96ebe293d9be737603dd26929415b97960e9638ac06610ac90ae5f6c32e12b1aab2c1821e51882620e691ab409d971ef1e25a944d5086d1f8c4efa8dc4dcf89f7d389c8045cfee0791e8355c4c5b1977d2ecaf0d0cc541c17c35c9807460f414ae84047e71c91121bc4c2ef443047db495bf2da070fcee9f1528bbf3f8dc8ee4ac609918b0ca91d270d8517c13d3ec0499df201a07f6edffe031c814dec81b5d4f7138794580ed367385a4eda3fd47521b29722aad92ee783dba9c1493910f86f534b9d60f245663e3fc46642da1b3196858af0dfb50ea0572ca080a921efe73f82a77666c75c4d848b31e8e9f6d2ddbfedb589155b7167a551a3ba1466e5cdbc0219141bb9735032546a63e358fe3b85560453f8971ae929e17aa71a776e52b06d4800a03ec90ac6474f69cfdd7ccdcc4c66aa20b1c2fc0ca04da5ce3f773674304474bc36c5eeed83b6c653f870c294bf7d8d6a8ef825d0c7419c03c9d254bf9e3f03e2caf7bd05aa7992d3463c6a0b171817947dafec0f02a6f44e5267ae0f74a315832d2e552a9740d5b31f06f0e2cc44288863e5535bf99c70ebdbfcc0f0c50acd4616d66b30aca33cc81aa301646bd5bf1d30fc7bb337bc70b6715776f91d471e109c54a035cef1d96126d4e1efbd1394f41b5c3dd0cf731807c24ccaa529ec8ecc1c912d79312e9d798f8f8ad7722d3608f7d270eded5c6acc24e428d79d420b6c4459b46788dfa4d9572a2c893e88b12bae403408c8774e6e60ce80ea3b48fb34629fc9fa53711ef12ef545e702d6c75b33fde9bb27f824d8a588a0348f77b46664b9aa96b53292414146106fd1b8730f59044d05fc4e7a25af0d2782d0044109c1f7941cc2eb6ce178d778f69b140458798138ea7aca37de839bb7cb727bad314f5b36004d980ba15a3ac5514001bc170ec14923e4e25b7f3040a4258b1ccf6c15907be443123d122ddd1a8c147d198e6c1669b6d7aaf171ef54475b8d2f92539ed051bf9d157bd73e0323eadf16009881fc1c8981040a702bff965e95ed9cdf8e4cef3ec1e1ea74831fc83e6d7d90b007c888f84ac0181778995cbb06b85525541eca94293b027ed5d27712979cfdcdeb7d7140a2d65c9713832a38762e77cc24096f59c5c1284fee8c4d80567ac82fcae5e2efe0acef6a8d697b24205271a2473075c735c1e851c43da24ed8dc36558827e573aa112830346a5cacac4b680b84edc6199728562a6d25ac5a51823e4287f0dd2b39129a27bb7aeab42ebf41dd0d6c3c27513f2e87ec214cb1db94f3a6b43805c2660959db7027574f13aaaa3eba4d195a6b6e538c946aaa415d583e604f3116054fb786f795ec1233db14ddea249d011f76f2d4e2947cfb6d70aedf078775e271c09671ff1986e63d8fcb89c05d12ed308af6fbb22a723ca6437dc611930aac239dc62cedbeb373c82099df8f390152fc908378d6275d88a8cb88cedf52a2140045ae6cb57167df8a7e1d2e1ee8d2332fd1f534b6ea39e78234e18eb5fbe47801c4a8869a1952d32a12adf4a00b3002eec08b28fc6ff62595b13edf24efb73591f81ff3f8837f52fcb6e211a0ab86ebe36ef91fb4b4b077722eb5202ff07b3d6a741de9250a46636a9c1b9190134deb88cecad3182dab0e985b07a2cf2d68805463a2bd070554b623b5ff5c978bcd64ed275d677c933774316734c7d5c2e48d8450502243d8b42fc27cf87bf3c222f1d970c1896d3704b171f47a8d363a12d48af39920584d64fd690f77b88311e504376e02f75f3313291173f9a22f6b2f7226b95af53b44438b3ed624bdcc56bf148d80e5416c74b98f81d0e9bdb3856d16e8cd9e897c59de79916537bd2a192bc10de3c7cc17c060fcc69f84a9bf3b0a94dc36fa9ed45ed2b9f57b119b34d2116fff789798113c617ed1ec7983185f09c0a84910dae82aaeaf61cc67ac893c2c5284a1e2b3921448fee2b617531a691ab8e11ea645a6a3a51a911eb972fd1b596dc3feef3aaf3c54d068336ae406d4e17f5c4bca516898f553bbfa374bb14e56d41298e9497ce20d6252c860ba1069def6f5571ea6ce3d27381d18321bc0d9c1debe6cb7a98610adcca02487f98f82b8fba561bf91269733687bd0a4dd4e70930dfe8dc5baf8b210373aa0097c4471ea8bc5aaa2f2d3817d9d71fab193e47e88af8aeb338d04b8c2af7ab329057697997316ef4e02eea69781b1dea0c8f39dfbdd96214a17de741da85cd576a1077399835a492330fc974ec18fcdae9470d2fd1012d9d58be46218600e973dc0ccee32a9b05f5ebc6d4444573c2a3addbafb4ce5dee4b321ad8a2be9c22a7a64a4baf203595188ba42b9202ca71a9d97a519f11e8af0ab0360c702fc1f6717473e5b25e0b4baae1ab7a11b1424c6b902e7fda036ecc5d273136dc035671ecb52e0b654e32c44f48e0ea816903a311fbb39f2a987eafd94aff196d5a9a439b646a87f945d6e937d4300bc5e13e727cf0a518fc6efc1b6db4b70472631b77502b1d5bc9b9362ac5bcd2c621a45b31194b1c26cd8cc6d5301ed4e244d405998946459fb0cbcac11a4a17fb926786eea8c6c783881701bc75629dc47e6baaa63aa13adafb1c810523b3cbeccde83a374e9be122fd2960c8c326532df5ef56350af19cc75786e0a3fc8b8477c2a9576bf8a0082beddac68fea75b608748ed3950f2a8b267aee591a447f43968068fb3d5fb55b74abc0846c77fd0cb8384fc2647d1e757b5003b1ef2c98ef98aac58bbaa0ced35803f29e5a0a37b9956acdb3f82dab99079c9e50ef0eff02c93922cbd5a9c343865f74e2420df41c6d1afffda4d8b704eb0b6cc2d1474e6338dfcadd4e19fd034a2dd0310c60df7b17c4a8eaa71f35c2c4fe7fe667fdb5c5f0073f14472dbf31577cbcced151abf3289ab56bf6ee98b59aef4bdcd031162d847144ec714f63a61a6bde2c1091fdfcd1116ff603612f1802ce6b724851d85a9fe606d9b1d37153a04216dcfdb7d3db3e25a5b272ed32665076f9dd297cbdbd031760168ab7f161fca1fbeb861f02f2240c3823bd8365497f14af31644187dc1ed66704b39e1614f5cc2c14f36edcef2bf8e7a7d614fec940d17ff91355807dc1ba7b818ea525d74e763d59cce721f6606791b54bbb43a2501d6b4f61db501087f753f09ee7d7eb6538952f4233a07c8670b08ffce424f26837ef2f7df6dde63f6916d48546514464ab03902f20dc8c4fbbb864c18a7a6e84164e787ee0660dfbd72f55550740196a18172804baf7800904a11d8ad73f0f0a65c938471041715c5f124215ee665673a7f7029f7737ea827c4d2ba0ceb148fab7f12205885130bbce995bb66f937ee76451c1f9fe8102de878c8f0122b8d4aa49e1fe3fd3e1fbd32591ea34e5033b73aab549bbd7754f8a021934e0de2c5cc074cdcea9bdcb467ff238e5d8c7305bc32d64a109dcef125c59465adfb67f3bbfa5b158213a52379a1f979cbce3160a9b9f38b61edb9c3d39e6f5d525075044f34343743816483f0abf9058971280fef99bda86e86a50b15c041a936f1e5ad27cd180683bcf2a6c1c20cf28d6f57d531c1834e074ffc0bcb1cd209c7be0c3f7abdd3c35fc2168eb839d4de11401a5e51b103144680d31cf89cf2e879c200791fc94eeba83583aaea54f3f78842daec13d6d5d9fef81a665564fc7c7191e34a1320a36c66b11777eac2c06dcaaa02f1e5ed8039c2a96ed4b9ca74c793c5ba1e16430bec69ff4093919800cb0d5776ab0d04a67e288a01d0fd9cc7bcb66856ed986878e859aae4f16bad92439d02b1a97dcb3175de07b7cf9453c4ca9b4a6a29de6f665efccc5def9e359d3fc03bb84ba822446031993d3d0fff18eaa341c2193ff81feafff876f2c03315d3fa3c327bcfe86f77b26939d965f08e7bcd97cd39f79c956d1eb42d4715b34d65f3196ac585ced2ed9ca50b9b9eba0425141c633b7848dd3ac05978bb6bb61fc985b58a6a4bad43aaf8c4298826c71eb3b354a0b3196443f5e8b81468432e536879828daecaca91063f22151a42aad694a14c448d4b226a7120f9311de494dab00d0165dfb71d16e86fb458b68b9d33eec13136fbfa221cd84c3a2e6c4402f479642ab5b66689da8f8cbfa82a42215d495f2f13116f47ee0e43cae194ebce9961de162284ecbe0e913d7a8928aef4c4f80ef8d297de54cc0debad13c3777133f7a55b0610e34cd2f85382d14f2ae0db77c2e9d5473a6f3bb6d67762278096fab60295dd8155e1cf098ecd1a588a6157564129c1eee27ebeba0b7290e6c4164ad1272b01bac10f3efc8322dc6686659b0b1abe66188bd6fc56e1c52e59ace7b0a094aa3e951bf619fa680bbf37069b243e0e63818064121e5d73d2776b14e9f9f74cde37353da31bf7eea02a6895ebfc0995f3540b529f2bfc64bed7bd150d485c24b658a5e5787370714ffa0c06f43651a9ebebbf54ad0458d8da8ee9b180232c9e42617f7ec9e7418eb4e743fe43863cd8bec44c141928971a98f6e3b8a354ff2a7f54907ab4cc4ba851fdc42bc53ebe438c0f6f7364986e0353ca6649541fa2a476981a47f3fb6a9719d872b4ee4f415c48cdb88aff3cce4d723a1e314c0fb3d8ca47bf2edfeac4d570cf3e8273bd170bf5f7aaa4af0c43bca470e1a84841630b8307f7a42b4ba11ffa464dbdb0491d3d74c1f7ee35c3fae937766615edd2df375f1a0bce3f7d2971434495b53ebeaed8248dc4efc53c2c4384be96316a839b5f99034eb5312c81e6b9eac759052544b49d67e366e458059d0b3b6c63b6186149aa115cacbac56b8cae67a78d66c21aa1bc14c6018545409300a1db474115b7cbf5ddf0c9627fba03c30e649d2c3c4fe5b47c0f47758a35c18aed858b384a578a9f8e7fc62467d3e7155faea19c92ad270a50f9ceb4f439a91742e42cf41b337b413ce37437521bc5769cdd5b53a9c94221f2ae17942f15fe20aa79e1d90d2ff6fa342a9390f52a01fa7c50e220fd28f924077b87868b26c2ad533824440cb2d7eefb4d2791ddcc69d08c4c17ab3b053a898f6ed3e7fb26062f92217e5f7f41049672de39d52dc221c91fc3260258f2451e23c23765fe8a4c6a8780a964daeb7523b87407dce256d65c5e83a5cce7524c903bea822b0335eb0e777ea00a54c7c591ed7f3c974f65820bfc4cfcc686b9528edb40119b7566dfd21a6a733682a69d8ab50240d53753750334c68b87d211f9ebdac76aa3c5b4334f249635e889138687836f8f3bc46bffdcab538fefae4589883ae3e09a21e88ae2384742609077636fe9e5d701dee7e6eb644b8016d0b0c0498d0434dbda1fca8fbb311eb9e9d03c39a69467a7ade0ec9138a77ee2b7b3f2c8856206a5b7105ed1f9f9d110786626ca5915fd3fb50c80ebe84aa8982d280714dded27ecc596c7e8470be8cdb14d6b0ef961902d3b927f5b2ba599594c873e0b33ecd71452c16d6616760a82948a0f94942f04354d266d900c747944d3274e4cc420a9bf5fd411a81c0e7bd80ecde798d061239e3abd5bbf173ddd10f8bffe2d3191aab2486cc973f8ca7f3a198bf8933786a64d7c49d4d6d116feba67e665e6313e62be369de1ff29cc4cc7e17f8abe0bb02b0d21fe67f9ee917d2a7750694281dae0712f9772961c19ba845d812ad1c04bc2d1139f8ddb40ed552d7d0c0419ffaacbb4c192ce6b9a621c9eb9a7334b77d8c4fb0be3d4573258d922e57c54a82ec53100b05d2fc96616d70b81f0f006ee18c25611db9263f154e54d79bdc0532112c1509b8bb2cb054ee6406415033d88fb835052193bc5a78d9d9ef405d6ffd89b0681815a44a1786cc4220410bb876fee7098936b1994395e02b263245903b6902e6b197b48fc4c0bb86d2133eece22f218407c113c37c41fa71254e4cc653e0b7ac6952eabdb5352466f852ff1777adf2a978f7532dca50da5bc7eb116e6549c43800688b447997f48d4726c1052506448bd1cdcc51af58175311201220b40e312c0eb47773092a16c7afb2b9737d9961f132d321757bb6945ace626648bd9c3e93eb0b08f77cbcec841d296f42c4cb7f7499ee88e04c59bd71def28f5c66364bdc92556a40516f699b927de245d59a64359843397ddae20f4eab00ee441d7faa6095b6606f14e2d48dd9d09a7d689f70353fc2a2cbf71fee6f12da9c7648d1b85bb0a9740bc285d78a734a24750266fd27a6625baad46ccb380ba56e554656da3450550b7571ba6364f600f9f94ab7c5b8c9ef0c96f7ba68bac67cdfb3e9cfcada1d80f587e08d314295e2728db0ff5e14f30059d1a2c2c3155100d6d75418a95f0819f7fb413d165d3f19408922f3a7e76c136aae8cf0ec0e9b6d34b66ea1856ee4950d01c5ed1d0ccd3612515971271070462667a07fe94ef3b47179dbdfd3c44f75d0392fd84239eb895f1170db5b69d28648f62790dbd60625d2c91184f6e36f9f5c00c9d025bbcc22a1fd5d7deeb1e2be9e43b01428ef53a5407b1726ce3d342e82c714621e9c28a48db4533c8c4c0b1273a49a47e5385dd8cba4d9f47ab835ff0b13e505357e904205b018c7981d916b157d32f07076481b2135a987a55be3191801e412aa2828f71f8f8877c198e3b4bdb1a6c0c0d74fb41b2fb6985ce069c8abcd4da84003eb682b73e9b54cdfbcb90fe6fcd3a3f8a1092620a8f716aef220616243e69029b515b6843d06cdb04a5258f9d7543c776a72ccf08bf3a5e33d83ba475f24cc69c4234e6cf23306e3529f451314732a82314a3da712ecb83faf94514c7d31d5360aff3df40bfe1e1329deb426f0648d30d832d982cb9cf7983643af73fc7a1c33a64adb9cbef5b88ca53fe4859fcad2c16c3564d919783e518c2521b7915594985308875460a8e573052f66d52cadb9fc533676d5d1889dc5851d9bef5167ece0302bb2c5fbee89203017b23f91627a47675af6b76f6635c70dfce9bc8efcf8ccc53a46cf9b512f25222115879e06e44d9b84339b540c3ae48fa36c43601d0b4669815293a593b3d5a12bf0a7a21e0579a873dc42fdd6e242b2543ac69092217956f63a0ea4ccbd66e687420a73307e529802c6f70313aeb566b48f0dd2a5ed1ebd3f23d2c83b74a3b0743db8f4f880eb71fd866db9d4c18656cf13827f95eae8438e293f58bdd5efbe3fb5d039793cb9a88a02ec01c5356d9590d1cb492dd935f5cdd492bcd7de8efd425e5da4aa64e0ae8018ca5f55f99d3d4c85fb4c51ac649d589ff88fdc380a24023b32b6285bd3d456d8f25adb6b7f9a0b646536751dbfb9859be177ce9de8eaf92745d2df0500a253afa673d0cd16248102b616759d3299f4749b0668d1a24695405b52d4feee4effc08134e4aeafc19aa22c53fbf0e63a80f43392a3bdda702f8cc19e9af46d9dea2935a27b514b8e77dae0b99855c63e8d349bcd270cf90b336937d1c5be1350048cf25c22f450fcae3395d65c0bc3931e6fb056024ab8b8d17cc6bf13a172d7d1678f8e561cc72138529b803a619cae079ed62f9d116ac5875ef24d26396b12955ae0a59b428b0c699c289ac87026880b0248471e75a30465d65b16a57e5c9a1421befa21476dd7eec034de364b44064dd5664aa1277da2d8f94ceea80d77b0c1be292dac54a2b64e1597cc40e8f5f2669a61c77fdbcf956e0ca0b7df2fb5b3aa9820304ac662a4103de2527912fb75246d47a19b5cc550cabd1e30ba5b10854d641d5ee402c7f8aa11d33c0774d1d1ae82096d2d21cddb2ceaf47f864a6d61f0dc49781454d25c0a5211e3e37381790307a1f1f1b1302149285256928333de065f1e77f0def65ff705acf582e3f2a3f3a28b375089bb811071759966299e967a124967849a1fe3dd23ddd89b8900cd45843cb0a0aad56d97c49cc44aa6275d27b78bb32010e60aaf00fb404dc8b60e086bd392788d5e6a2a13e81f89129176d45e21b1dc0a66fafc9f0b191a02d92fa144eecad0a572b308249f10eacafe049318438f02179d4246b0d71ea4757901a6d84bb4497bef32574c098fc8574ec657f8b6c066dd92944041341ef35006c0009431c2bd24ee2cfa2df96b82e340d0ca16226baa47d70fdf5035035249fd31d0ac9c614fe48fd7f63bfd360e5a0bc0363a4b49275c7f74da6685c78a4096714f00be7a08b5a61d156981ecb0af14273a5e95f4175eaf219cfd9497201075cc8c9e2bba066410749e898cedf9c3738aaebfa4492e5cf97cb92f30601c97190e28d15efd78a33512e177dfc78cd713b616dd6b0dab48efbf77cdde10a22baf129052073d2456e1d2ad22d4321ced0a3afb7465a5d405e447b29cc0cedbf3396797a57234ff5bdb3dd01d6ef0d6c22ba71bfa32aef41cf0e7b6220e4227f8bfa635d0f4df2749cc1c0117a0377f990f0af7d82f652e0f7b57cffd0a4b1f56718a6f9aaea5ede24049a1514956ae170edff9e05f11533a9ed179dfce4bbd1c10b412b60f5a46a925ad790b1cf52647aba5245aab81a50645dd9267539ecbeea96071f96e8b0629a766d863c472b3bd5bdc0c4dd76d3e472d7ccd7dc96acc48990712b68cfc4f3e65bb9603e573e42e2a21aef76033faa65ad354a043f88bf5c6176e3dbee18a9e5a49dd21ebb5679c4c5e862bc63d95c8766aac489c82ef69b2c6cfabb35ccdcc106ca009ecde0f8416a45a4eed1b3aa44eacc042e3d91277d86dab657493873a9facb0c324beed7c0375ff70d95e20298de5beb0134ae6a012cfb60b961648efb454ed2012d15961d08fc689ea7929a3e95e459eed98351b5114c87d4600ec48c921f3c6a2a2030f5ce47d93bd2667c9aa3590e1ac75d81d783b6d885cbe169954de3abb652b54f17c7e3669c9cc364588b070719f55b5d4bc39c70975935071bc47ce497f7c0c30ead55b8864d1eff9a48c21438cb19e67f1997e687ea59da50d59f5f9552b286e97da6cf96a2f233580e5783dbad147b20e135f9246a8e07a16516850d1b16c61125d7a0f2d3724e079db49cc030af2f019fcb50ea751d7ae42dad54764b4b3a61c0cb9fffc0bdc828fa878b104d609b484d839ae9da0b10e743215d7169a1c5dbc6dae92697f0fa40512c996c7bfa51622b65850d391d9a578a92313c2b9fdfda6db354ef1a123808fb551e30bba10c2d7fdde1d068c15666be73fdb333ff6f85bea119581a77e535a8f0bfa3e2a35feb94a8ecaedbccc987c8eb70aabb33e9920ac731a91ce3683d4098d302210c9b1781ddd65fe4924a2295da00cea3fddbc902c15b7ee9d037448251409e4b4226aa7ba4c26306ba35e6de84bd71ddbca7bc352159206d0885ab33d42bdc1c9ebe0e7dee592726fab8a0c3ec21c6b80019bec9c833bf6ba730f224d29a480d41d25de22e01c927e9b75fe424e96c92a51ccd85c51612f417927365d5049cea979fcf923cc5d0763b7ed2723bee48dfea64e071cfe27297cfd4d672c0618feef884a3c76ec8a40bf4e13fdffb2a7119219f0ec1be30cee1dc9251f26e55ebab51b5eeef7ae4dbd8a26907e0956407b4a86c1e003b67d46993e753ccf01b435f5edf535ba8758e87b14208bf56514f15a036350dbc8da532f98b0bd09966b94dc250650ad1bdfd09dc0ee9e414a9d0cf04415b488a267fe5825bd6ec4933b2c424268ca130df28e7614e809d3b6f6d9dd50243d0a71f29c6cf1a183de1e86309dfbecc60276659619cb95efcb36d734c8de3910d57b1eccbe2fb7dc1392161f247ffe58cde952a0d2e02f90c752d8ed8dda51d42e012c397138ffa09c4e042ce305525c14722b1d6212404489d7287be09d4e6d2a75eb9eb93affc619801d8e30a050ffa4fa9c68eae3aa029f7eb57d98d7f181111b3d586c21549bb42167d77d5771aa16e6e40e45da288f3efba7659d963cbe01b908eda07634a061ebb3f04c3d0425802697e349c450f9e0e153487ce8cfc75c0a32b01fc0a094e28bedcee2e9f7ed7eda719422a17cbeddd62a48fd8fc289a37dba23db1b57bb0ff7292d085f2ca6c47fbe1cde70cda9502fbf30804c7d2988f4b0c9069f091e6ada624ae3d8523ca617a2ae94f7c9d5a1bc2cf275c8bb60d64d0df5961cb9feec07c61b2886117ca412f76355032c6e36b70788225f597094a02da337ad0c961f67f3ac753fcf516c39e9c028371d74a6c8160fc4f237026dbb3494323977eef5a09983d1cfe7ec105537b3fcb5df8d5f0fb584ea575bf4e3f3b7b9b312d2700c7785b3c4264c7ecfe631803ae7542ba8fcda44ad6770ec7fa7c2a2639432d4189da90aafef62428d1b614ec7498fdd4c39f25468b8c7d9a1560d5f1cd9b9c8247468847e650a017b45061428619d8733af73a645bc514c7aadd5bdd5453aeabced8325094b8593156b36c1fb9a9fc8488880b463c37158367057a7812b08ba51e8b0760c3ebdb8a476e0fa495cc2e8d1ca2d97383ff10691f55c72e1015626604019c8242878333299d2200c1459fc282f7174a994e3402249caa3bf06faaf2b8c235f1daebae06cd46e8fe0c1512566cb22e782b09d93163003148a1bc526f8d987458b7303d833b4e7bc4909760a2144b146fc31b9fffba654f1731a1003df2063c1a07ff0fa67d0288214e5e887a1162a67b8becabf482e69124d68ff53f3ba627a652e2a4127be96dc84628e99fd0af56eb28accd1af6d5cffe070002af7e132deab43102dca3a9e5f47952ab19de3fe8a1e0ff05ed3c5e0c8b38cb9c96fd9499e5633241d890f9370208247eabb6af45f0bd0e6a74706d5245192f8d788f7751cc4edbbcfa87f52ecd8a58290f27e9d5401bd68f0a4f5c98402be56180f5e3bf955b9b7829365deb41c64e5fdc9c43e633eff3a7ea10f885ca593e4554f6a16c3000e8bb58775fbe196bb4d793228a19b40ff5114bfb0ec9186543f5885a200ee788f9dc5137145662c66c011433c8b866af217dc21037b9433a30df9d66b37bfc1133e5f7fa8915c774c7c6bf53f9238dd4a0f819adef1bf64d2a026218bcf8a5450e424f74774135bb4f2e2ab18b63b28deef3d8d67959cf9dabe4f5dea8963523bc43a41757d7620ee1c0ff50494770c29f1b17cde3ec085c63e43904dc82541bc0b26ed10b8487530ba730437c29b4e83cbb5b3e9cdf8a2287ddea64e1cd8722227fac7d6c62ba60af114dc20c43342a2bcea602be0d9f3cf83945a8315d143c16c97ca5b7350aba67c2cfc1035a181ff77f5c52b6c3051a7b6ef6a5ef369ecc02751e5baa3b97292af4e4e4b62e38dbc4fad9a4c994893c9c4ba5575f6362c5f1b085a9908aacc5ea1a256ce41dd00304ee5f9ab80b868ea1158f10441f010b23b3f489055945a6cf0890f576e5b9beae3ef73d6f382cf350fe98f35a0657da606ac6033479f87d4562e5af694516e5a230ca46bbc0938d36b6c8a91b6d433044d6df63b551b97b1e93a3bee179412323d54bccc183abdd58c33491f8388b44f9c455cafcefe34e6edefecc19012e4328b6bf964652056edd422258f0a1168124a7bdbc139e5584266300ed8f3fe0f801bbac2f2b2bea97f5f1b48afc3c76837d0c566807001e8c47b931c3b691cf3052dd0958b71f8e78292348e0cf3e80b81c0a2b6a6f13401cb649a2e8b3179f720d6db4a3f54e94c61b11964ac8a796ccba67647e65eae0b711cbc10461667d3d608cd5513ca438ad60353507c33808468b427b487dba090cdffc706313795fc08ea2a7f06d6cf8796ef8475443d4fe4b603a1623a34f59cea3b3e78354daf0afd502e787a45cad37caadf5b3019dfbc5be5a64379bc4a393f7121776632787ac199a8ea77347e52b95a6827876a10b6e842e70958cc6805879159d86373b7f3de076145635dc704ca23a1d66fe8daa4323b3a1a26b82a875c5c677fb14fc7d8a77be31dc47429f036be8aeecd1a2c9283fc797fe4b5d165941209401c8a6721c5181e52d11cf8915122ef3d89c84cfa8105ab0d228eebff93727854cd42e6fbb19232cf669d84c83c434bce0406c720aa64a2c5d8c5ab5174836beef4d9a74b7f7811bab59bd30b3ae36185df5e313c9f09265a43da43eeba7f88b9f1d3cb21a3b85a710fdb419f8f2478fb206af24c999c09b12e2e3d779dd380d60010f00272dca1d0ae4bc831143bdddff84fe924eb24d6c821ad58c5b94b59f0bce19a29050cdcb2202cbb26b5738d83bbdfc5f3dd526113abfebf43bd950ed2456ab1e75a0ceea7dc41f899a80e638c0a1db68d7eaeda72df5d870df56c54aa5f0ad50770138333f2517c86bbd71ef3d9b41a1df1d9ebe152402360d08b20612d2b0ad1244eb9e4a3cc26ab2de80a574eb3035ad631fd03a5fd9807ae45a97a43d1d46c1cca5719b2f0c8b2f65d0a651747ea8b6697ff524bafdb6b11cd18ed03934dd9324e2e7bfaf0d7c9881586089fae47e6e34e6f90f92594730e6c78beaf162d12d20d9b4c37b2e765bb9b8ea1eee41edb6f219fd6dacac556d45efc2df834a44923dab014182a8572d61fedbcac74cf288ece92edbe8a0dea58e434caff23c398f2072b32c1865c90db0df04f6dd06cad79489228aaf3ee5f3844cee9b7c984181e7ec9ae3e07dc2a667de8577f5e2463f6de7489ee1f9891d469f980a1e51e3642628398ee42695d7c272f0a65149d3de2cc5a89959439dcfd9915f15ddbfe9ab006737812676b4d0d6efee9870516c431227493a6d724e350c48cd3754da4fc9bcda0445c9e2992a9623de2ce4a9151605ef36b3a161485114d021f07a60ad2eb94c3be7467ef14335590b7e3a817013fe82fa7216d3f71fac2d1fbb0062abb3d69cd82b8dcaf9af20526d73b05ad9b57c7be25d98dfeb965a815980318737c4d053d45655dfcab345f18cc69209fecd66e5c385d6f71a12b1767521bc0e5692428707384ee68d1ba192e9293b75a8857de1751f0ddcf0546fbe0796ff70fd6f540d7ca75f98dc32cab1b5add7b1807199977aadba75d585d237d807aa0072021e88a05a22895efd5baa30be3fac71ab5fe3dccd384f374c9f6dbade39fea32c1d58a7fcfe46971c3b292b16b6b7aa106bdebaf5a33a17e0c720673e69e2c9c0f9aadf238af5046b3cc742a1e97615f5476dc47077cb857ae76befebc6812b0b34d72db6434018046a69e813fa0ac7acf4fc16dfe7b8fd0c7dcf2771169c348b6d3d64cc455b7c7a3b055a18a5958f815df6953a6d0b31e3ee60adccd6e9e0a09e066c2f5590979ccc6869e6ebaa913a3573679f055228979edaca6d1f37dc0ab28416ebcfba4c5c0f0580ef8395fe775d1d0740437e27a31a554ed775ff23963d7736b59f78b29ed85770019744aea5c30308fa34180232d0fd9325153e226f251c4a817260a4afbade0a28edc40b5019f2908cb087c3304a6a3889b0b40f53bc5020fc431d17811b99362eecdc7104927c2aaae3dd37117b89a3ac7f9fbbecc9b6ef52b6ca2df5e8e589487aae800b14ec09beb66796a8dbee4dd0793cec7d1d77148035af9aa1db7d26d10241c089c272a1cb74ed55b5601ae15ec748cf5d68a951ffa4a549a81142172dbfa0b988b7cd7e00ce637871fbef0cdba5d49cfcebd5f9bc9443f362a6bb6bc1368d90049c6a0988fa5be4039000d7b891b02cb43b574422fb70cc67512a058ee7d42348c15058dcd25335e4858ed09c637322e98f5ab5f9079e6db4a410025abda67a8c1023266e61831c2bc4434ca7d75c1c0770a120db9bdc54c02cecc58719c30dcadf8ef035b4b52d326d6f1df787d7d81de8a4fe55a30f3008c62dd757c22e06da5d736048ff6e793b0e65bb2da83bdb997728fed0d7d72c5b7c5047e41a928381f3b26f3eb74760dc2e5ef6070b347b9062e65459b9e1e4de24656980cd3d0ac3d2c44298c6c66654f25ab515b8aaa95549872645c1fa7b8e7ae2fb1cd15ff9297001a173fdde9cec787e5ebad3944dd92902b5f151249f44b2669f8738d699370839064fdf659540c0e7caf4e2b5548842d0b8a71fdd0376332d60292edc027f99232048575238517e73c2c9dd0a0505c90ebdf65d9661a1e7b96ecfad6b878b3cbaddd5a897d87ba0285d2016dd45be716fd0d2dfe648f6743b4c295219033dd466a656e422101f5712fcf0c00ac9359873bd1ccf946e6f26e6f52084824eb5589dead24050495007b923e0e47bc76444966d04617d84a23b56936b3da9b3c54f78f69be20980dd73f032b7650cb32a26b73c83134f5a5870d81df05a15029108c63b12a4efe6460a6e07d66a3a9440d23b5200807ecbe4a1a8db384956afa3d883fd6053b9e7e9b350f720c711b9a6aa8d034f3693400f4401c296360a546982af7e9e338c40416c6f8cb89fdffb88d22ae1a0e4fd9931257000b0b5f8f03b91b5e893f9d5d633d28d6a83fcd4ad445527f9c5d2fa69ca2e0aab054f0fb97ad38b7268d6be6d5c3783679d494c2f7c282c97dfc291a50cddf2942092f642389522e3475337a6fc8db5240cdb5b9d4b516edbd8e769e78f7306aff9625a099e7bd1720e4797a8ac218cc5a6f490889068f489b89c670a5faaf6bc8cd0824f765e070a823405db868a912783fba525fad111a1b204492101abce6f68565b2c620315a16d2c80ea13b5cf58dd57c995d12a668e5270c17c577ec99d9afa9033a5513dec1fc3708e526e1713067b0e3ff9d84a93328b45995460155122858bfc1c548c0c65c8c565e46c18e13b92565ec7b2bbd3ffa29301924d6b0b8e6df5c9465900338f2f6b805e54b965ac2fa20c418b0f2b8b5fd2c185794b448a5bb4a5e587118a97a4e469abb91e83692ce660dae9fc8bb86a4b54f40335ffc7e00b6316942143c11296602ee97712c284c1b798dc5b69a98d39b14ccf42000c711d7d90ebf8e7bcbc4a1141891554f4fe015317d3edc8b26bb675d53dcb87801ebc997d900be5dfae770672727a8d97987e7a5d0b3fdad792ddfeeabd1aec502aeca514c72da019f4c2c9457c654b4bd82e6c064272001dccfb5f68f69f6bdf9e7ef85609fcf16a5618905884ecfd72eb58ec252d2b49b7cf9f7b52872551fe5a1142af0a6a1e1f43ccdff1f51a329ca14148d40d19e89a4d611cb2e0b14303264ca47307eb7ca4e3c41ec9fd55ff94e9ee601d6a1d4d1f0f3b27fd0bfd866a2039f46e46fb913b55884f07b3dc45363b7ab2ba80dfa6f0e828f4a8ea11ef8e86e1120b503303dfe074b8392b73df0efc4f9d9667ea2f8f95580a68e4f51d182a92ad3de09ad0f92e3047bb4270e20a96c35860f59fe1bda51e9ab6dd7c74533a5c65fda1e3073857d3869d5a092dfc32b8ee3f0fbce7fbabb78a7668d9adf3082e942002ceee8d423976b77b37576f28c6ee12b13362613535fa7d36f28e92c7a6a2994997ec111c54c845c37e827ec36ad339ecf5b4d8757da2e483bd994b3013365cc1fbae104ffccc1b80b389e661281ac0456bf8496712ee569162cb5fe8d4bffa96fe82270428ced2abe733f6a1d10087f24afe7e58d48dbfe3506259058cde88800e80d548fa0a4492d1a39c4d87ee4f5ae8aec24b99173f08cdf34d50d1e9d943ca81fbdef608813f2b5defb6c03b53e6354e4d8673938321765bcb6cbb81480d66ca5a764f9fdf480c5a1ecfbdffe1f8b246d60633ba32442f3bf8ee72142603fc1cdbcc5ac51d3f71ab7ce15a32fd81236457e91f5eb6faa81acd5cc82816c5a0d978b3702cc1f01d7831213d0678a2b96311af34cbdb859db90f30ec4264842ef8e28d86ece5f56c0f1a1e8e02b2252c9180777a5f117776b66eba305ac0bd4b98fcdd77649be956ae4b224c5421e41ff1fa5330ba49071f2f965189475eeb7ae22fe71a105dea781e4fa8667a8709a25ce494df4b676afc1106ad88a6e61e3b92a6a234a7c053477d728d961417dda6fa0c5d39c239504e93ea082f32e981e494bcf3b869d898b9e4c25860e75bf3249615a11cf6ec25b542e6280de6467af4911dd3cb68bb485828b9b4b3cc55b1b16cc55cd724324c68ba2306ee596f66a3d85cf7adabdee49c7182557a8ecced3cb43120bbc0894d6318260472f09af83e5cf0df86194b8c0fb93f162bae322d281661b57a7fb7413c9d9daffed3193da49dbd898d824a0f8d28d8c7823fad82564741c58590f48b89d33540b63e792cabc1ce0a81db44331564a6d1863e79e461e02ccaf1f04cb5d769908f049205c5c4bce158b42bf275ab528c9260752ce6abae3c0a37eb5753792f714137265f65f9044eed9ed8a0348027232390ad551ac339749d05db4c6c8bc67a1a21be65b66ebb9f408ac4fa8f3be38c7d815eec62e73222a098fb7af8b3ac2080c22214320c74d50ea6c9f85e63ecd4c50d481b3b5bb27df91a5598708c7e6241ace8fbd17f7ca9e0dbd3efcbc2ddf869280c1b3cc2b83517cc5f1f02f622b4c83ea6bb9cf5eb2cc39567c9977859e84718200e3c710e06732023e0912dd6904f3dcb3ac1067bd00b414e1bb1ca3ba8ff2a6d76ff1b37e8a803a40a6c01aa35a7706cc421bb8570cc4741348af5250040ba5d86ff7fd5240bfee1373cc082150d3505936c326a1ad73f195c62c31a1eff8abd8ac793f5498584b4bbbabbbbe9acb013c9a3a95a9b1de3fc111ae5ecc50c965ff6e7028fd7b52135c73894ec812fae174977c8c2a65210b36f935debaa8d38b3650e4eabf2a675c4c221dfe87de92727f9413ecbb6ffac513708d48246abfabf8c5bf434eb9aa2449a08033100b9f375c45b12ddb78ee67015f3cc838825845b064e21a82366142b6c0f058fae18134aca011d9fa40398934a1ea7f2423f740cf10fc9532817992c65895380ebb48b6be248507a9cf2a5872f5bad53727a45ceeb89260d8cffc13d6f739fab7553d1d75603147f37c48c1f30edcb81432f56dc1147436ac37b04e0c86edea474bc3960c115a0a4dec778af88b8b9582361d513eecf7d299536fbecda22d883fd8b088e975ccf23d8c161e2906eaf0bc551eff0cc7dad84a8f2af600f5bc7dc466adb2b4966f985da1a4eaffa8ebbe519b800216f8f5833ef9d2f1e93bbd33a7ee695257375fc1b83b1d731b43070322880ffdf92da7cc2d981917aeb53468d41d667fd39f8a1b766dc35f1318a69d62f8c1a27b543efce71513eb3e7eb776c67c0906d23587c36429d2309aabaf2cadb6b7f952cb25ea0400a8dd858ccdcb1b48b1924183219afec766425ed3eeb54156b9d54a847c12521bbc8f83bae262f40e7e43461b4a2a7c01e305ad23e3deb0e0482cced7cb0f0d2a2318851feb00cb65b1667bf7866e95f91aa505dab94ad8a5feee2834c1fc0bb692978829f173889ca156928915983b0259e94ec454d9a34d973d44d7ca17e104d4c55f7696b81fb1af219c7a0f63485a04bdf33db235dd57c4e5f7790ac145f5fa3fba85588307261635ba1e93fbd29e6c26ca8a31662864394fed884a3448048ce7bc9e700eb635f125ae9756ac70aa9ce6cdb2e0c027e3fb3bb5a330d9b41ba3aa2f457ff5aebe9282b4ec747b82d075932f0a7151d83410cb141215f0ca40da9804175b42e11b65e1ed6330afd2e71ca357cb109b961135f3a7db7580253e230746991468cecc424916984d5a2332c6d42876c9f684657befacb1b7fdcebfabc67b8e3939c6cdfb90fb7b14c04b70a70f00a30c9a06b9a9e179cd7370823a99d2af25d1a872defaf439b44542ba32920bf0bccb8b9688a89ce2af6cb2284e663b62e17cb4cebc1067bd09f2e91ccdc14c933e5564f0e2643efed4f68cfa86c9af50f30f6d8a418e73636b38e5abba5e641cca08264c19c0aed3a75624408811f6bb6524aaeb55c5400057ad5888731f9e59c582b90a7f52184fe9c3f856415f46eecaadaf4b52d65ea777d88cab37f3124072d3eb5f550d059b872f3b2c74d4443dd281120d89cfd1873f6389b3911e6c92381771fcf6b82b16be620a8e962d107df3cd1519117060ce323572487b6713241b8305dde4cac1f60b5e39fce28723b6b9a5743743c11610619022b46a1c915096c1c8f7608b5bf932a77c11942c9ad2d0e0e639353cab812b3d65135a19c86e18ff90e1a59084e7fb720ac359f82c3ae025266f8fd788ac9bab23368aa68b5aefdb745a898911638d6a1a823abcc45518ac7c983d185484398d79b539dccdf9a2635350bae22bb080803dad7f2812c6a6c811adfb7b419e6d313e4cb8d818e327e49dc4b703dec47250823579b450d18453ffa293c371c441c8dfce9f1484f05e6b31456f6ac9978c08c3fab1e84dab98db94654a93fd5ad6df552bfe67a56521afb7241217d13d87439f0f0ccf1da51a9c5d4d0d5f747820ec72b787e03c384249e117d494031406b43086f6edf968862eb9cc2f001261e9ad7b118c4dc421b7c91646702001ad627f84812aa35091b4b093e1194ad6f07254cc6ab9af81e95c533c126e60b34daf709eed271a2a90b49cb2fbbc57c0c152600f71dedb490dc1757e0a9d6ad7e3629cb207adf020a9562566f2755d76bd8e05914b028dffa0b21667dc03748c759693ee7589eb8b2ad44aaf779214bcbe8050d14a7c898bd9a7ca3401080e44350464c54374a32ed3edc379c9304100ddbf96550f6fa86cb79cc94a353c909127c09cda6426bee8df06658557368d47c81ed64057f681dae397992a8727f2bcce02356b83664ecbe3e62e43bf1aafcf58ded4331230343479aa730c4cccd7f97db06a2145ac1d318e8dfbb9dde1c77ca5fd0f7283210cf934cfe0c5478a528041c1bb767f3e0f71f938e0f78e762730e9694a67b69545185dd5575324fa4863030db11828c15d1b46665669f47750bab281791486638951c0cce1f1167d82d8964e7095f28307fbe117453fe5cacac8dc5a28f84a73342e9e2c65dcab9f16453fabf943e59755fe1aca768bafd502e0e52090cea70cceb090604306840cf9fe02304ab5484f32648316e4439deff222e8ea095d1f7f3fd4071cc3b6374b7019bfdc9509a60b84635a346b436aabf3d154ab0f2662eb387669d3e7debfeea93deec13ac7fbb6251b6044e25580bc4c1ef0f77c899321a63b863455a581de5754e8e9319a3d00e467863d337ac0f81966b354043abbeb1a047576fc62f139f73ec09fb5000279586a3e78d59107be0ddfbde99022c1aeafc2e4a1ebc6ba155a4f72ad15f192815f46e18a7b346b30bb69b345fc22ed0920a2c032645cdbcca218baad920fd09ce4a787a2fa5110a835adf35df18b20c80682f40520542ed75c946a6246e527670307c9e802d1d2ebf5217c7fc6e164ace9e2059ad3b0c6c230cb354f47aa4cca42492836cd7d2b3b42b54416247f14e49e27e72ef8fc6ff6b4f21238b03f46732873c69da48c80ed5d69e3d389556464fa6150c8c0c3bcd41f1093296eba9a7f61db1c6425a0edd862c7d529f2629bc06c28338186ce2e7b750c16f6499757a91a9fa6706349feb8a66a808ba8b52afb9daf9f79a7a4c618199e3eb77c9df7ddf27fa4634cca8f045eb29df5ab2cccc354755586e7d058a722ef8dd8b84f094ef157626ce1e398063ba39650263a46950b1d88996b5cad85f87161a479e12ef28f59568b802462ebb75ed1bc55a1cd555c7c406e92f2b9891a6f63d1141c9a00e093d549a3956248ad4fd766da2ee5a829573f3acfb3ff7d9d662ed15ab478651a16c235b1229498b4933ef51c89a9ad0c3929ab4bd76e3361bbcc7b667bdc1eb9b55b3be2c52c16f22a64b3bbe8698530e0b0ba95f257de836da112cddea873dc0f9a4c0fa396df44ae43792a2ddbe910b68fbdf70e50b2da46ffeb8fa05f054ec4e9b3e8d98b325e9019b3164f3a8cf7361baef32bbfb8f6d722ca91d63bdc053617f984b3419d89661571928d21d30a7d644d3e57a3a6299c68ff8ae3954ec2adda5a4b4c4ed0b2abd904ffadc2a644c7fd58ae7bf9d56fba4d5f0872c5cc5943df003407e3e55ce5053310d913f1a83369c2bccf56e0e58d4b41cd1e5e27753ac70846e7916abb8715ec88e0c6b88edec45fefea56d2136b653bfe4e3e3c7c1f4d8dd0eb61f83163d778e29718162239f4c9704cb88651f8dc95c8d9ba03de797a2ddf1caac4cd630ba800ea267bb6d9eafed4b6ea0b6b1592b3aa8e599e9f886f98f1afd71411bd679de8ed4a91f00e00908abc7643e994ca00896a6ec923cde251fec178983b3dc4b9c9572be6eeb00b2ee12e236310e51099f3c8697fcde13d49f83729e52d792e02c0250f3f3f95dcfd539b377fe22a993cf039ad0f0063ed73c3777d02916b7f26e18b3c956697fe0037c76abb09db9a45102ba941d60b582017c5c2b01fa5d0af8a43c88169a7e3be8b9532034833d57bbec28e67596d778866acb1a00f35070ec11f2e0f3ed0e8939890069e5c7dbc7742f0676b2d634e388a25d57554a051e2d0eeea728fd3a8a368b1540e6049e4af942e5db6214534f3ae5248c49a6cacdce0c19c479e8f29ef5385cc305c41de4439b40354925f1f1bb2564832ab84dada0c76761b9eaf861c4b40e8662d9c711dc7e95f2cafc6d19013fac97808318a1c744e18669f474b0277f9f2db1a6c3a37641cc17c5c9aaa61f85cb5979c152d36422f652834e8df82359c6cf20f1a9eed425bd822df89d2d560cd19ece55ce9b5b74b8cd555e1a9a34f6c7640fcd3e83b67140f0f3356f51ed32a8501936c8ccccb4feba6c710a1f2f5a01bf185c02f5b3f39c746897e4ac27beb148dda8d4acb70136be8cfc26c6bc73988cbe6004ff5b14d64414a532d853a3f0e866df6407af0016a9f57eb223b2800692c0743ae251b167e66043cb9e0a7f5b33f1c7d7cd7dc9bf5a8c0e23d0bc8d442cdd304eb3d226ed036bfc47cf637b3ff028824e1043d9c9da2c19c1598a20ef8625c0c591e86b554e1f19608335f171abd4303804f954132ef9d60d5cb554f8426bcace54f9affeb08047a13814900f34d06fec04427cfd2e1fa9e774831df5282211c696ac9080c59ea29b02ec3ca3e9bfc9dac07ec5b000cc11552352e25ee15ad650691b1a3f3611e09981fa3e36a17b5524d01760a9ca187baf0327fb42e36127fe5c1e12ee554244d99bad05c8a9be3648da530577c8bc3cacc154903045be1a0afe71db7f96f3e52866fa12a15fa63cf837aa5035a6454786fcf1fdfdeda0ae7d44f03ecbb8385f47be5a3bea1d998594e0bc55deb51b7c3482aa6392d3762104a2006fd59fc5ffb49e6dcc2fc97820351fdefeecc0e1448af189c92d5d5d5f3754581c24770a4a42c98839a4f1e5cc2597d77cb9045057dabf3b73e424b13c7630acede1c8de9b6c816e04f9ebe2baf43e75e30ba4942a1d8d8543327f7e9f0cd5f10577a8ef65ef3992123aacfdb1748ef976cbc0602b910fbd158aecc878b193d5bce0cd422052cb3ecb8ea530262c96d02eb7ed18e2b4f44282197291e1c9176de603f667fddd42f78bfccf06e7c6b1b8211347e1889f627fa93018de54402448c2721d869e0088e6206eb1bb481ffb205a3f47eec2a879888cdfbf1ff4e518c22e6519a2c9b6ed96792d6738c738ef31812666b43ef506bb0d4f89a0d2ef785546ed0a7556ccaae2b5fcb44cf3b51749c0b62b6477997bc4dde9c79756348d95976c44d9fcfaca504865c006bd0579ab544bc23ae355eaee8bf3f3854185f166c179512aec4db3e807ebd47929c87a53ad7641c339464782997bf3f3f72c164ef63be9c12820d14faa4a6c977db739ce0fce3307e35227d9e648b4135f4939e2ec538345e23a43f471912b571b4102fb33d3d177b0af1c3bdcadeb53f2372fdeb3d6ba103050ed32c630fb1ebe70f9c75b4f54c398feccec616a6e0fbfcf5e77441fe474a5655404104d592c3c2dd11c42d6a1d399f4d006f0107dd6b2d2b0ca0bbcf26558784d14ae856508bb78054dc1bc7ff4a1d7b867763e473d49b9a0f4690c0bebd83f9479f8a8b5edbcb04c7ff236072bd0012da2948ce3562516e4cb3434648e546d933c9f8e153656d21164b8ac6d461aadae817dfac95062b292ec0ea5e781b3c67c81cf8ec650bc62a1595a09b06ad0863899d7945db94ef09e8e93b794810a4bee0930a1738c64b3026704d5ab2ef381bdb3b2c0af799ddcf5cefe3cfa7891a933c0f7a047c45adcbb5793bc3e1fc3b8a03a1b67b3c8b1138c1e17f7ff86a2b1b0e3fdc7a6268b041ecf40113c9122bce1e6aefafdc67477dc3eab5c11b4d064eae0d0240fd6eb1f188cb40e896b53dde1b75c3564bb1a610009446a71faea7c904d23a5533d8cd2b9a2d5d088bde084ad3b3f8b3f807426a7f98aedb3f544a59baacdf44f3fbbe1f28befcdf67daec4a349f12bf62e8768da1c71aaa9868ecd2d9ccfbfae612c941593dad14f06122daf0e5df4bad361b9680a50f5f4442425480a8981e39f2aa5e50db211818703601852dcab1959d528e03a8cc8a7efc77912a1e4af977ab94167406252f7ab54b7403a4468138f10bba45893c717a3fc3deb45cfd5f4a608137add226908b5ce6943cbb7b19351428348b76bb47d4a3261b3a21b283090284ef995f1c2e219c162ba0fbe03c235caff66338a6b6b3e4c9229d1f5ed8c1227b8f8efc41fda5d70f5db8f6d4d787b897ae23ff8d4d0b441f9dc5c8f9e11c5a6477acda0192f2bda6cd99f2e6b52e8142376e2712fe101abd5820da53b142f3c12ecde3322fb628918b9c7c88665ecf9a23a468dcdbef8c9102cd5e4feff1cda4fc6258444986a2d23218bc8b75cad4c85128f91e42e6e73f34faff27eb244e4dc210adfee5432f603df892885d4f4bbfae61e7c44e82ae31a4ff8f541be4a06836cb8a82ce54890ebb2068c21aaae5861c617d6c642be6acef30882e36abee2b578fa18958af0ba8fab1eb42301e83991fc73115cce54bb89c411edb8965f10114095dfbc5a3f9a4890bfe8c3f7206e3e58912edbbdded6256ab41efc2befaf9c36aeac27f23e2cade8a982297b37d6fa756701c3e797f5220a2430d5ef0db25a184df2ebc415147c12581a0d39a736c28c7a370d01fb852644f0397e986a9c14ae4e4ee549073c122b8bc6225f10d8fdbcc64211c416553ad377d486bdcbee4a05c9a74491e6cd6f838511d147b043f6b8ddc60094c863df70f9c9d3c0cdcfe0da2affd33967d20349f4af39540b36fa91bfd9134589ca059c551085d583a9c04650e78d9ab360b324bd71df5ae200c737847a12d39bf9146adcbd7f2d00fd52a45501fdc033310d15906c121ee8dad6f23a827ddbdb9e933a2a4d1e6d4acebcf43d89da8fcffcbc86fd197d41bb47db678eef569a8a59318b776bffd879c94b3b3400f438c4f4c240c0fc747cffa33b9b26eefe829aaf1df0ae3590c8d659e4db561a3bcca1c48e7dd5266ccb513f5edaa56626a879d441bb6079a1fb67051f7d1803ff389946430265bf7afa181d5f8240c49d0b87040b950991941741ff5e53960fa70059137a0ee17f5759a9a79cdc93fbf3c80a79bcfcd515b079866aabc1f5472343f5949beb8b7ef94a9f332bedd87b82390650859072645d628c6a84649d2b9cadd105d250734a76108dae69285f11302d95f792549be83d5666e39f7487e4f39ca170725362cd0a3d21e220b26d8c8cb52e6593a86dc9a8b344ff25bb28f5f1fd7c9e27b2d94c53396fb130f3baaf73b883f3024edcee28deeb7a072e3df75abe790736c481ae376304a9408ae8b34bd3f9151ce70c678e14fae0f604f46bc81ce0c18c64d997d9e7c42990944812b478739349daad4bf959c3a89252eebb4fe39436fc744660a219cb2d99438fc0380cf29ee4db3f06e07bc7588fe428ef886697d8a5e833338269961c5b2744bb609f4c1459c944b7c65182f3070402e4c74867079232e9d3a0cf8d8aa69a2934d0351009f5654314227833d12a074ddef94bfb408bba07e1ae1ca321625755f031df5f9f5e47b8ced4af9a4604a7a0dc7e4c297d4ded0d2a4713b17e4276f3141e45bab9475e7a9be5a002c8a056fb583d38b66832aabbb4c10ee4ac890dfda83168ab9429ae3b2fae5d38630a66e39858420c1710d82a23986903920c1c496097b62caf6dccd5df87e977e0b73f24139bb70f6f8f925b2e237f8241cf944123e20aa87f95d8521c5ebbd152f6b56a695ebe99c727d5b51956a558630f3c39123cc65170aed2c125a293a3b8315d48b7001c8a8be6d2d12e9fa1b88442b638ecac3b7787c3587e54e0c379734bc96542a68eec31f5b5664e83365a4251946bfb669985f38684e2e60173bc1cf1042f87e69c9f1894888dac1595de528c2c3dcdb0620714ce205a4ae11aae8fabd38daf260664eed932a134fa15758c7f4b90b1745afc83f8ad283611e2b9f892d194723ecd7ad77033864db99391a806894f8fae4125b053b6f936c8cf2087709ee7dc5c49e0cf94f89df357afb644bf3de6a84753493da3c49e04b960b1632eacca6f5732af75a53b8be3ee783cf0ecd650b3a2e98580516a3a22563025edf2e4965dc1f858edca56a6e9e10d422dcc2171b5041663312ffe64ee23070bc1e22f357a5d9ad1dd43035f17b0c7654a264e432f2b40ca9f8754d5c405c19985c0601f55b850d66e1dc580cde01721f8c7cb05ae444c90aee9db63a2967158d5981d20896340f3d626a20011862d926ada1c2bf46e948fc42a6bd2a097857d22671d49d2fbd3fa026764c1eba2068c163b163b722786d496d99a3b6634d981d08f2153bc80bb73a8155be26fe4a30d6ac1962e36d029d32e9c3c8d3ed313fa11d88a91d5a2d50107504ba0e4bacaf2e98ca2756f58358652d713e4dec5d5b5bfd76f892e0c9e6431507c18041776f37085b9aae0ace177691df12d6a580750158a6370736f56df0f98ccd9d51231b75599d628d6913e2675bfcf5c7604a738ac6dd72f99b8231d6142a186997f27ce9af8c2f5b5e5f96f0b5cc4dd34678f41885f44e8f1debd7fa5c028e5e7093fec74e3595cf5d2fac60e2b18506368c339d37acd79966ae0b5046e703b97bc56492daf048c04603e340778c86bf93c7f9c88186a190530d31bd648c9086779da36184355ccb0fdd0153650b83c6d4b39e0a54b79aa614e6a022180f607b1aa23e70761fa002e286685c3701ba1bcdd1257bf463e3e764f9afa85358fc1facf74fa2d1bbb21d4078cfe2243df694ecdffca802c22793cea24e8ef415a7abc1d78184100e8b1fe179b155ec6fd2cffc4d5530af52f508ea6a074b459d12ab9704ca9edf1a70a99ec5176cc4b2cf79fe860c6521459bb9519848aab8d6fb9008b45d729c2d676098a3cea10369eac245d1d20e537ee8372018d62717df699896590f813d1fa5d2c14637a0ac9e4d2e17db5dcada849c4fa86277feaf8a027fe760c78d22350e245c72f4fd280596105e13ea3259cb6f82ebe0bd081cad0ed8405c285da3befb00689546f8e901acb28555c7b8f38d70e723c9c96a5b274a80daeb7715943e8e3536dbaf15316dbc053be1efc7d24ff751455b530df28ea4829a0d5e4f2cef131a0ca7b4c0794937e1e9b4c3277e2e86c838e0877763d994576a26e08346f97797a85076e2886496c231165e9a3a3dc9b5efe1b19b4dce7900b20889484063985d682a736e7103bdf8edba3fe6b8edb68f3851cd9e402b3850e5451ddf982fa3d8ce2167fc71a200be6cf3b0d79d2436e484b50f8df259cf92139133448000cb10969098b400392541f928382ae8cffc759e2beb0e522ae7ee1567c49866597005480c492934cde7ad0034ea174e4927ce7cd86e299efbe8c4f157d330077f2f5eb673424ea2b8491604026b6203c4915f2fbd639a267f7ec9356d01b19b72cb6bfc0dfb73133e4cafa31c0e403e123c9fd5095d2ce41b1545884298b97fbf1de4ea21f3cfb4f4264910f9d5babb3e0b1520f05e9a47202f337774dc7d30c88645272b215245f89c32df85fd7b5ac5f4f716b231ea71d4b159f1882c054eebddbb09cb905cd7d374a8a4263941e2e0cd0e125f9fa280d4e31a71c0082f584fefb8e2794d574e8bb529cb12131f0c6cc9f7ba36485a9ae694dee4f932fec624d9cb235f92674c4ef56a63e0e7384a13bd1ab966630e503d1ea9d4634ed3b48acde38ae6adbfa39838335de90e06266c3fd7c33165c258b5fbcddee4281ed214ee530bb58fbf38ce409c223ce771f68783235de42f18af1c1fab3a1420f722d654b315aa1a51394f4b484d9a83104f4522f0e402919a61a783b793c8e04c03b0d6c98110695035f72dd55b79b551763845d67310e648550c7db320c11b7f62377e22f620ffc136aa6bd03129aeaf23ff7ac3414e37a4f62b4b27a521cc4c2733ecd04b0bfe9daddf550ea661f7d2be10ff36af97c4a79400779203402c2c5deccf72c1c08b00d7c2a89adc594627f505dd8d1782ce72509471630b3eb01a0c403fc59a42389a31fdda9a20573486eb313d6bab36a89142f80fef80d54ee5eb1f01d134e5dc56581d7725fee632c85a7dae4d53aa5eb12bf8668586433d3acbb0a8855f7d4fc60264a0a34698643543cafb517dc928ffec2a9981b3c5a587c283d405ed077d7b18a347d28beadd63bf1921248ba41aa7c86bb0fc1e162227fb4b3e067d49d1c1a4f4cc16bd682c600933d7f09306ba8a7f11cfad230dd497aec6505744f57271b00758279f1efeb7eb2e4b13c3e55432583d03d3d2063ea7b7bc2971af7cfd87b5589aede0e4195676175a93855428b486083d5c376a76932a3f4a37ed43239588c078925235537276040c9d3926a1dd5ff5e0c71c01757af12a334cf49dc169af320d72ff3b0156c7452b3de7c6faa58722c6e6a047a332869c27b267d57092c4161ea7b58273881e14bc22110442904d2f87ef34c1a90a0e04d079d6891869e446af5639e619f3fd5d5757f2f521d6c5ccb7de443f3c48ca5729d079ff41bb507090c3ac2063fb704f07cf9fbdc4e86f037dda58ff6a90dba1edfe48760c68fe339248ddee45a002d252a0a5ba60681e8915191201b44d55570c1f139287e04ca740955de7324df60c5eb54805ee3b4c3a1f344a8e4c4cd6329fd9c204e9fd5822de4fba5711f0c13deb6904cb82e807aa0cc011de585be27de03b4d4b05ec6de14a1ef1009623f32e5f830fb927fb1b708c3cbaf545806b8182f239b3286b7d20e10a29bbb636e11d083577b5949b126858db76c1b57377595a399429168676d2b62d2ef3c9d768e1317ae59424a85d179eb3c4302f30ce4db286090389c8b3b44f9fc2d184b621f492829a2f6576d6b446ad72b8d5fb86b0f39e7485ccf5d3de4606f8dcfdcd86db1c0b26441a797490c63609f5ca4c7dd14dca974ce745e41873ec26c5107e45b1fd0c9fe3ff94a6f08862adcda4977d2121dc1bf7342dc33c3ced29b1ec454c11b09544209a2277c6e5f91d256143e50a7811c43a8b0a2185616533fd94bb50c2ebe3c4f9b123bbc9329915db52e9a2834a79d0045ff69e765284a1cf13b966380f5579921b0e880d1fe80e5937fac42abebe6d69fce831d20ffaed09c642fd22b9ced9c81ee9a9f22504822fe3df6ac4e3498b36deb91794028209467ce73ac4c6adc8416675130612c5d4c2160965d23850a800fe33039226055ebe4a18d67ff5b4eb2e5f69c4303b4d76c58c665f6aeb9a4f26dde91ecbd22818ad845a6904f03a0beb03369f67fa8ef5f0b045eef8fd6ece77bad520c27f6bab0e89b5f11d1ffb64a1c8070d29b9a4353fe4ed3a7dd329448e72e441e847c170b0314199c2d0639efc512eec2c83eea6e0574900590cdbf0dafdc23d749536c1c5a5e8eb57b8d8c29024ce1525bd5853d22b7ad1375a261d46fac517a96ba0573321c8b6f7e1cc9cf6570da76ac41303c22598da5eba840cdcfd6ec7bbea3b0ecfec7cba00170c445379d718a3ed3f567c69690a736fc80e00c59c195bd1b2069ff2d1e3f27d6e9e858ff0af1cade41020b25b8dcfed4e5fb0ab8d05061d19ab76f9b19fd269f18cdf1e3e692403a5fade8da890f15037159b2e7e51f1c6bffe103da24455dcbabb4eceee300259b8d9448c200e64ffd03e64d28f20fd1205ffee8e6be072d09a387ebc2cae9b27206c3846c7c92cf92314432548e18bd4c357262f4309b9288c4ea8fde4e5807965134f6352472cdd3fac8f15e8b11a2a532f0c9ccfc84413739a375300956bdf248eac3b39726b3f271ea8019550db9b5d780c920b63eb32b78f9b845a04cf22f3c373eda686679cec91d55e4474c826a41ee82147078f61f25c0938ef0a1ae303b1f33dcc0029265aa41ae63a70e56c313e13303300efed4c729ad99a5119d53433afeaa437485aad4666f05116d2ddb479a47e7c5e4c3a0dd2cac6017d968ae09afbe245703f1b8be00a9a09720f75db0b7b5fc2ea17be2b472fa799a7884e713167f1bab02b02ad82919228bff0961d34b6163c47fd5e06cd1800f9546d9a4338b1465f13167b9f303a19e97cc526ef9a151b2f4df92d0f1aeeb5e0d8796dd94116cf4510fda78d0fd4e0fbe15cbeeabbc43fe39938c95c7640cf0ea51e0568588be7672f20556a1999c9d4196dea21c8c44f56185ef1c7fea8c68eabada5e7f3fbc9c792a6ece11d9dd2bf38b33e36901fce6bbc13972c396d9dadad5bfb21327518b13252153ac9005f844703f72b7ce9bb0f9ba95942932554a31a158984cf87d66039905686b991f8963f44583aed34224b91e2269e5a74bcd5247593e0d20a37ed10d2584363c5193952ab3698f60a095d2465ae736a1992bbbce21fbba17d51bcbe93715812d99a8e702eeb9869af2bd21b81e4974846a8ba1880a4a844b17c41c360b276870bca2f886d8bab07da980684006830a0d4de55da1f6dcaf7513060c4cfb037ff34198b4add8d7e8639af8e6f8e030202a5555ec3f8e8fe681d3d79e6501dd9c98038ab1abaf4259257ef7acaf1f980dbf4525994551287c54e8dc87468501094ea306254faa130085a3593f164917b8ac80794782c71518bcb87c3ca0ccb794501a182be5f16906de14ca482624dc2a3c4c918b1435759ae6979bcc0c91a391ca0d0f4e700c48188b44f70fdbdb9b0e407a6ea972b55f637ba04e93fd8bbd765dde7f1a</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">パスワードが必要だ</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI2020 美食家</title>
      <link href="/2022/07/25/NOI2020-%E7%BE%8E%E9%A3%9F%E5%AE%B6/"/>
      <url>/2022/07/25/NOI2020-%E7%BE%8E%E9%A3%9F%E5%AE%B6/</url>
      
        <content type="html"><![CDATA[<p>矩阵快速幂。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p><a href="https://www.luogu.com.cn/problem/P6772">题目传送门</a></p><p>首先发现$n\le 50,T\le 10^9$，大概可以猜到是矩阵快速幂，但是转移的话有边长度的限制，需要拆一下，拆边有点爆炸，考虑拆点，拆完点之后对美食节时间排序，每次转移到下一个美食节开始的位置，然后添加贡献即可，复杂度：$O((5n)^3\cdot k)$，可以发现，这样做复杂度有点爆炸，预处理出<code>2</code>的整次幂的矩阵，每次用原矩阵和转移矩阵相乘，复杂度就可以将为$O((5n)^2 \cdot k)$。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, pair&lt;int, int&gt;</span> &gt;</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">250</span> + <span class="number">5</span>, Inf = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, T, k, len;</span><br><span class="line">LL f[N], g[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    LL a[N][N];</span><br><span class="line">    Node <span class="keyword">operator</span>* (Node b)</span><br><span class="line">    &#123;</span><br><span class="line">        Node c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len;i ++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= len;j ++)</span><br><span class="line">            &#123;</span><br><span class="line">                c.a[i][j] = -Inf;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= len;k ++)</span><br><span class="line">                    c.a[i][j] = <span class="built_in">max</span>(c.a[i][j], a[i][k] + b.a[k][j]);</span><br><span class="line">            &#125;</span><br><span class="line">                </span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;a[<span class="number">40</span>], b;</span><br><span class="line">PII t[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m, T, k);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">5</span> * n;i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">5</span> * n;j ++)</span><br><span class="line">            a[<span class="number">0</span>].a[i][j] = -Inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(f[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u, v;i &lt;= m;i ++)</span><br><span class="line">        <span class="built_in">read</span>(o, u, v), a[<span class="number">0</span>].a[n * (v - <span class="number">1</span>) + o][u] = f[u];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">4</span>;j ++)</span><br><span class="line">            a[<span class="number">0</span>].a[n * (j - <span class="number">1</span>) + i][n * j + i] = <span class="number">0</span>;</span><br><span class="line">    len = n * <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; <span class="number">32</span>;i ++) a[i] = a[i - <span class="number">1</span>] * a[i - <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, id, u;i &lt;= k;i ++) <span class="built_in">read</span>(o, id, u), t[i] = &#123;o, &#123;id, u&#125;&#125;;</span><br><span class="line">    t[<span class="number">0</span>] = &#123;<span class="number">0</span>, &#123;<span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">    t[++ k] = &#123;T, &#123;<span class="number">0</span>, <span class="number">0</span>&#125;&#125;;</span><br><span class="line">    <span class="built_in">sort</span>(t + <span class="number">1</span>, t + k + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= len;i ++) f[i] = -Inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> times = <span class="number">1</span>;times &lt;= k;times ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> o = t[times].first - t[times - <span class="number">1</span>].first;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> cnt = <span class="number">0</span>;cnt &lt;= <span class="number">31</span>;cnt ++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(o &gt;&gt; cnt &amp; <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= len;j ++) g[j] = -Inf;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= len;j ++)</span><br><span class="line">                    <span class="keyword">for</span>(<span class="keyword">int</span> l = <span class="number">1</span>;l &lt;= len;l ++)</span><br><span class="line">                        g[j] = <span class="built_in">max</span>(g[j], f[l] + a[cnt].a[l][j]);</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= len;j ++) f[j] = g[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        f[t[times].second.first] += t[times].second.second;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(f[<span class="number">1</span>] &lt; <span class="number">0</span>) <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="built_in">write</span>(f[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 矩阵快速幂 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>test2022/7/25</title>
      <link href="/2022/07/25/test2022-7-25/"/>
      <url>/2022/07/25/test2022-7-25/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e1d97e6103001bb7b03e9da6e655da5e67b413ce6dff5d7421ecb0c9d4da159a">f7c84d52981e04730e0cb33ecf03c0388f545a1418cf72ea712b21717b14e1a647627dbcb2493062ab3bcd6356332a799137c0e5d69fb216d4e0fe7f4f6168e7d1db69be9930cf54a67844955dd9bdad21197b47b3d8b31a8df5acec7cfe051130e2c155e996c65cf803113ed6c8480be80910693483578e93d3ef6efe93b20b2ca1ddd77557fdcc39b84110972105daa9e67bec8b31e02eb8b18b7b05b209199c5ced78ad55919e20d895d857d66273eb8e0b8e4332edeca803373fde1f177312d5f14bd815f9d380f49520911c0ac01ea8ae302a11f56f85ce340a0cb52a06f7ffcebb5fe9054f96cefdd8700f86c007de00cedccb0dabda05cc4943d641568c662fb1e5b8ad52808491519575d530d1af388345ba8431fe40b0abc8b35f49c3929d00a9c5b95dd838ca10c11496e09a51f4e67a55fe52b22b84b4c6467808cdac38e2341e93666b4cef9bfbd32c72a56f51d36e005b6d6fbf2eb7ce55a413b7151478304066773354eaeb72322f16c247fdc83ce2596372674fd757aa4230de610e0137b2ed49a5938b540b3ae1ca76aba456cd4c9760f667165d3f0ecd7874250d2e54266f1f9464bc98d689252c7203a77df398169ac67ae29c411bb2657f4779b1f802335559089a86fd63ed8092ed467970ad7226f18fa8e5ff9a2fbaeee6a82ed915dd643b9d030e9b10089d06db49df628950dd3cf3018f81a6efb05dd0bc02b4697aeb8fad5afa371d447c9b66c8892711c6cf470dc008cd6d7ed462486350a23ce7e5700840ff59aed2653b2fae18acabceda724f281a0b55133db57bce0c67283bbd5484023308835bae55bee6797dbd6cbbecaaeb0125712d7c975a0e71c3815a8a99a31f86af336c205b8b0987c26a275831bd0f84294306b268e1c02b0d0c7d5bc4ae0a4837e74cf65376c6e7e888d8a2bc97b01b507458a18993604ae061f4066809dc746fd3b4682ab1c2d920de5582e45b74d0f2b6e787bc492aedd06a934e09016b25e7a039586ea8a3fe9da9f7e16b4c3e068991455a89b15cc8ff48fd7937e184a87514d958187426b97f2693208ce7b6951140937a593a6462009442174308c4a36a5b13f4fb030c363937273672fea209c419a495311388141992b1fbab4c9327b85e158cbcbbfc34f64926afc2e8e74b8de52393060302b7df891f6049fbaff9c01f977b8b262967f0ccb7f3553203380dee6516306a533227662013065036b8221b65ea18d952fa90f62f6ea78d93d0b8dbe1bdd37c4bd66f2b7c0fb8c117d55d8a7f0a2fbad3a9c28dbfb61c40ce6e1f71e156952da6752e9cbd4980cc2b10563d6de81cff8519d4fc45a5f6c9b73acf1a7c5cfe2fc6ac971387eefeef3a65ec1be36553c3cf1c28cdc2ac8ec65c82ec952d62a9a1c937daf76f7728c50769e54ed06e97d15f2a0db722acb5e30371ca5edaae7b16258982e5dce49fc370425d772ed337032f5ae5980d8b80c0b66e4e30f3d4c780d86829779a3356d629fc7274ab0ce8b6e83aa875c72fe054d0630074339e3a77777c695b04e5258f7d45a58ccdc4ead62486ca37f94a5c7b96d757f32d754d6457f3462f67aa7325f88ecd537497bb609673bd944e0abaa022f41e266a88ed3fee7586edfe61008d60d7d1511aa7c9dd85858cfb63bc93167698d49ce542f525d96927ffa50ee327c65661b3c5ba5cd94337d1b9e2fe01025f0fc62b68a9dc346cd210767ca5e54bc6901f2a03421379e99f50d1e8ed4b569ce16af8c5d908843e82052e163e47b33f6cecca9fc665d8321bb60fc6932a38eea0a0ab30f2869d20e3352b58c9721d0b06f7c613964f1c551edc4ff39bc812e8c0bee0edb63e95d65d3a6a6a423477fad508412be7718c36dd0f6d6ff7ca72b1ba77dc42de6fc165d18607c3a212d56279c04cad1e1d82bd8d1132b95d0654e1b8b390e43030ea922f9379c488a2af42d8c76455bbda6b65fd08fd3f5f868c10c660036f40905608fcc08cf72f11edf5ae3e1e668c27f6091fa23b7137afb8c3048906a64fa376d5b24d8ce326fd4008eb0e5e2404018eb980b1310cb6a9b1552bd67c5634e10faa222006a5bacd4a5acf2dc34d3d2c1b74a1080d0b17a8a7c3bc91b63dfc4dd6217420cd7b4ebc7e5911a5a83cd365cd88841b0703cac14128638afe88b5979ca7a0432b6eede8b537be6d4597dd1cf2e2a7064d89a909d64a3bb7aedcdcca89c8b2c333906c373f31ef3a21653a56ee90d4b949f8dd32e406cf7f72d11b341cceb3fc2edff7828290756b7d1f76473073556d5831c37f4c2e0d4c540ccb147e9064499c67a39c5a06f047de5830a0f1e32b76577d653dab203dc0725aa6d4eb99395dcf8dea8965714931d25b3a7fb5ccc111fddbe4f40a251cbec87b8e3a0ad90a86121a5ce2ca8195cb182b47143e3b093ee8e8e278977a162fd5eef4af1ac61b38c8755bb8e54247873dc1ed8dda94b15e550428f9d84e58d4e581c89bf1f6252d2182aaacb193239e0e26743d1779a282fd0a05b8311cb03db1f6d5feff51ea4587485b45d1c525ca11067bcdd1117418a91325db1a2ce7f6bda078f8fd5852e334ac024e6aba640cb794b62adcae2bced66774919e1d258b560aefcc25187e5b851794f837b226b4e129592ad518f86eaba851b47939491c94dd9050e7302c00b82a3b591f7e88c62a5084883b20c7c6198dda12a1dd1cc0da74e01205492fb069774a53c523e884c89fa77a124c43fffef30d6627fa83e254b01915c9bbe8d79bfaafcc850bd688b94249a25c31f9e3b87a3cc6bba2a9f324f0f5a42b832b9aaa887451d1c28174fbfb2d2028653821fe42dc02d002809756e7b65296f9c933c00fe08582934354d8500435486933128e29666d7ccd6ec7cf42e80661ad3e8bdb2c95903c0d9c14868ea5efcf78c4da9e1670daa31d2ad10189b79bb89e6a485e2830ac32f9bfbd85a2ea27bdbaf623a6f1c0fb065165155568b536c7a445e41120300330d2cde381a155ebf2d61a45cd4b48f73d9d152da374e819d31af97f1b429564e70d6c302583b8669ca7cda848480852a2bb84ee1a04f805deb7f6fcbd0f6613e53922d952547ca4e933cb0978ae1d4078d327a9bb70557f4f6828957b48596024e5d70d24881e1b05e131635aac9951fc2a25c02c1d4d87e412c6c2c03bf70012639461cc3b7a4f09111b76dcd1a2bd7b955e02e5cb7a2c6f368d243d325faf3c2462200b9ed21f9139b50be1b53ba86b6592df14ef51807f685619b1debf63b6fa63f517fc22f5a18cc59b605194bc3efa998909ee0f0f5e7845b4d379d43147ec499d6b901ee64bdebf7f38e870a3217cc8df6026794b62e81d4e3a5066eb98fa4634a1b97717c0d6d057cd446f18b02355a3452d4a5a2c8fc02e486a4228ee55ce63825652bea4d03753c9cf7934d98d7a73c340048e8658f129b59d1becd0aaccc08a7e41432f19d7b64a9e936ccbf16646bdff7b187320c5746ef45fd49b91988e5b404794730cada5c31c4fb8d7ad8299c69ea9423313cc1dae2751ad87f72376267061979bd090f7eec6ffed2e9ca0dbd0c4088639dd13dd3167ba846d8543fab9af3cec074db224d91558101e0321b20210f4f5b44b0718a1b2e35e5084614873330fe79ed36fb2f10275c495f8bc651cbfb546f8759575b34700327b3ed88d679f780621e5db48f60eaac0bedfd57121784e2aa0bcc66e62166b091fdb9f3c492fb319c8ebb92d8c33104b1bfb8bb7c9daef49bd58384c5364ad2ac782a10768bd845eeaad5853f1c0d48ca8fa8bcd8a48d0c38d907d827910506fde9fd901babd03c5fdcf0426bc8daa6afbb58e5f9a0ee80186efe13b0d0960f856116c437ad855c3be5fd782f68e1a3d1c1b9750948d5bd1cfbbd911a336752f7b6428fd1faf1b1ac45d8e0285b2eed288c93503a3d82440380e639471a7a102b634021bd790c64504ffbb096ca0f80132066fb35ea69db4ea0f41613f677aedfc8f19bc3cb5799dcfc97bf4947e12f08613f06134843dece1ab35509e989e995da4ee1bf404058b82afe0927d89f1861ef1ab0e54c965771ca29f3eba328510985605949345ab85cde6c4243e36360d4c30f5f33340baa08e2f094f05e67e56fb9b0f008ac635f8075f0ab395abab96d7c8be6a374e453151899781b52b203b098f74b98a5b2114b634f8b229afdc0613080700bdca358e66655c5f27d05d867c78c36826d879f6267296f595981d1555723c218ebf161e724e81a489f297248a882ea791fa0891a499fc837d85d07c36762a9dcd503c5bf59bd20f156426f5747ac5dbe3dea47e13536513c016d6385a5b8aaee2c870720e8c85412c46d12e366a96a3d6b186</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">パスワードが必要だ</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>暑假数学杂题选讲</title>
      <link href="/2022/07/23/%E6%9A%91%E5%81%87%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A2%98%E9%80%89%E8%AE%B2/"/>
      <url>/2022/07/23/%E6%9A%91%E5%81%87%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A2%98%E9%80%89%E8%AE%B2/</url>
      
        <content type="html"><![CDATA[<p><code>orz jklover</code></p><span id="more"></span><p><a href="https://pe-cn.github.io/">数学习题小网站</a></p><h1 id="problem1"><a href="#problem1" class="headerlink" title="problem1"></a>problem1</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">给定n,m，要求选出2m个数，要求每个数都是n的约数，而且所有数的乘积&lt;=n^m，问方案数，答案对998244353取模。</span><br><span class="line">n &lt;= 1e9, m &lt;= 200</span><br></pre></td></tr></table></figure><p>考虑对称性，所有数的乘积$\le n^m$和乘积$\ge n^m$方案数显然相等，重的只有$=n^m$的情况，设此时的方案数为$g$，答案就为$\frac{\sigma(n)^{2m}+g}{2}$。</p><p>问题来到怎么求取等方案数的问题，我们将每一个质数拉出来分开看（$n=p_1^{k_1}\cdot p_2^{k_2}\cdots p_x^{k_x}$），可以发现，这$2m$个数对于$p_1$来说：<br>$$<br>\forall i,cnt_i \le k_1 \\<br>\sum cnt_i = k_1m<br>$$<br>这个东西完全可以$dp$，然后将贡献全部乘到一起，就做完了。</p><p>复杂度：$x \cdot m + \sqrt n$，（$x$是$n$的质因数个数）。</p><h1 id="problem2"><a href="#problem2" class="headerlink" title="problem2"></a>problem2</h1><p>欧拉计划638。</p><p>一个坐标轴，从原点出发走向$(a,b)$，每次只能向上或向右走，每条路径的权值定义为：$k^s$，$s$是路径下方与$x$围成的面积，答案对$10^9+7$取模。</p><p>首先考虑暴力$dp$，我们考虑如何转移到$f(i,j)$，如果我们考虑计算与$x$轴所平行的线所包含的面积，那么式子一定是：<br>$$<br>f(i,j) = f(i - 1,j)+f(i,j-1)\cdot k^i<br>$$<br>那么O(n^2)的暴力就有了。</p><p>我们重新审视这个式子，这个面积$s$也可以看作路径右边的面积，那么这个式子也可以写成：<br>$$<br>f(i,j) = f(i-1, j)\cdot k^j+f(i,j-1)<br>$$<br>这两个式子中的$f$函数所代表的意义是完全等价的我们可以联立这两个方程，就可以得到：<br>$$<br>f(i-1,j) = \frac{k^i-1}{k^j-1}\cdot f(i,j-1) \\<br>f(i,j) = \frac{k^{i+1}-1}{k^j-1}<br>$$<br>之后递归下去，直到得到答案。</p><h1 id="problem3"><a href="#problem3" class="headerlink" title="problem3"></a>problem3</h1><p><a href="https://atcoder.jp/contests/diverta2019-2/tasks/diverta2019_2_d">题目坐标</a></p><p>很基础的一个完全背包，很好想，但当时脑子短路了，死磕网络流无果，注意赋初值。</p><p>贴个代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2.5e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> x[<span class="number">4</span>];</span><br><span class="line">&#125;a, b;</span><br><span class="line">LL f[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="built_in">read</span>(a.x[<span class="number">1</span>], a.x[<span class="number">2</span>], a.x[<span class="number">3</span>]);</span><br><span class="line">    <span class="built_in">read</span>(b.x[<span class="number">1</span>], b.x[<span class="number">2</span>], b.x[<span class="number">3</span>]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">3</span>;j ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = a.x[j];i &lt;= n;i ++)</span><br><span class="line">            f[i] = <span class="built_in">max</span>(f[i], f[i - a.x[j]] + b.x[j] - a.x[j]);</span><br><span class="line">    n = n + f[n];</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(f));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">3</span>;j ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = b.x[j];i &lt;= n;i ++)</span><br><span class="line">            f[i] = <span class="built_in">max</span>(f[i], f[i - b.x[j]] + a.x[j] - b.x[j]);</span><br><span class="line">    <span class="built_in">write</span>(f[n] + n);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="problem4"><a href="#problem4" class="headerlink" title="problem4"></a>problem4</h1><p><a href="https://www.luogu.com.cn/problem/P5339">【TJOI2019】唱、跳、rap和篮球</a></p><h1 id="problem5"><a href="#problem5" class="headerlink" title="problem5"></a>problem5</h1><p>令一个排列中的前缀$gcd$中不同种类的数的个数为$f$，求$n$的排列中最大的$f$，以及有多少种排列等于$f$，对$998244353$取模。</p><h1 id="problem6"><a href="#problem6" class="headerlink" title="problem6"></a>problem6</h1><p>有一个长为$n$的数列$a_n$，每次操作将序列第一个数加入新数列的队首或队尾，令新数列中最长上升子序列长度为$len$，求最大化的$len$，以及有多少种不同的构造方案的最长上升子序列长度为$len$。</p><p>$n \le 10^6$</p><p>大水题。</p><p>首先考虑解决第一个问，我们任意来看一组新序列。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1, x, 2, x, 3, x, x, 4, x, 5, 6</span><br></pre></td></tr></table></figure><p>为了使结论更清晰，本人将序列中不贡献答案的数用$x$隐去了。</p><p>我们设$3$是这些有贡献的数中在原序列的编号最小的数，则$4,5,6,1,2$的编号一定大于$3$，而如果令一个数在原序列中的编号为$id(x)$的话，一定有$id(2)&lt;id(1)$，$id(4)&lt;id(5)&lt;id(6)$，那么等于是在原数列求出一个最长上升子序列和一个最长下降子序列，然后将他们拼在一起，令$f(x)$为原数列以$x$为开头的最长上升子序列的长度，$g(x)$则为最长下降子序列的长度，第一问答案就为$\max{f(x)+g(x)-1}$，复杂度用线段树可以做到$n\log n$（常数危险）。</p><p>考虑第二问，我们发现第二问其实是在第一问的基础上考虑其他数的去处，但是我们并不关心其他数的去处，所以每找到一个第一问的答案就会贡献一个$2^{n-len}$（第一个数没法算两次），</p><p>注意：每个起点所拥有的最长上升子序列的个数可能不唯一，所以最后的答案应该是：$\sum cnt(f(x))\cdot cnt(g(x)) \cdot 2^{n - f(x)-g(x)}$。</p><h1 id="problem7"><a href="#problem7" class="headerlink" title="problem7"></a>problem7</h1><h1 id="problem8"><a href="#problem8" class="headerlink" title="problem8"></a>problem8</h1><p>[<a href="https://www.luogu.com.cn/problem/P6772">NOI2020] 美食家</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4240 毒瘤之神的考验</title>
      <link href="/2022/07/22/P4240-%E6%AF%92%E7%98%A4%E4%B9%8B%E7%A5%9E%E7%9A%84%E8%80%83%E9%AA%8C/"/>
      <url>/2022/07/22/P4240-%E6%AF%92%E7%98%A4%E4%B9%8B%E7%A5%9E%E7%9A%84%E8%80%83%E9%AA%8C/</url>
      
        <content type="html"><![CDATA[<p>根号分治<code>+</code>莫比乌斯反演的神仙题（太<code>tm</code>毒瘤了）。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>首先式子很简单，$T$组询问：<br>$$<br>\sum _i^n\sum_j^m \phi(ij)<br>$$</p><p>首先$\phi$有个小性质：</p><p>$$<br>\phi(ij)=\frac{\phi(i)\phi(j)gcd(i,j)}{\phi(gcd(i,j))}<br>$$</p><p>证明：</p><p>$$<br>\begin{aligned}<br>\phi(i) * \phi(j)&amp;=i\prod_{p|i}\frac{p-1}{p}j\prod_{q|j}\frac{q-1}{q} \\<br>&amp;=ij\prod_{p|ij}\frac{p-1}{p}\prod_{q|gcd(i,j)}\frac{q-1}{q}<br>\end{aligned}<br>$$<br>下面那个化简就得到了。</p><p>我们现在来化原式子，强令$n&lt;m$：<br>$$<br>\begin{aligned}<br>\sum_i^n\sum_j^m\phi(ij)&amp;=\sum_d^n\frac{d}{\phi(d)}\sum_i^{\frac{n}{d}}\sum_j^{\frac{m}{d}}\phi(i)\phi(j)[gcd(i,j)==1] \\<br>&amp;=\sum_d^n\frac{d}{\phi(d)}\sum_i^{\frac{n}{d}}\sum_j^{\frac{m}{d}}\phi(id)\phi(jd)\sum_{p|gcd(i,j)}\mu(p)\\<br>&amp;=\sum_d^n\frac{d}{\phi(d)}\sum_{p}^{\frac{n}{d}}\mu(p)\sum_i^{\frac{n}{pd}}\sum_j^{\frac{m}{pd}}\phi(idp)\phi(jdp)\\<br>&amp;=\sum_T^n\sum_{d|T}\frac{d}{\phi(d)}\mu(\frac{T}{d})\sum_i^{\frac{n}{T}}\sum_j^{\frac{m}{T}}\phi(Ti)\phi(Tj)\\<br>\end{aligned}<br>$$<br>发现$\sum_{d|T}\frac{d}{\phi(d)}\mu(\frac{T}{d})$可以$n\ln n$预处理，我们设其处理出来的值为$f(T)$。</p><p>我们来考虑后面这坨怎么办，$\sum_i^{\frac{n}{T}}\sum_j^{\frac{m}{T}}\phi(Ti)\phi(Tj)$，我们发现这两坨互相独立，且其本质相同，都是：$\sum_i^{\frac{n}{T}}\phi(Ti)$，我们令$g(k,n)=\sum_i^n\phi(i,k)$，然后这个东西有递推式：$g(k,n)=g(k,n-1)+\phi(kn)$，所以也可以$n \ln n$预处理。</p><p>重新回过头来，可以发现：<br>$$<br>\begin{aligned}<br>\sum _i^n\sum_j^m \phi(ij)=\sum_i^nf(i)\cdot g(i,\left \lfloor \frac{n}{i} \right \rfloor) \cdot g(i,\left \lfloor \frac{m}{i} \right \rfloor)<br>\end{aligned}<br>$$<br>我们发现这分不了块，只能$O(n)$做，但我们并不气馁，再次考虑套路的换元：<br>$$<br>t(a,b,n)=\sum_i^nf(i)\cdot g(i,a) \cdot g(i,b)<br>$$<br>$t$这个东西我们发现就是一个前缀和的形式，就可以数论分块，形式是这样的：<br>$$<br>\sum t(\left \lfloor \frac{n}{l} \right \rfloor,\left \lfloor \frac{m}{l} \right \rfloor,r)-t(\left \lfloor \frac{n}{l} \right \rfloor,\left \lfloor \frac{m}{l} \right \rfloor,l-1)<br>$$<br>问题转移到求解$t$这个式子，发现第一，二项有$n$中取值，第三项肯定有$n$种取值，结合在一起$n^3$，$T$来瓜起。</p><p>考虑根号平衡一手，因为当$l$越大，整数分块所包含的区间越大，暴力做的复杂度越高，所以我们设定一个阈值，$\left \lfloor \frac{n}{l} \right \rfloor$小于这个阈值我们就预处理，反之就暴力。</p><p>阈值取$50$比较合适。</p><p>总的时间复杂度：$O(n \ln n + n \cdot B^2+T(\sqrt n+\frac{n}{B})))$。</p><p>挺妙的（如果会的话）</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">998244353</span>, B = <span class="number">50</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, T;</span><br><span class="line"><span class="keyword">int</span> primes[N], cnt, phi[N], mu[N], f[N];</span><br><span class="line"><span class="keyword">int</span> inv[N];</span><br><span class="line"><span class="keyword">bool</span> st[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = <span class="number">1ll</span> * res * x % mod;</span><br><span class="line">        x = <span class="number">1ll</span> * x * x % mod;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;g[N], t[B + <span class="number">5</span>][B + <span class="number">5</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt; N;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!st[i]) phi[i] = i - <span class="number">1</span>, primes[++ cnt] = i, mu[i] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= cnt &amp;&amp; primes[j] * i &lt; N;j ++)</span><br><span class="line">        &#123;</span><br><span class="line">            st[primes[j] * i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % primes[j] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                mu[i * primes[j]] = <span class="number">0</span>;</span><br><span class="line">                phi[i * primes[j]] = <span class="number">1ll</span> * phi[i] * primes[j];</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * primes[j]] = -mu[i];</span><br><span class="line">            phi[primes[j] * i] = phi[i] * phi[primes[j]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;i ++) inv[i] = <span class="built_in">qpow</span>(phi[i], mod - <span class="number">2</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= (N - <span class="number">1</span>) / i;j ++)</span><br><span class="line">            f[i * j] = (f[i * j] + <span class="number">1ll</span> * mu[j] * i * inv[i] % mod + mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        g[i].<span class="built_in">resize</span>(N / i + <span class="number">5</span>);</span><br><span class="line">        g[i][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= (N - <span class="number">1</span>) / i;j ++)</span><br><span class="line">            g[i][j] = (LL)(g[i][j - <span class="number">1</span>] + phi[i * j]) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= B;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = i;k &lt;= B;k ++)</span><br><span class="line">        &#123;</span><br><span class="line">            t[i][k].<span class="built_in">resize</span>(N / k + <span class="number">5</span>);</span><br><span class="line">            t[i][k][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= (N - <span class="number">1</span>) / k;j ++)</span><br><span class="line">                t[i][k][j] = (t[i][k][j - <span class="number">1</span>] + <span class="number">1ll</span> * f[j] * g[j][i] % mod * g[j][k] % mod) % mod;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">if</span>(n &gt; m) <span class="built_in">swap</span>(n, m);</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m / B;i ++) res = (res + <span class="number">1ll</span> * f[i] * g[i][n / i] % mod * g[i][m / i] % mod) % mod;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> l = m / B + <span class="number">1</span>, r;l &lt;= n;l = r + <span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        r = <span class="built_in">min</span>(n / (n / l), m / (m / l));</span><br><span class="line">        res = (res + (t[n / l][m / l][r] - t[n / l][m / l][l - <span class="number">1</span>] + mod) % mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 莫比乌斯反演 </tag>
            
            <tag> 根号分治 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>NOI2018 屠龙勇士</title>
      <link href="/2022/07/20/NOI2018-%E5%B1%A0%E9%BE%99%E5%8B%87%E5%A3%AB/"/>
      <url>/2022/07/20/NOI2018-%E5%B1%A0%E9%BE%99%E5%8B%87%E5%A3%AB/</url>
      
        <content type="html"><![CDATA[<p>卡<code>long long</code>的伞兵出题人。</p><p><code>excrt</code>裸题。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>首先发现每只怪物被哪把剑干死是确定的，我们首先将其预处理出来，然后就会惊奇的发现式子长这样：<br>$$<br>\forall i,x\times atk_i \equiv a_i \ (mod \ p_i)\\<br>x \times atk_i \ge a_i<br>$$<br>首先第二个式子是废的，随便统计即可，对于第一个式子，我们发现这是$excrt$的裸题，由于之前没写博客，就在这写了。</p><p>首先我们想办法先把$atk$搞掉（下文自动省略下标），发现当$(atk,p)!=0$时不是很好搞，我们先将其最大公因数除掉，显然如果$a$无法整除其最大公因数，此题无解，然后我们进行一波推导之后可以发现$atk$在模$p$意义下的逆元为：<br>$$<br>\begin{aligned}<br>atk \times x \equiv 1 \pmod{p} \\<br>atk\times x+ k\times p=1<br>\end{aligned}<br>$$<br>直接丢进<code>exgcd</code>即可（注意最后要转化成正数然后还要取模），设$a$乘上$atk$的逆元为$v$。</p><p>之后我们再观察一下目前的式子：<br>$$<br>\begin{aligned}<br>\left{\begin{matrix}<br> x \equiv &amp;v_1  &amp; \pmod{p_1} \<br> \vdots &amp;\vdots  &amp;\vdots \<br> x \equiv &amp;v_n  &amp; \pmod{p_n}<br>\end{matrix}\right.<br>\end{aligned}<br>$$<br>考虑进行<code>excrt</code>，下面是其过程：</p><p>考虑每次合并两个方程：<br>$$<br>x \equiv v_1 \pmod{p_1} \\<br>x \equiv v_2 \pmod{p_2}<br>$$<br>可转化成：<br>$$<br>x = v_1 + k_1 \times p_1 \\<br>x = v_2 + k_2 \times p_2<br>$$<br>合并上式：<br>$$<br>v_2-v_1=k1\times p_1 - k_2 \times p_2<br>$$<br>再丢进<code>exgcd</code>中解一个$k_1$，之后就可以算出对于这两个式子合法的$x$，那么合并后的式子就是：<br>$$<br>x \equiv k_1\times p_1+v_1 \pmod{ lcm(p_1,p_2)}<br>$$<br>之后依次合并即可。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, T;</span><br><span class="line"><span class="keyword">int</span> a[N], p[N], gn[N], sword[N];</span><br><span class="line">multiset&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">gcd</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> y ? <span class="built_in">gcd</span>(y, x % y) : x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k, <span class="keyword">int</span> mod)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = (__int128)res * x % mod;</span><br><span class="line">        x = (__int128)x * x % mod;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b, __int128 &amp;x, __int128 &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) <span class="keyword">return</span> x = <span class="number">1</span>, y = <span class="number">0</span>, <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="built_in">exgcd</span>(b, a % b, y, x);</span><br><span class="line">    y -= a / b * x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Lcm</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (__int128) x * y / <span class="built_in">gcd</span>(x, y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    __int128 x, y;</span><br><span class="line">    <span class="keyword">if</span>((a[j] - a[<span class="number">1</span>]) % <span class="built_in">gcd</span>(p[<span class="number">1</span>], -p[j]) != <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">exgcd</span>(p[<span class="number">1</span>], p[j], x, y);</span><br><span class="line">    <span class="keyword">int</span> mod = <span class="built_in">Lcm</span>(p[<span class="number">1</span>], p[j]);</span><br><span class="line">    x = (__int128) x * (a[j] - a[<span class="number">1</span>]) / <span class="built_in">gcd</span>(p[<span class="number">1</span>], p[j]);</span><br><span class="line">    a[<span class="number">1</span>] = ((__int128) p[<span class="number">1</span>] * x + a[<span class="number">1</span>] + mod) % mod;</span><br><span class="line">    p[<span class="number">1</span>] = mod;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> minn, ans;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Inv</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">gcd</span>(a, p) != <span class="number">1</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    __int128 x, y;</span><br><span class="line">    <span class="built_in">exgcd</span>(a, p, x, y);</span><br><span class="line">    <span class="keyword">return</span> (x % p + p) % p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    s.<span class="built_in">clear</span>();</span><br><span class="line">    minn = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(p[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(gn[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o;i &lt;= m;i ++) <span class="built_in">read</span>(o), s.<span class="built_in">insert</span>(o);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">auto</span> t = s.<span class="built_in">upper_bound</span>(a[i]);</span><br><span class="line">        <span class="keyword">if</span> (t != s.<span class="built_in">begin</span>()) -- t;</span><br><span class="line">        sword[i] = *t;</span><br><span class="line">        s.<span class="built_in">erase</span>(t);</span><br><span class="line">        s.<span class="built_in">insert</span>(gn[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o;i &lt;= n;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        minn = <span class="built_in">max</span>(minn, (<span class="keyword">int</span>)<span class="built_in">ceil</span>((<span class="keyword">double</span>)a[i] / sword[i]));</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">gcd</span>(sword[i], p[i]) != <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            o = <span class="built_in">gcd</span>(sword[i], p[i]);</span><br><span class="line">            <span class="keyword">if</span>(a[i] % o != <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">            a[i] /= o, p[i] /= o, sword[i] /= o;</span><br><span class="line">        &#125;</span><br><span class="line">        a[i] = (__int128)a[i] * <span class="built_in">Inv</span>(sword[i], p[i]) % p[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">merge</span>(i)) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    ans = (a[<span class="number">1</span>] + p[<span class="number">1</span>]) % p[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span> (minn &gt; a[<span class="number">1</span>]) ans = ans + ((minn - a[<span class="number">1</span>] + p[<span class="number">1</span>] - <span class="number">1</span>) / p[<span class="number">1</span>]) * p[<span class="number">1</span>];</span><br><span class="line">    <span class="built_in">write</span>(ans);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> excrt </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZJOI2012 小蓝的好友</title>
      <link href="/2022/07/19/ZJOI2012-%E5%B0%8F%E8%93%9D%E7%9A%84%E5%A5%BD%E5%8F%8B/"/>
      <url>/2022/07/19/ZJOI2012-%E5%B0%8F%E8%93%9D%E7%9A%84%E5%A5%BD%E5%8F%8B/</url>
      
        <content type="html"><![CDATA[<p>被教训了，以后要踏实一点，不懂的题都尽量写题解吧（希望明天<code>jklover</code>来的时候不要被虐爆）。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>经典矩阵无覆盖问题，但是$R\times C$都无法跑，一般的做法显然是不行的，于是我们需要开始观察题目的特殊地方<del>然后耍杂技</del>。</p><p>可以发现数据保证数据一定随机，于是我们考虑从这个地方下手，发现如果正着做这道题的话需要用容斥，复杂度我们显然是无法接受的，于是考虑这个问题的补问题：有多少个矩阵没有被覆盖（下文称其为空矩阵）。</p><p>对于这个问题，我们考虑扫描线（行），即有多少个空矩阵的下界在当前的线上，令$w[x]$为第$x$列所扫描到的最低的覆盖点，那么目前的图就应该是这样的：</p><p><img src="1.png" alt="image"></p><p>可以发现当前最低点的贡献就是其左边的列的数量+1$\times$右边列的数量+1（+1是因为当前列也行）。</p><p>而且当我们将空列补$0$（在$0$行插入一个覆盖点），那么这个贡献的列就会被转化成点，而且是可以递归处理的（断开已统计过的列即可），这就是一颗笛卡尔树。</p><p>又因为数据随机，所以用平衡树维护笛卡尔树的复杂度有保证。</p><p>时间复杂度：$O(l+(r+n)\log r)$。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e4</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, l, r, root;</span><br><span class="line">vector&lt;<span class="keyword">int</span>&gt;s[N];</span><br><span class="line"><span class="keyword">namespace</span> pol&#123;</span><br><span class="line">    <span class="keyword">int</span> x, y, z, tot;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> s[<span class="number">2</span>], id, v, sz;</span><br><span class="line">        LL val;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].s[0]</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].s[1]</span></span><br><span class="line">    &#125;tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tr[x].sz = tr[<span class="built_in">l</span>(x)].sz + tr[<span class="built_in">r</span>(x)].sz + <span class="number">1</span>;</span><br><span class="line">        tr[x].val = tr[<span class="built_in">l</span>(x)].val + tr[<span class="built_in">r</span>(x)].val + <span class="number">1ll</span> * (tr[<span class="built_in">l</span>(x)].sz + <span class="number">1</span>) * (tr[<span class="built_in">r</span>(x)].sz + <span class="number">1</span>) * tr[x].v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        tr[++ tot].id = id, tr[tot].v = v, tr[tot].sz = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> tot;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!x || !y) <span class="keyword">return</span> x | y;</span><br><span class="line">        <span class="keyword">if</span>(tr[x].v &gt; tr[y].v)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">r</span>(x) = <span class="built_in">merge</span>(<span class="built_in">r</span>(x), y);</span><br><span class="line">            <span class="built_in">pushup</span>(x);</span><br><span class="line">            <span class="keyword">return</span> x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">l</span>(y) = <span class="built_in">merge</span>(x, <span class="built_in">l</span>(y));</span><br><span class="line">            <span class="built_in">pushup</span>(y);</span><br><span class="line">            <span class="keyword">return</span> y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> k, <span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!now) x = <span class="number">0</span>, y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(tr[now].id &lt;= k) x = now, <span class="built_in">split</span>(<span class="built_in">r</span>(now), k, <span class="built_in">r</span>(now), y);</span><br><span class="line">            <span class="keyword">else</span> y = now, <span class="built_in">split</span>(<span class="built_in">l</span>(now), k, x, <span class="built_in">l</span>(now));</span><br><span class="line">            <span class="built_in">pushup</span>(now);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">split</span>(root, id - <span class="number">1</span>, x, y), <span class="built_in">split</span>(y, id, y, z);</span><br><span class="line">        tr[y].v = v;</span><br><span class="line">        root = <span class="built_in">merge</span>(x, <span class="built_in">merge</span>(y, z)); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> id, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">split</span>(root, id - <span class="number">1</span>, x, y);</span><br><span class="line">        root = <span class="built_in">merge</span>(x, <span class="built_in">merge</span>(<span class="built_in">make</span>(id, v), y));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">LL ans;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(l, r, n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, st, ed;i &lt;= n;i ++) <span class="built_in">read</span>(st, ed), s[st].<span class="built_in">push_back</span>(ed);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= r;i ++) pol:: <span class="built_in">insert</span>(i, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= l;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j : s[i]) pol:: <span class="built_in">modify</span>(j, i);</span><br><span class="line">        ans += <span class="number">1ll</span> * r * (r + <span class="number">1</span>) / <span class="number">2</span> * i - pol:: tr[root].val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>(<span class="number">1ll</span> * l * (l + <span class="number">1</span>) / <span class="number">2</span> * r * (r + <span class="number">1</span>) / <span class="number">2</span> - ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 平衡树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ZJOI2016 大森林</title>
      <link href="/2022/07/19/ZJOI2016-%E5%A4%A7%E6%A3%AE%E6%9E%97/"/>
      <url>/2022/07/19/ZJOI2016-%E5%A4%A7%E6%A3%AE%E6%9E%97/</url>
      
        <content type="html"><![CDATA[<p><code>orz</code>优先级。</p><span id="more"></span><p>一道比较神秘的题目。</p><p>首先我们发现在线的做法只能做到暴力的$mn\log n$，这种报废的做法显然是不可取的，我们考虑离线。</p><p>首先考虑第一种操作怎么快速维护：为了避免建重复的节点，我们应该将所有的树压成一棵树（多的节点断掉即可）。</p><p>思考为什么复杂度如此的高，最后搞来搞去就发现第二种操作是最不可做的，我们应该怎样才能将子树信息进行移动，这其实考了虚点的概念，就是我们更换生长节点的时候，建立一个虚点，将后来子树的信息全部加在虚点上，之后到了撤销生长节点的时候，将虚点直接挪过去即可。</p><p>紧接着就不难得出询问的实现方法，设一个节点到根的路径上的的非虚节点个数为$sz[x]$，则答案为：$sz[x]+sz[y]-2*lca(x,y)$。</p><p>因为不能改变树的结构，所以不能$split$。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">4e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> s[<span class="number">2</span>], p, sum, v;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].s[0]</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].s[1]</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> fa(x) tr[x].p</span></span><br><span class="line">&#125;tr[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">l</span>(<span class="built_in">fa</span>(x)) != x &amp;&amp; <span class="built_in">r</span>(<span class="built_in">fa</span>(x)) != x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].sum = tr[<span class="built_in">l</span>(x)].sum + tr[<span class="built_in">r</span>(x)].sum + tr[x].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line">    <span class="keyword">int</span> k = tr[y].s[<span class="number">1</span>] == x;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">isroot</span>(y)) tr[z].s[tr[z].s[<span class="number">1</span>] == y] = x;</span><br><span class="line">    <span class="built_in">fa</span>(x) = z;</span><br><span class="line">    tr[y].s[k] = tr[x].s[k ^ <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(tr[x].s[k ^ <span class="number">1</span>]) <span class="built_in">fa</span>(tr[x].s[k ^ <span class="number">1</span>]) = y;</span><br><span class="line">    tr[x].s[k ^ <span class="number">1</span>] = y, <span class="built_in">fa</span>(y) = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y), <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> st[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isroot</span>(x))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">isroot</span>(y))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="built_in">r</span>(y) == x) ^ (<span class="built_in">r</span>(z) == y)) <span class="built_in">rotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">rotate</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(; x; y = x, x = <span class="built_in">fa</span>(x)) <span class="built_in">splay</span>(x), <span class="built_in">r</span>(x) = y, <span class="built_in">pushup</span>(x);</span><br><span class="line">    <span class="keyword">return</span> y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">splay</span>(x), <span class="built_in">fa</span>(x) = y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x), <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="built_in">fa</span>(<span class="built_in">l</span>(x)) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">l</span>(x) = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt, idx, last, tot, num;</span><br><span class="line"><span class="keyword">int</span> L[N], R[N], id[N]; <span class="comment">// 每个点的出现坐标，删除坐标，下标</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">make</span><span class="params">(<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cnt ++, tr[cnt].sum = tr[cnt].v = v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Ask</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> pos, id, x, y;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (Ask b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> pos == b.pos ? id &lt; b.id : pos &lt; b.pos;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans = <span class="number">0</span>, lca;</span><br><span class="line">    <span class="built_in">access</span>(x), <span class="built_in">splay</span>(x), ans += tr[x].sum;</span><br><span class="line">    lca = <span class="built_in">access</span>(y), <span class="built_in">splay</span>(y), ans += tr[y].sum;</span><br><span class="line">    <span class="built_in">access</span>(lca), <span class="built_in">splay</span>(lca), ans -= <span class="number">2</span> * tr[lca].sum;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="built_in">make</span>(<span class="number">1</span>);</span><br><span class="line">    L[<span class="number">1</span>] = <span class="number">1</span>, R[<span class="number">1</span>] = n;</span><br><span class="line">    id[++ idx] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">make</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">link</span>(<span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line">    last = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> op, l, r, x, u, v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(op);</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(l, r);</span><br><span class="line">            <span class="built_in">make</span>(<span class="number">1</span>);</span><br><span class="line">            L[++ idx] = l, R[idx] = r, id[idx] = cnt;</span><br><span class="line">            q[++ tot] = &#123;<span class="number">1</span>, i - m, cnt, last&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(l, r, x);</span><br><span class="line">            l = <span class="built_in">max</span>(L[x], l), r = <span class="built_in">min</span>(r, R[x]);</span><br><span class="line">            <span class="keyword">if</span>(l &lt;= r)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">make</span>(<span class="number">0</span>);</span><br><span class="line">                <span class="built_in">link</span>(cnt, last);</span><br><span class="line">                q[++ tot] = &#123;l, i - m, cnt, id[x]&#125;;</span><br><span class="line">                q[++ tot] = &#123;r + <span class="number">1</span>, i - m, cnt, last&#125;;</span><br><span class="line">                last = cnt;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(op == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x, u, v);</span><br><span class="line">            q[++ tot] = &#123;x, ++ num, id[u], id[v]&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(q + <span class="number">1</span>, q + tot + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, j = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">for</span>(;i == q[j].pos;j ++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(q[j].id &lt;= <span class="number">0</span>) <span class="built_in">cut</span>(q[j].x), <span class="built_in">link</span>(q[j].x, q[j].y);</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                ans[q[j].id] = <span class="built_in">query</span>(q[j].x, q[j].y);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= num;i ++) <span class="built_in">write</span>(ans[i]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UOJ207 共价大爷游长沙</title>
      <link href="/2022/07/19/UOJ207-%E5%85%B1%E4%BB%B7%E5%A4%A7%E7%88%B7%E6%B8%B8%E9%95%BF%E6%B2%99/"/>
      <url>/2022/07/19/UOJ207-%E5%85%B1%E4%BB%B7%E5%A4%A7%E7%88%B7%E6%B8%B8%E9%95%BF%E6%B2%99/</url>
      
        <content type="html"><![CDATA[<p>才知道$LCT$可以维护子树信息，爱了爱了。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>我们考虑将$x$定为原树的根节点，那么如果必须经过$x-y$这条边的话，大爷的每一对阅览节点当且仅当有且只有一个在$y$的子树内时才可能满足都经过这条边，于是我们随机给这些点对赋一个随机的权值（$10^9$左右），之后将$x$变成根，之后查询$y$子树内的异或值与所有点对异或值是否相等即可。</p><p>关于$LCT$维护子树信息问题，这里有一个不太妙的方案：将此点在$Splay$中的左右子树信息和自身虚儿子信息全部贡献到本点，这样的话当所求点转到$Splay$的根时，根据$Splay$的定义，根的左子树的信息显然是不必要的，又由于整棵树的信息目前都在根节点，去掉左子树信息就是根节点在原树中的子树信息。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">mt19937 <span class="title">rnd</span><span class="params">(<span class="number">114515</span>)</span></span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> sz2[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> s[<span class="number">2</span>], rev, val, v, p;</span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) tr[x].s[0]</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) tr[x].s[1]</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> fa(x) tr[x].p</span></span><br><span class="line">&#125;tr[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].val = tr[<span class="built_in">l</span>(x)].val ^ tr[x].v ^ tr[<span class="built_in">r</span>(x)].val ^ sz2[x];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rev</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">swap</span>(<span class="built_in">l</span>(x), <span class="built_in">r</span>(x));</span><br><span class="line">    tr[x].rev ^= <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!tr[x].rev) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="built_in">rev</span>(<span class="built_in">l</span>(x)), <span class="built_in">rev</span>(<span class="built_in">r</span>(x));</span><br><span class="line">    tr[x].rev = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">isroot</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">l</span>(<span class="built_in">fa</span>(x)) != x &amp;&amp; <span class="built_in">r</span>(<span class="built_in">fa</span>(x)) != x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line">    <span class="keyword">int</span> k = <span class="built_in">r</span>(y) == x;</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">isroot</span>(y)) tr[z].s[<span class="built_in">r</span>(z) == y] = x;</span><br><span class="line">    <span class="built_in">fa</span>(x) = z;</span><br><span class="line">    tr[y].s[k] = tr[x].s[k ^ <span class="number">1</span>], <span class="built_in">fa</span>(tr[x].s[k ^ <span class="number">1</span>]) = y;</span><br><span class="line">    tr[x].s[k ^ <span class="number">1</span>] = y, <span class="built_in">fa</span>(y) = x;</span><br><span class="line">    <span class="built_in">pushup</span>(y), <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> st[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">splay</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> top = <span class="number">0</span>, id = x;</span><br><span class="line">    st[++ top] = x;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isroot</span>(id)) st[++ top] = id = <span class="built_in">fa</span>(id);</span><br><span class="line">    <span class="keyword">while</span>(top) <span class="built_in">pushdown</span>(st[top --]);</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">isroot</span>(x))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> y = <span class="built_in">fa</span>(x), z = <span class="built_in">fa</span>(y);</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">isroot</span>(y))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="built_in">r</span>(y) == x) ^ (<span class="built_in">r</span>(z) == y)) <span class="built_in">rotate</span>(x);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">rotate</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">rotate</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">access</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> z = x;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> y = <span class="number">0</span>; x; y = x, x = <span class="built_in">fa</span>(x))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">splay</span>(x); </span><br><span class="line">        sz2[x] ^= tr[<span class="built_in">r</span>(x)].val ^ tr[y].val;</span><br><span class="line">        <span class="built_in">r</span>(x) = y, <span class="built_in">pushup</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">splay</span>(z);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">make_root</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x);</span><br><span class="line">    <span class="built_in">rev</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">find_root</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">access</span>(x);</span><br><span class="line">    <span class="keyword">while</span>(<span class="built_in">l</span>(x)) <span class="built_in">pushdown</span>(x), x = <span class="built_in">l</span>(x);</span><br><span class="line">    <span class="comment">// splay(x); // 不能更改根节点，因为后面调用的是y</span></span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">link</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">make_root</span>(x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">find_root</span>(y) == x) <span class="keyword">return</span> ;</span><br><span class="line">    sz2[y] ^= tr[x].val, tr[x].p = y;</span><br><span class="line">    <span class="built_in">pushup</span>(y);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">cut</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">make_root</span>(x);</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">find_root</span>(y) != x) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="built_in">fa</span>(x) = <span class="built_in">l</span>(y) = <span class="number">0</span>, <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">split</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">make_root</span>(x);</span><br><span class="line">    <span class="built_in">access</span>(y);</span><br><span class="line">&#125;</span><br><span class="line">PII stk[N * <span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> tot, ans;</span><br><span class="line"><span class="keyword">int</span> shit[N * <span class="number">3</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">split</span>(x, y);</span><br><span class="line">    <span class="built_in">splay</span>(x);</span><br><span class="line">    <span class="comment">// 下列写法均可</span></span><br><span class="line">    <span class="keyword">return</span> tr[y].val == ans;</span><br><span class="line">    <span class="comment">// return (tr[y].val ^ tr[l(y)].val) == ans;</span></span><br><span class="line">    <span class="comment">// return tr[x].val == ans;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n), <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u;i &lt; n;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(o, u);</span><br><span class="line">        <span class="built_in">link</span>(o, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> type, x, y, u, v;</span><br><span class="line">    <span class="keyword">while</span>(m --)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(type);</span><br><span class="line">        <span class="keyword">if</span>(type == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x, y, u, v);</span><br><span class="line">            <span class="built_in">cut</span>(x, y), <span class="built_in">link</span>(u, v);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(type == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x, y);</span><br><span class="line">            stk[++ tot] = &#123;x, y&#125;;</span><br><span class="line">            shit[tot] = <span class="built_in">rnd</span>();</span><br><span class="line">            ans ^= shit[tot];</span><br><span class="line">            <span class="built_in">make_root</span>(x), tr[x].v ^= shit[tot], <span class="built_in">pushup</span>(x);</span><br><span class="line">            <span class="built_in">make_root</span>(y), tr[y].v ^= shit[tot], <span class="built_in">pushup</span>(y);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(type == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x);</span><br><span class="line">            ans ^= shit[x];</span><br><span class="line">            <span class="built_in">make_root</span>(stk[x].first), tr[stk[x].first].v ^= shit[x], <span class="built_in">pushup</span>(stk[x].first);</span><br><span class="line">            <span class="built_in">make_root</span>(stk[x].second), tr[stk[x].second].v ^= shit[x], <span class="built_in">pushup</span>(stk[x].second);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(type == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">read</span>(x, y);</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">check</span>(x, y)) <span class="built_in">puts</span>(<span class="string">&quot;YES&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">&quot;NO&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> UOJ </tag>
            
            <tag> LCT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1312G Autocompletion</title>
      <link href="/2022/07/16/CF1312G-Autocompletion/"/>
      <url>/2022/07/16/CF1312G-Autocompletion/</url>
      
        <content type="html"><![CDATA[<p>有点妙。</p><span id="more"></span><p><a href="https://www.luogu.com.cn/problem/CF1312G">CF1312G Autocompletion</a></p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>设最后答案为$f[x]$，每一个关键点（只算关键点）的$dfs$序为$dfn[x]$。</p><p>那么显然：<br>$$<br>f[x] = min(f[fa[x]] + 1, f[i] + dfn[x] - dfn[i] + p[i])<br>$$<br>$i$是$x$的祖宗节点，$p[i]$代表这个点是否为关键节点。</p><p>看到题的时候感觉会比较板，将$Trie$树上的查询链拉出来建两颗线段树，第一颗只维护第一种操作，即$f[i] + len(x, i)$，第二颗线段树维护第二种操作，即$f[i]-dfn[i]+p[i]$即可，时间复杂度为：$n \log n$。</p><p>后来发现这完全是吃饱了撑的。</p><p>我们重新定义一个辅助数组$g$，其含义为$x$祖宗节点中最优的$f[i]-dfn[i]+p[i]$。</p><p>然后就结束了。</p><p>转移方程：<br>$$<br>\begin{aligned}<br>f[x] &amp;= f[y] + 1; \\<br>if(p[x]) \ f[x] &amp;= min(f[x], g[y] + dfn[x]); \\<br>g[x] &amp;= min(f[x] - dfn[x] + p[x], g[y]); \\<br>\end{aligned}<br>$$</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> ch[N][<span class="number">26</span>], tot, id[N];</span><br><span class="line"><span class="keyword">bool</span> p[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ch[x][c] = ++ tot;</span><br><span class="line">    id[x] = tot;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt, dfn[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(p[x]) cnt ++;</span><br><span class="line">    dfn[x] = cnt;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i ++)</span><br><span class="line">        <span class="keyword">if</span>(ch[x][i])</span><br><span class="line">            <span class="built_in">dfs</span>(ch[x][i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> f[N], g[N], a[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs1</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        f[x] = f[y] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(p[x]) f[x] = <span class="built_in">min</span>(f[x], g[y] + dfn[x]);</span><br><span class="line">        g[x] = <span class="built_in">min</span>(f[x] - dfn[x] + p[x], g[y]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">26</span>;i ++)</span><br><span class="line">        <span class="keyword">if</span>(ch[x][i])</span><br><span class="line">            <span class="built_in">dfs1</span>(ch[x][i], x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o;i &lt;= n;i ++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">char</span> c[<span class="number">2</span>];</span><br><span class="line">        <span class="built_in">read</span>(o);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, c);</span><br><span class="line">        <span class="built_in">insert</span>(o, c[<span class="number">0</span>] - <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o;i &lt;= m;i ++) <span class="built_in">read</span>(a[i]), p[a[i]] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i ++) <span class="built_in">write</span>(f[a[i]]);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> CF </tag>
            
            <tag> Trie </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>csp-2019 树的重心</title>
      <link href="/2022/07/15/csp-2019-%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/"/>
      <url>/2022/07/15/csp-2019-%E6%A0%91%E7%9A%84%E9%87%8D%E5%BF%83/</url>
      
        <content type="html"><![CDATA[<p>不知道性质的话这题就只有暴力分了。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>树的重心的性质：</p><ol><li>一棵树如果有两个重心，这两个重心一定是相邻的</li><li>一棵树的重心一定在根节点所在的重链上</li><li>一棵树的重心一定是以该树根节点重儿子为根的子树的重心的祖先</li></ol><p>知道了性质之后回过头来再次审视题目：首先预处理出这棵树每个节点的重儿子，次重儿子，然后使用换根$dp$开始从$1$根节点开始逐渐向每一颗子树转移，对于每一颗子树我们使用倍增的方式找重心，然后对于每一个找到的点，判断其父亲节点，重儿子节点和本身节点是否为重心，然后统计进入答案。</p><p>具体怎么样换根：对于任意节点$x$，现在要计算断开它的子树$j$时两颗树的贡献，不难发现$j$的子树没有动，直接倍增找即可，现在来观察新子树$x$，此时新子树的大小显然应该为$sz[1] - sz[j]$，而$x$新增的子树显然就是$father[x]$只需判断$father[x]$是否会成为$x$的新的重儿子然后倍增跳即可。</p><p>注：对于$x$被断开的子树$j$，如果其不是$x$的重儿子，那么$x$的新重儿子就是在$father[x]$和$heavy-son[x]$中选择，否则就应该在$second-heavy-son[x]$和$father[x]$中选择。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line"><span class="keyword">int</span> e[N &lt;&lt; <span class="number">1</span>], ne[N &lt;&lt; <span class="number">1</span>], h[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    idx ++;</span><br><span class="line">    e[idx] = y, ne[idx] = h[x], h[x] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> son[N], son2[N], f[N], fa[N], sz[N], tr[N][<span class="number">19</span>];</span><br><span class="line"><span class="keyword">int</span> sz2[N], son3[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    sz[x] = <span class="number">1</span>, fa[x] = y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = h[x], j; ~i;i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == y) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(j, x);</span><br><span class="line">        sz[x] += sz[j];</span><br><span class="line">        <span class="keyword">if</span>(sz[j] &gt; sz[son[x]]) son2[x] = son[x], son[x] = j;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(sz[j] &gt; sz[son2[x]]) son2[x] = j;</span><br><span class="line">    &#125;   </span><br><span class="line">    tr[x][<span class="number">0</span>] = son[x];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">17</span>;i ++)</span><br><span class="line">        tr[x][i] = tr[tr[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line">LL ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> sum)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x * (<span class="built_in">max</span>(sz2[son3[x]], sum - sz2[x]) &lt;= sum / <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = h[x], j; ~i;i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == y) <span class="keyword">continue</span>;</span><br><span class="line">        sz2[x] = sz[<span class="number">1</span>] - sz[j];</span><br><span class="line">        f[j] = f[x] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(son[x] == j) son3[x] = son2[x];</span><br><span class="line">        <span class="keyword">else</span> son3[x] = son[x];</span><br><span class="line">        <span class="keyword">if</span>(sz2[y] &gt; sz2[son3[x]]) son3[x] = y;</span><br><span class="line">        tr[x][<span class="number">0</span>] = son3[x];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= <span class="number">17</span>;k ++) tr[x][k] = tr[tr[x][k - <span class="number">1</span>]][k - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">int</span> now = x;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">17</span>;k &gt;= <span class="number">0</span>;k --)</span><br><span class="line">            <span class="keyword">if</span>(sz2[x] - sz2[tr[now][k]] &lt;= sz2[x] / <span class="number">2</span>)</span><br><span class="line">                now = tr[now][k];</span><br><span class="line">        ans += <span class="built_in">check</span>(son3[now], sz2[x]) + <span class="built_in">check</span>(now, sz2[x]) + <span class="built_in">check</span>(f[now], sz2[x]);</span><br><span class="line">        now = j;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">17</span>;k &gt;= <span class="number">0</span>;k --)</span><br><span class="line">            <span class="keyword">if</span>(sz2[j] - sz2[tr[now][k]] &lt;= sz2[j] / <span class="number">2</span>)</span><br><span class="line">                now = tr[now][k];</span><br><span class="line">        ans += <span class="built_in">check</span>(son3[now], sz2[j]) + <span class="built_in">check</span>(now, sz2[j]) + <span class="built_in">check</span>(f[now], sz2[j]);</span><br><span class="line">        f[x] = j;</span><br><span class="line">        <span class="built_in">dfs2</span>(j, x);</span><br><span class="line">    &#125;</span><br><span class="line">    son3[x] = tr[x][<span class="number">0</span>] = son[x];</span><br><span class="line">    f[x] = fa[x];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">17</span>;j ++) tr[x][j] = tr[tr[x][j - <span class="number">1</span>]][j - <span class="number">1</span>];</span><br><span class="line">    sz2[x] = sz[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(h));</span><br><span class="line">    <span class="built_in">memset</span>(son, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(f));</span><br><span class="line">    <span class="built_in">memset</span>(f, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(f));</span><br><span class="line">    <span class="built_in">memset</span>(fa, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(fa));</span><br><span class="line">    idx = ans = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u;i &lt; n;i ++) <span class="built_in">read</span>(o, u), <span class="built_in">add</span>(o, u), <span class="built_in">add</span>(u, o);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">memcpy</span>(sz2, sz, <span class="built_in"><span class="keyword">sizeof</span></span>(sz2));</span><br><span class="line">    <span class="built_in">memcpy</span>(son3, son, <span class="built_in"><span class="keyword">sizeof</span></span>(son3));</span><br><span class="line">    <span class="built_in">memcpy</span>(f, fa, <span class="built_in"><span class="keyword">sizeof</span></span>(f));</span><br><span class="line">    <span class="built_in">dfs2</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="built_in">write</span>(ans);</span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> T;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">input</span></span><br><span class="line"><span class="comment">1</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">1 6</span></span><br><span class="line"><span class="comment">2 4</span></span><br><span class="line"><span class="comment">5 3</span></span><br><span class="line"><span class="comment">3 7</span></span><br><span class="line"><span class="comment">6 4</span></span><br><span class="line"><span class="comment">4 7</span></span><br><span class="line"><span class="comment">output</span></span><br><span class="line"><span class="comment">73</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> luogu </tag>
            
            <tag> 倍增 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2022/6/20模拟赛</title>
      <link href="/2022/06/20/2022-6-20%E6%A8%A1%E6%8B%9F%E8%B5%9B/"/>
      <url>/2022/06/20/2022-6-20%E6%A8%A1%E6%8B%9F%E8%B5%9B/</url>
      
        <content type="html"><![CDATA[<p>被虐爆了QWQ。</p><span id="more"></span><p>某校模拟赛。</p><h1 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h1><p>不会，看到积分就知道这道题完了，毒瘤出题人不给$NTT$模数，本人不会三模数$NTT$，$FFT$乱搞，炸了精度（值域不够），果断使用拆系数，之前没写过，出了一堆锅，写的快吐的时候调出来了，一测极限。只有暴力分，卡了半天卡不动，大常数选手实锤。</p><p>实际被诈骗了，非常简单。</p><h1 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h1><p>没看（这次最大的失误）</p><h1 id="T3"><a href="#T3" class="headerlink" title="T3"></a>T3</h1><p>感觉挺神秘的一道题，简述一下题意：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">一个n*n矩阵，每个点上有颜色，求所有子矩阵的颜色种类之和。</span><br><span class="line">n &lt;= 1300</span><br></pre></td></tr></table></figure><p>考场上写了个自认为的$n^4$假了，没改出来，交了个$n^5$移动块的暴力（还不如把写假了的拆贡献交上去），泪目了。</p>]]></content>
      
      
      
        <tags>
            
            <tag> test </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>长链剖分</title>
      <link href="/2022/06/16/%E9%95%BF%E9%93%BE%E5%89%96%E5%88%86/"/>
      <url>/2022/06/16/%E9%95%BF%E9%93%BE%E5%89%96%E5%88%86/</url>
      
        <content type="html"><![CDATA[<p>重装系统时没保存，掉了。</p><p>先鸽了。</p><span id="more"></span>]]></content>
      
      
      
        <tags>
            
            <tag> 笔记 </tag>
            
            <tag> 长链剖分 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>归程</title>
      <link href="/2022/06/16/%E5%BD%92%E7%A8%8B/"/>
      <url>/2022/06/16/%E5%BD%92%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<p>…</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>前置知识：$kruskal$重构树，这是个什么东西呢，我们都知道并查集为了保证时间复杂度需要按秩合并，这会导致一个什么样的结果呢？路径压缩了，那么如果我们使用$kruskal$算法跑最小生成树的话，我们所加入的边的信息就丢失了，一般来说我们是不需要这些信息的，但是某些时候这些信息就显得无比重要，更具体的$kruskal$重构树可以在某些情况下弥补这个问题，以下是它的建立：</p><ul><li>按照$kruskal$的顺序将所有点连起来，但不是直接像按秩合并那样连起来，我们需要建立一个新节点，将这两个节点<strong>目前</strong>（除了这个节点未合并，不是它本身）的根连起来，然后这个点的点权就是加入边的边权。</li></ul><p>这样有什么好处呢，我们思考一个问题$kruskal$每次加入的边都是当前最优的，而先加入的边所连的点又先合并，故<strong>在$kruskal$重构树里父亲节点一定不如儿子节点优秀</strong>。</p><p>那么我们现在再来思考这个道题，我们首先跑一遍最短路，算出每个点到$1$号节点的最小距离（不能用$SPFA$）然后建一课边权和（以海拔为边权）最大的$kruskal$最大重构树，由于父节点一定比儿子节点更劣的原则，我们找到当前节点的最高的祖宗节点满足：其海拔高度高于题目所给高度，于是这个祖宗节点的子树当前节点都可到，只需查找其中的最小距离即可。</p><p>找祖宗节点可以倍增，最小距离可以预处理，于是这道题$O(n\log n)$就做完了。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;long long, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">7e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, T;</span><br><span class="line">LL dist[N];</span><br><span class="line"><span class="keyword">namespace</span> DFS</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">int</span> idx;</span><br><span class="line">    <span class="keyword">int</span> e[N &lt;&lt; <span class="number">1</span>], ne[N &lt;&lt; <span class="number">1</span>], h[N], w[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        idx ++;</span><br><span class="line">        e[idx] = y, ne[idx] = h[x], h[x] = idx, w[idx] = z;</span><br><span class="line">    &#125;</span><br><span class="line">    priority_queue&lt;PII, vector&lt;PII&gt;, greater&lt;PII&gt;&gt;q;</span><br><span class="line">    <span class="keyword">int</span> p[N];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">memset</span>(p, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(p));</span><br><span class="line">        <span class="built_in">memset</span>(dist, <span class="number">0x3f</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(dist));</span><br><span class="line">        dist[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        q.<span class="built_in">push</span>(&#123;<span class="number">0</span>, <span class="number">1</span>&#125;);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())</span><br><span class="line">        &#123;</span><br><span class="line">            PII o = q.<span class="built_in">top</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(p[o.second]) <span class="keyword">continue</span>;</span><br><span class="line">            p[o.second] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = h[o.second], j; ~i;i = ne[i])</span><br><span class="line">            &#123;</span><br><span class="line">                j = e[i];</span><br><span class="line">                <span class="keyword">if</span>(dist[j] &gt; dist[o.second] + w[i])</span><br><span class="line">                &#123;</span><br><span class="line">                    dist[j] = dist[o.second] + w[i];</span><br><span class="line">                    q.<span class="built_in">push</span>(&#123;dist[j], j&#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        idx = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(h));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edge</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> o, u, w;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (Edge b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> w &lt; b.w;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;edge[N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"><span class="keyword">int</span> fa[N];</span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line"><span class="keyword">int</span> e[N &lt;&lt; <span class="number">2</span>], ne[N &lt;&lt; <span class="number">2</span>], h[N], w[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    idx ++;</span><br><span class="line">    e[idx] = y, ne[idx] = h[x], h[x] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> fa[x] == x ? x : fa[x] = <span class="built_in">find</span>(fa[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> cnt;</span><br><span class="line">LL val[N];</span><br><span class="line"><span class="keyword">int</span> father[N][<span class="number">28</span>], depth[N];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    depth[x] = depth[y] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(x != y)</span><br><span class="line">    &#123;</span><br><span class="line">        father[x][<span class="number">0</span>] = y;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">27</span>;i ++)</span><br><span class="line">            father[x][i] = father[father[x][i - <span class="number">1</span>]][i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = h[x], j; ~i;i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == y) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(j, x);</span><br><span class="line">        dist[x] = <span class="built_in">min</span>(dist[x], dist[j]);</span><br><span class="line">        val[x] = <span class="built_in">min</span>(val[j], val[x]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> q, k, s, last;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">27</span>;i &gt;= <span class="number">0</span>;i --) </span><br><span class="line">        <span class="keyword">if</span>(father[x][i] &amp;&amp; val[father[x][i]] &gt; limit) x = father[x][i];</span><br><span class="line">    <span class="keyword">return</span> dist[x];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">query</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(q, k, s);</span><br><span class="line">    <span class="keyword">int</span> v, p;</span><br><span class="line">    <span class="keyword">while</span>(q --)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(v, p);</span><br><span class="line">        v = (LL)(v + k * last - <span class="number">1</span>) % n + <span class="number">1</span>;</span><br><span class="line">        p = (LL)(p + k * last) % (s + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">write</span>(last = <span class="built_in">lca</span>(v, p));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    last = <span class="number">0</span>;</span><br><span class="line">    DFS:: <span class="built_in">init</span>();</span><br><span class="line">    idx = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(h));</span><br><span class="line">    <span class="built_in">memset</span>(depth, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(depth));</span><br><span class="line">    <span class="built_in">memset</span>(val, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(val));</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt; N;i ++) fa[i] = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) val[i] = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    cnt = n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u, v, w;i &lt;= m;i ++)</span><br><span class="line">        <span class="built_in">read</span>(o, u, v, w), DFS:: <span class="built_in">add</span>(o, u, v), DFS:: <span class="built_in">add</span>(u, o, v), edge[i] = &#123;o, u, w&#125;;</span><br><span class="line">    DFS:: <span class="built_in">dfs</span>();</span><br><span class="line">    <span class="built_in">sort</span>(edge + <span class="number">1</span>, edge + m + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = m, o, u;i &gt;= <span class="number">1</span>;i --)</span><br><span class="line">    &#123;</span><br><span class="line">        o = <span class="built_in">find</span>(edge[i].o), u = <span class="built_in">find</span>(edge[i].u);</span><br><span class="line">        <span class="keyword">if</span>(o == u) <span class="keyword">continue</span>;</span><br><span class="line">        cnt ++;</span><br><span class="line">        val[cnt] = edge[i].w;</span><br><span class="line">        fa[o] = cnt, fa[u] = cnt;</span><br><span class="line">        <span class="built_in">add</span>(o, cnt), <span class="built_in">add</span>(cnt, o), <span class="built_in">add</span>(u, cnt), <span class="built_in">add</span>(cnt, u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = n + <span class="number">1</span>;i &lt;= cnt;i ++) dist[i] = <span class="number">0x3f3f3f3f3f3f3f3f</span>;</span><br><span class="line">    <span class="built_in">dfs</span>(cnt, cnt);</span><br><span class="line">    <span class="built_in">query</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 生成树 </tag>
            
            <tag> kruskal重构树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>第二轮讲课</title>
      <link href="/2022/06/15/%E7%AC%AC%E4%BA%8C%E8%BD%AE%E8%AE%B2%E8%AF%BE/"/>
      <url>/2022/06/15/%E7%AC%AC%E4%BA%8C%E8%BD%AE%E8%AE%B2%E8%AF%BE/</url>
      
        <content type="html"><![CDATA[<p>自己作死把博客搞掉了（又掉了），只有重写了$QWQ$。</p><span id="more"></span><h1 id="块状链表"><a href="#块状链表" class="headerlink" title="块状链表"></a>块状链表</h1><p>众所周知，数组查询方便，但插入和删除困难（复杂度极高 $O(n)$ ）；而<a href="https://so.csdn.net/so/search?q=%E9%93%BE%E8%A1%A8&spm=1001.2101.3001.7020">链表</a>恰恰相反，索引困难，而插入和删除简单。</p><p>那么当我们遇到既要动态插入删除，又要快速索引元素的问题时，有没有一种<a href="https://so.csdn.net/so/search?q=%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84&spm=1001.2101.3001.7020">数据结构</a>能够同时快速支持这两个操作呢？</p><p>以我们老祖宗的强大的智慧，答案当然是有，它就是——<del>序列之王<code>Splay</code></del>块状链表。</p><p>听到这个名字，大概都能猜到它的主要思想：分块。</p><p>它将整个数列分成$\sqrt n$块，每一块$\sqrt n$个数用链表串起来，然后再用一个主链表将他们都传起来，具体的它长这样：</p><p><img src="1.png" alt="image"></p><p>仔细想想，无论怎么操作都是$\sqrt n$（维护前缀和的分裂不是）的。</p><h2 id="vector实现："><a href="#vector实现：" class="headerlink" title="vector实现："></a>vector实现：</h2><ul><li><p><strong>建立块状链表。</strong> 依次提取数组的前$B$元素当一个 $vector$ 添加。</p></li><li><p><strong>找到第 k 元素。</strong>记录每vector维护的范围，确定$k$所在区间，用$k-l$即可找到（$l$是这个$vector$的首项）。</p></li><li><p><strong>插入。</strong>首先，我们需要知道插入的位置。为了方便默认是在给定插入位置的前面插入；直接用$vector::insert$。为了保证时间复杂度，如果插入完导致这个$vector$大于$2B$，则在$B$处分裂这个$vector$。具体怎么分裂：</p><ul><li><p>在块状链表里找到这个 $vector$ 接下来的 $vector$ 在接下来的 $vector$ 之前插入一个新建的 $vector$。</p></li><li><p>这个新建 $vector$ 应该保存刚才插入的 $vector$ 的 $B$ 元素后缀，也就是$vector::end()-B$ 这个 $iterator$ 区间。我们用 $B$ 分裂来平均分裂后的 $vector$ 长度，并同时保证没有 $vector$ 长度超过 $B$。</p></li><li><p>建完新的 $vector$，再删除这个区间。</p></li></ul></li><li><p><strong>删除。</strong> 同样找到位置，利用 $vector::erase$如果这个 $vector$ 的大小变为零，把这个 $vector$ 从块状链表删除。</p></li></ul><p>$B$取$\sqrt n$</p><p><del>(写死我了)</del></p><h2 id="关于主链"><a href="#关于主链" class="headerlink" title="关于主链"></a>关于主链</h2><p>其实主链没有必要用$vector$强行插入，在每一块中间记录本块左右块的编号，然后直接在队尾加即可（常数小的一批，在下面的题中表现非常优秀）</p><h2 id="例题：带插入区间K小值"><a href="#例题：带插入区间K小值" class="headerlink" title="例题：带插入区间K小值"></a><a href="https://www.luogu.com.cn/problem/P4278">例题：带插入区间K小值</a></h2><p>这道题全凭各位常数。</p><p>过不了就删掉$split$函数。</p><p><img src="2.png" alt="image"></p><p>本人并没有被卡常，所以被卡常应该不关我事？</p><h1 id="分块"><a href="#分块" class="headerlink" title="分块"></a>分块</h1><p>分块之神$Dyd$曾经说过：分块就是一种套路，你把代码每一部分换成暴力，调出一部分就全部调出来了，所以分块特别好调。</p><p>蒟蒻不懂，可能这就是蒟蒻比巨佬菜的原因。</p><h2 id="树分块"><a href="#树分块" class="headerlink" title="树分块"></a>树分块</h2><p>一般可以用其他做法碾压树分块，所以题目较少。</p><h3 id="例题：P6177-Count-on-a-tree-II-【模板】树分块"><a href="#例题：P6177-Count-on-a-tree-II-【模板】树分块" class="headerlink" title="例题：P6177 Count on a tree II/【模板】树分块"></a>例题：<a href="https://www.luogu.com.cn/problem/P6177">P6177 Count on a tree II/【模板】树分块</a></h3><p>树上数数的不带修的强制在线的经典问题（<del>菊花图，蒲公英可以轻松卡掉，但本人也不是很懂怎么卡</del>）。</p><p>首先有一种更为简单（神秘）的做法：对于每个点拉一个$bitset$，比较显然是用轻重链剖分来维护，但是这样复杂度过大（感觉应该能过了），考虑怎么优化：对于每一条重链进行分块，预处理出每一块内$bitset$的并，复杂度：$O(m\log n \sqrt n \frac{n}{w})$甚至跑不过上面的东西，瓶颈在多块的合并，之后的操作，据题解所说可以用<code>ST</code>加速，但因它的理论复杂度应该是跑不过这道题的，只不过这东西跑不满，常数小，拿了最优解而已，我们不再深究，有兴趣的童鞋可以去看看巨佬<a href="https://www.luogu.com.cn/user/128141"><strong>Aestas16</strong></a>的题解。</p><p>这里只是举个例，证明树分块的时间不怎么滴。</p><p>下面才是正题。</p><p>什么是树分块</p><p>树分块就是像序列分块一样设置一个阈值$B$，然后在树上随机撒$\frac{n}{B}$个点，使其成为关键节点，然后使每一个点到距离其最近的关键节点的距离不超过$B$，这样我们就可以首先预处理出每两个关键节点之间的信息（所以树分块支持不了大量的修改操作），每次将需要计算的两点的距离最近的关键节点的信息拿出来，其他信息暴力统计即可，复杂度：$O(B^2+qB+\frac{n^2}{B})$，弱爆了。</p><p>然后重点讲一下撒点：</p><p>首先我们将所有的非关键节点入队，每次取出其中深度最大的节点，若他的节点的$1\sim B$级祖先都没有关键节点，就将它的$S$级祖先标记为关键节点，由上述方法可知每一次标记至少能控制$B$个节点，这些节点都不会被标记，且从这个节点出发最大移动距离最多为$B$，满足了我们的需要。</p><p>接下来，考虑对一条到根的路径上的所有关键点用$bitset$维护出他们两两之间的颜色，处理的时候我们可以使用递推的方式即：$b_{i,j}=b_{i,j-1}orb_{i+1,j-1}$，所以我们可以用<strong>最多</strong>$O(n)$的时间统计出每相邻关键节点的答案，其他的答案再两两统计，由于点对最多有$\frac{n^2}{B^2}$，所以预处理的复杂度为$O(\frac{n^2}{B}+\frac{n^3}{wB^2})\approx O(n\sqrt n+\frac{n^2}{w})$（感觉没前途啊）。</p><p>之后就简单了，将答案拆成四部分即可：</p><p><img src="3.png" alt="image"></p><p>其中红色的节点表示关键节点，绿色节点表示查询节点，查询节点到最深的关键节点暴力做，最高的关键节点之间也暴力做，那么最终复杂度为：$O((n+m)\sqrt n + \frac{n^2+nm}{w})$。<del>（不知到为什么被SPOJ卡掉了）</del></p><p>温馨提示，除非想不到其他解法，还是别写这个了。</p><h2 id="带修改莫队"><a href="#带修改莫队" class="headerlink" title="带修改莫队"></a>带修改莫队</h2><p>总所周知，普通的莫队是不能支持修改操作的，但是有些题目它就是让你支持修改，而且除了莫队你还不会其他的算法，这个时候我们就需要对莫队进行改进，让其支持修改。</p><p>首先思考一个问题，如果所有的修改操作都在查询操作之前，这个问题该怎么解决呢。</p><p>这其实是一个$sb$问题，将所有的修改操作维护完了，直接上普通莫队就行了。</p><p>问题的关键来了，如何使我们的修改操作重复执行的操作尽可能少。</p><p>有的人可能就会说了，将任意两段连续的修改操作之间的询问操作统计起来跑莫队不久行了么。</p><p>这样虽然可以使修改操作执行的次数很少，但是当询问操作很少的时候（比如两次），可以轻松将复杂度卡到线性（不带根号的原因是因为询问很少），这样就能使复杂度接近$O(nm)$很挫。</p><p>我们考虑定义三维：$[l, r, time]$，意味着查询的起始，终点，需要完成前$time$次修改操作。</p><p>根据分块的时间复杂度平衡思想，首先考虑将序列分成$len$块，考虑将$l$，$r$都放入块中，首先按$l$的块的编号排序，然后$l$的块的序号相同的询问再按$r$的块的编号排序，$l$和$r$的块的编号都相等的再按需要修改的次数升序排序。</p><p>首先为什么要这么做呢，一共有$len$块，令每块长度为$limit$（则$n$可以粗略的认为是$len\times limit$），那么移动$l$和$r$的时间复杂度为$len^2\times limit=n\times len$，之后考虑修改操作的进行次数，令总修改次数为$cnt$次，那么最坏情况下移动次数为$len^2*cnt$，双方取平衡，得到$limit=\sqrt[3]{n^4cnt}$。</p><p>例题：<a href="https://www.luogu.com.cn/problem/P1903">P1903 国家集训队 数颜色 / 维护队列</a></p><h2 id="树上莫队"><a href="#树上莫队" class="headerlink" title="树上莫队"></a>树上莫队</h2><p>我们回顾一下树分块的那道题，我们发现这样的做法及其丑陋（<del>但支持强制在线这一点就很香</del>），我们想一想如果不是强制在线的话我们应该怎么搞，首先在树上进行莫队操作的主要难点，一般来说能将树转化成序列的我们优先考虑，思考这题如何转成序列，我们使用一个叫欧拉序的东西，具体构造方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">对这棵树进行dfs，将任何第一次访问的节点加入序列，当节点回溯时再将这个节点加入序列。</span><br></pre></td></tr></table></figure><p>我们回过头来重新观察这道题，设$i$节点在序列中第一次出现是$st[i]$，第二次出现是$ed[i]$，那么对于对于任意询问节点$x$，$y$，设$st[x]&lt;st[y]$，分类讨论可以得到。</p><p>1.$lca(x,y)=x$，画图可以得到答案就是序列中$ed[x]\sim st[y]$之间所有只出现过一次的数所包含的不同种类（所以第一次出现就增加第二次出现就减少）。</p><p>2.$lca(x,y) \ne x$，不难发现此时$y$不可能是$x$的父亲<del>（不然的话为什么st[y]不在st[x]前面）</del>，所以画个图分析，此时的$ed[x] \sim st[y]$没有包含$lca(x,y)$，特判即可。</p><p>还有一道和这个题一摸一样的拓展版（<del>多了修改，但无伤大雅</del>）：<a href="https://www.luogu.com.cn/problem/P4074">[WC2013] 糖果公园</a>，快去切掉吧。</p><h2 id="倍增分块-底层线段树-底层分块"><a href="#倍增分块-底层线段树-底层分块" class="headerlink" title="倍增分块+底层线段树+底层分块"></a>倍增分块+底层线段树+底层分块</h2><p><del>自己都在怀疑赛事怎么可能有人写出来</del></p><p>$5e5$的神仙分块。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">一个数列，实现如下两种操作。</span><br><span class="line">1.将[l,r]区间中所有&gt;x的数减去x。</span><br><span class="line">2.询问区间[l,r]的和，最小值，最大值。</span><br><span class="line">值域1e9，序列长度5e5</span><br></pre></td></tr></table></figure><p>一看这题的第二问，哈，我会，线段树。</p><p>冷静下来看第一问，*?~&amp;%$#&amp;^。</p><p>毕竟是$lxl$的题，我们首先得往分块上想。</p><p>仔细思考之后就会发现这题必须要用数据结构维护值域和序列。</p><p>听说这题可以用分块套Splay（不愧是序列之王）<del>只要你没有常数</del>。</p><p>因为值域$10^9$，考虑一种神奇的分块：<strong>倍增分块</strong>，这是一种什么样的分块呢，就是将值在$[B^i,B^{i+1})$的数分在一起。</p><p>思考为什么考虑这种分块：</p><p>我们使用线段树暴力的时候，一定会先建一课序列线段树。</p><ul><li>如果区间的最大值$\le x$直接跳过。</li><li>如果区间的最小值$&gt; x$打上懒标记之后返回。</li><li>递归进入子区间。</li></ul><p>仔细想一想，如果序列是一大一小交替排布，每一次更改就是大常数的$O(n)$，跑不过暴力。</p><p>我们假设已经将值域分成了$cnt$个块，每个块里都有一个序列线段树。</p><p>这样整体上看最坏复杂度为$n\times cnt \times \log n$</p><p>但是思考分块的作用。</p><ul><li>如果一个块上界$\le x$直接跳过。</li><li>如果一个块的下届$&gt; x$，这一部分将被重构，那么这一部分复杂度是：$m\times cnt \times \log n$的</li><li>不然就递归。</li></ul><p>我们发现这样做了之后前两种情况的复杂度之和块的数量有关，但是，第三种情况的最差复杂度是线性的。</p><p>我们假设情况三的块长为$len$，由上我们发现每次修改最多会有一块成为情况三，所以最多就会操作$cnt \times \frac{len}{x}$次，我们将这式子拆开分析，首先如果每个块都已经因为上面的操作变成同一个值域了的话，显然最多会有$cnt$块需要递归，然后每一块内我们最多递归$\frac{len}{x}$次（之后就减为1了）。</p><p>考虑最叼钻的情况，即$\forall x=l$的情况，$l$就是当前块的左边界，我们就要让$n \times \log n \times cnt \times \frac{len}{l}$最小，考虑固定$\frac{len}{l}$，$cnt=\log_B^{10^9}$，最终的复杂度：<br>$$<br>O((n+m) \times \log_B{10 ^ 9} \times \log n+n \times B \times \log n \times \log_B^{10^9} )<br>$$<br><del>打开几何画板，但是并没有画出来</del>，$B$的理论最优为$16$，实测的话：应该取$2 \sim 4$。</p><p>之后就会发现卡空间了，线段树的空间主要消耗在叶子，我们可以设置一个常数$K$，让线段树$\le K$的区间的处理直接变成下传标记在序列上暴力，之后再上传。我们可以这样很可观地以大常数的时间代价换取空间（<del>这就是传说中底层分块</del>）。</p><p>这样的话大家就可以完成<a href="https://www.luogu.com.cn/problem/P7447">rgxsxrs</a>啦。</p><p>分块就先这样告一段落了，我们进入下一个专题。</p><h1 id="二维线段树"><a href="#二维线段树" class="headerlink" title="二维线段树"></a>二维线段树</h1><p>这个东西考的不多（不如线段树套平衡树），时间复杂度：大常数的$n \log^2 n$，空间复杂度：$n\log n$。</p><p>具体是干啥用的呢，是维护矩阵信息用的<del>（为啥不套平衡树）</del>，具体一般是对题目所给的二维的其中一维建线段树，再在这个线段树上的叶子节点建立另一颗线段树，维护另一维的信息，然后查询即可。</p><p>例题：[Mosaic](<a href="http://acm.hdu.edu.cn/showproblem.php?pid=4819">Problem - 4819 (hdu.edu.cn)</a>)。</p><p>这里简述一下题意：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">多组数据（T &lt;= 10），每组数据需要维护一个正方形矩阵（less than: 800*800），然后多次询问，每次询问一个子矩阵中的最大值+最小值/2向下取整。</span><br><span class="line">time limit: 5000ms</span><br></pre></td></tr></table></figure><p>是不是感觉很无脑。</p><p>网络上还流传着另一种二位线段树的写法：四叉树写法，这里不过多介绍（感觉并不优秀），只引用一下定义。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">二维线段树是一棵 四叉树，树上每个结点保存 一个矩形和一个域，非叶子结点一定有 二或四 个儿子结点，儿子结点表示的 四个矩形交集为空，并集为父结点表示的 矩形；叶子结点表示的矩形长宽均为1，域则表示了需要求的数据，每个父结点的域可以通过 四个儿子结点得出。</span><br></pre></td></tr></table></figure><h1 id="矩阵求逆"><a href="#矩阵求逆" class="headerlink" title="矩阵求逆"></a>矩阵求逆</h1><h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><p>令$A$是一个矩阵，如果存在一个矩阵$B$满足：<br>$$<br>BA=I<br>$$<br>则称$A$矩阵可逆，且$B$称为$A$的逆矩阵。</p><h2 id="如何求逆：高斯-约旦消元"><a href="#如何求逆：高斯-约旦消元" class="headerlink" title="如何求逆：高斯-约旦消元"></a>如何求逆：高斯-约旦消元</h2><h3 id="一堆证明"><a href="#一堆证明" class="headerlink" title="一堆证明"></a>一堆证明</h3><h4 id="矩阵的逆要么没有要么唯一"><a href="#矩阵的逆要么没有要么唯一" class="headerlink" title="矩阵的逆要么没有要么唯一"></a>矩阵的逆要么没有要么唯一</h4><p>首先要知道若$A$可逆，则逆唯一。</p><p>证明：若$B$和$C$都是$A$的逆，由定义：$AB=BA=I,AC=CA=I$</p><p>则：$B=IB=(AC)B=(AB)C=C$，即$B=C$，证毕。</p><h4 id="判断矩阵是否可逆"><a href="#判断矩阵是否可逆" class="headerlink" title="判断矩阵是否可逆"></a>判断矩阵是否可逆</h4><h5 id="行列式判断法"><a href="#行列式判断法" class="headerlink" title="行列式判断法"></a>行列式判断法</h5><p>设$n$阶矩阵：<br>$$<br>A=\begin{bmatrix}<br>a_{1,1} &amp; a_{1,2} &amp;a_{1,3} &amp; \dots &amp; a_{1, n}\\<br>a_{2,1} &amp; a_{2,2} &amp;a_{2,3} &amp; \dots &amp; a_{2, n}\\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\<br>a_{n,1} &amp; a_{n,2} &amp;a_{n,3} &amp; \dots &amp; a_{n, n}\\<br>\end{bmatrix}<br>$$<br>构造其代数余子式：<br>$$<br>A^*=\begin{bmatrix}<br>A_{1,1} &amp; A_{1,2} &amp;A_{1,3} &amp; \dots &amp; A_{1, n}\\<br>A_{2,1} &amp; A_{2,2} &amp;A_{2,3} &amp; \dots &amp; A_{2, n}\\<br>\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\<br>A_{n,1} &amp; A_{n,2} &amp;A_{n,3} &amp; \dots &amp; A_{n, n}\\<br>\end{bmatrix}<br>$$<br>代数余子式和余子式：</p><p>定义： 在<a href="https://baike.baidu.com/item/n%E9%98%B6%E8%A1%8C%E5%88%97%E5%BC%8F/3705756">n阶行列式</a>中，划去元aij所在的第i行与第j列的元，剩下的元不改变原来的顺序所构成的n-1阶行列式称为元aij的余子式。</p><p>数学表示上计作$M_{i,j}$。</p><p><strong>余子式定义</strong></p><p> $a_{i,j}$的代数余子式 [3] ：$A_{i,j}=(-1)^{i+j}M_{i,j}$。</p><h1 id="行列式及其运算"><a href="#行列式及其运算" class="headerlink" title="行列式及其运算"></a>行列式及其运算</h1><h1 id="线性相关与矩阵的逆"><a href="#线性相关与矩阵的逆" class="headerlink" title="线性相关与矩阵的逆"></a>线性相关与矩阵的逆</h1><h2 id=""><a href="#" class="headerlink" title=""></a></h2>]]></content>
      
      
      
        <tags>
            
            <tag> 其他 </tag>
            
            <tag> 块状链表 </tag>
            
            <tag> 分块 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>虚树</title>
      <link href="/2022/06/05/%E8%99%9A%E6%A0%91/"/>
      <url>/2022/06/05/%E8%99%9A%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<p>小清新优化思想。</p><span id="more"></span><p>是否有过这样的经历，一棵庞大的树，想到一个单次询问很牛的复杂度算法，但是树的大小太大，题目又毒瘤又多次询问，这时候你发现每次询问又只和一些点有关系，这时虚树就应需而生了。</p><h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><p>虚树就是在满足题目要求的情况下，将某一部分的节点抽出来，重新建立成一棵树，然后在上面进行原来的操作，从而以更小的复杂度，实现我们需要实现的操作。</p><h1 id="建树"><a href="#建树" class="headerlink" title="建树"></a>建树</h1><p>有两种建发，一种是用单调栈建，另一种使用排序建，这里使用从 p_b_p_b 那里学到的做法：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">首先先将所有重要点按照dfn序排序，然后将每一个数和自己前缀的lca加入队列，再次按照dfn排序，这个时候每个点和自己前缀的lca就是自己在虚树中的父亲。</span><br></pre></td></tr></table></figure><p>感觉起来挺对的，这一定能使所有点连成一棵树。</p><h1 id="例题：CF613D-Kingdom-and-its-Cities"><a href="#例题：CF613D-Kingdom-and-its-Cities" class="headerlink" title="例题：CF613D Kingdom and its Cities"></a>例题：<a href="https://www.luogu.com.cn/problem/CF613D">CF613D Kingdom and its Cities</a></h1><p>一句话题意：给你一颗树，每次选中一些点，让你删除最少的非选择点，使所有重要点不连通，问最少删除的点的数量。</p><p>$n \le 1e5,\sum k \le 1e5$。</p><p>看到这个数据范围，这个$\sum k$，果断在询问上下手脚。</p><p>观察这幅图：</p><p><img src="1.png" alt="image"></p><p>我们发现左子树是完全没有必要遍历的，哪里啥都没有，所以我们考虑构造虚树，我们发现建立虚树之后每个重要节点删去所需代价没有变，所以正确性也是有保证的。</p><p>时间复杂度： $O(\sum k\log\sum k)$。</p><p>常数有点小大。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e5</span> + <span class="number">5</span>, Inf = <span class="number">1e9</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, T;</span><br><span class="line"><span class="keyword">int</span> idx;</span><br><span class="line"><span class="keyword">int</span> e[N &lt;&lt; <span class="number">1</span>], ne[N &lt;&lt; <span class="number">1</span>], h[N], depth[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    idx ++;</span><br><span class="line">    e[idx] = y, ne[idx] = h[x], h[x] = idx;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> dfn[N], cnt, lg[N &lt;&lt; <span class="number">1</span>], f[N &lt;&lt; <span class="number">1</span>][<span class="number">22</span>], father[N], id[N];</span><br><span class="line"><span class="keyword">int</span> hh;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> l = id[x], r = id[y], len;</span><br><span class="line">    <span class="keyword">if</span>(l &gt; r) <span class="built_in">swap</span>(l, r);</span><br><span class="line">    len = lg[r - l + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">if</span>(depth[f[l][len]] &lt; depth[f[r - (<span class="number">1</span> &lt;&lt; len) + <span class="number">1</span>][len]]) <span class="keyword">return</span> f[l][len];</span><br><span class="line">    <span class="keyword">return</span> f[r - (<span class="number">1</span> &lt;&lt; len) + <span class="number">1</span>][len];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> mark[N], type;</span><br><span class="line"><span class="keyword">namespace</span> dp&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; edge[N];</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = hh, o;i &gt;= <span class="number">2</span>;i --) </span><br><span class="line">        &#123;</span><br><span class="line">            o = <span class="built_in">lca</span>(a[i], a[i - <span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span>(a[i] == o) <span class="keyword">continue</span>;</span><br><span class="line">            edge[o].<span class="built_in">push_back</span>(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, ans = <span class="number">0</span>, op;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i : edge[x])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(depth[i] &lt; depth[x]) <span class="keyword">continue</span>;</span><br><span class="line">            op = <span class="built_in">dp</span>(i);</span><br><span class="line">            ans += op;</span><br><span class="line">            <span class="keyword">if</span>(mark[x] &amp;&amp; mark[i]) ans ++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(mark[i]) res ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(res &gt; <span class="number">1</span>) ans ++;</span><br><span class="line">        <span class="keyword">if</span>(res == <span class="number">1</span>) mark[x] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> dfn[x] &lt; dfn[y];</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(m);</span><br><span class="line">    hh = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o;i &lt;= m;i ++) <span class="built_in">read</span>(o), a[++ hh] = o, mark[o] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= hh;i ++) </span><br><span class="line">        <span class="keyword">if</span>(mark[father[a[i]]] &amp;&amp; father[a[i]] != a[i])</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= hh;j ++) mark[a[j]] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>), <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + hh + <span class="number">1</span>, cmp);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = hh, o;i &gt;= <span class="number">2</span>;i --) </span><br><span class="line">    &#123;</span><br><span class="line">        o = <span class="built_in">lca</span>(a[i], a[i - <span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">if</span>(o == a[i] || o == a[i - <span class="number">1</span>]) <span class="keyword">continue</span>;</span><br><span class="line">        a[++ hh] = o;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + hh + <span class="number">1</span>);</span><br><span class="line">    hh = <span class="built_in">unique</span>(a + <span class="number">1</span>, a + hh + <span class="number">1</span>) - (a + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">sort</span>(a + <span class="number">1</span>, a + hh + <span class="number">1</span>, cmp);</span><br><span class="line">    dp:: <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">write</span>(dp:: <span class="built_in">dp</span>(a[<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= hh;i ++) dp:: edge[a[i]].<span class="built_in">clear</span>(), mark[a[i]] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> now[N &lt;&lt; <span class="number">1</span>], tot;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    depth[x] = depth[y] + <span class="number">1</span>;</span><br><span class="line">    dfn[x] = ++ cnt, now[++ tot] = x, id[x] = tot, father[x] = y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = h[x], j; ~i;i = ne[i])</span><br><span class="line">    &#123;</span><br><span class="line">        j = e[i];</span><br><span class="line">        <span class="keyword">if</span>(j == y) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(j, x);</span><br><span class="line">        now[++ tot] = x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    lg[<span class="number">1</span>] = <span class="number">0</span>, lg[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">3</span>;i &lt;= tot;i ++) lg[i] = lg[i &gt;&gt; <span class="number">1</span>] + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= tot;i ++) f[i][<span class="number">0</span>] = now[i];</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt; <span class="number">22</span>;j ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i + (<span class="number">1</span> &lt;&lt; j) - <span class="number">1</span> &lt;= tot;i ++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(depth[f[i][j - <span class="number">1</span>]] &lt; depth[f[i + (<span class="number">1</span> &lt;&lt; j - <span class="number">1</span>)][j - <span class="number">1</span>]]) f[i][j] = f[i][j - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">else</span> f[i][j] = f[i + (<span class="number">1</span> &lt;&lt; j - <span class="number">1</span>)][j - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(h, <span class="number">-1</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(h));</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>, o, u;i &lt; n;i ++) <span class="built_in">read</span>(o, u), <span class="built_in">add</span>(o, u), <span class="built_in">add</span>(u, o);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">init</span>();</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 数据结构 </tag>
            
            <tag> 虚树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P3502 [POI2010]CHO-Hamsters</title>
      <link href="/2022/06/04/P3502-POI2010-CHO-Hamsters/"/>
      <url>/2022/06/04/P3502-POI2010-CHO-Hamsters/</url>
      
        <content type="html"><![CDATA[<p>…</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>又是一道经典的矩阵快速幂在图论计数上的经典应用（<del>自己鸽了这么多道，终于记得写了</del>）。</p><p>首先指明一个显然的结论：$S$一定由这$n$个字符串中的一部分字符串首尾拼接组成。</p><p>得到这个结论后，我们将这$n$个字符串两两组合，找出他们首尾相接时最少的代价。</p><p>例如，字符串$A=abcabc$和字符串$B=bcda$相组合，$B$接在A后面所需的最小代价就是2。</p><p>然后我们需要在这个无向图任取一个起点上走$m-1$条边，使起点的长度+图中跑出来的代价最小。</p><p>观察我们$dp$的转移方程：$\ \forall i,j,k \rarr f[i][j]=\min (f[i][k]+f[k][j])$。</p><p>这个东西显然就是一个矩阵乘，写个矩阵加速幂就结束了。</p><p>复杂度为$O(n^2\sum len + n^3 \log m)$的，可以使用$hash$做到$O(n^2\log \sum len + n^3 \log m)$。</p><p>坑点：</p><ul><li>需要$long \ long$。</li><li>从$i$和$i$的代价为$len[i]-ne[i][len[i]]$。</li></ul><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">200</span> + <span class="number">5</span>, M = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">2017</span>;</span><br><span class="line"><span class="keyword">const</span> LL Inf = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">int</span> n, m, t;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    LL a[N][N];</span><br><span class="line">    Node <span class="keyword">operator</span>* (Node b)</span><br><span class="line">    &#123;</span><br><span class="line">        Node c;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++) c.a[i][j] = Inf;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= n;k ++) </span><br><span class="line">                    c.a[i][j] = <span class="built_in">min</span>(c.a[i][j], a[i][k] + b.a[k][j]);</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;b;</span><br><span class="line"><span class="keyword">char</span> s[N][M];</span><br><span class="line"><span class="keyword">int</span> ne[N][M], len[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">get_ne</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">2</span>, j = <span class="number">0</span>;i &lt;= len[x];i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j &amp;&amp; s[x][j + <span class="number">1</span>] != s[x][i]) j = ne[x][j];</span><br><span class="line">        <span class="keyword">if</span>(s[x][j + <span class="number">1</span>] == s[x][i]) j ++;</span><br><span class="line">        ne[x][i] = j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">kmp</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= len[x];i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(j &amp;&amp; s[y][j + <span class="number">1</span>] != s[x][i]) j = ne[y][j];</span><br><span class="line">        <span class="keyword">if</span>(s[y][j + <span class="number">1</span>] == s[x][i]) j ++;   </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> j;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">qpow</span><span class="params">(Node x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node res;</span><br><span class="line">    <span class="built_in">memset</span>(res.a, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(res.a));</span><br><span class="line">    <span class="keyword">if</span>(k == <span class="number">0</span>) <span class="keyword">return</span> res;</span><br><span class="line">    res = x, k --;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = res * x;</span><br><span class="line">        x = x * x;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line">LL ans;</span><br><span class="line"><span class="keyword">char</span> c[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">if</span>(m == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s[i] + <span class="number">1</span>), len[i] = <span class="built_in">strlen</span>(s[i] + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">get_ne</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++)</span><br><span class="line">            <span class="keyword">if</span>(i != j) b.a[i][j] = len[j] - <span class="built_in">kmp</span>(i, j);</span><br><span class="line">            <span class="keyword">else</span> b.a[i][j] = len[j] - ne[i][len[j]];</span><br><span class="line">    b = <span class="built_in">qpow</span>(b, m - <span class="number">1</span>);</span><br><span class="line">    ans = Inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++)</span><br><span class="line">            ans = <span class="built_in">min</span>(ans, b.a[i][j] + len[i]);</span><br><span class="line">    <span class="built_in">write</span>(ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> 矩阵快速幂 </tag>
            
            <tag> 字符串 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF1659D</title>
      <link href="/2022/06/04/CF1659D/"/>
      <url>/2022/06/04/CF1659D/</url>
      
        <content type="html"><![CDATA[<p><del>先鸽了</del>，补完了。</p><p>有$O(n)$的做法，不会，就写$n \log n$的。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>首先我们考虑从最后一位开始，逐步确定整个序列。</p><p>为什么这么做呢，主要是因为发现将前面所有数字加起来除以$n$就是这个序列中一的个数，同时，我们看一下最后一位的大小是否大于$n-1$就可以判断最后一位是否存在$1$，然后就可以将最后一次排序的贡献从最后一次排序中删除，依次向前计算即可。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, T, k;</span><br><span class="line"><span class="keyword">int</span> a[N];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> l(x) (x &lt;&lt; 1)</span></span><br><span class="line">    <span class="meta">#<span class="meta-keyword">define</span> r(x) (x &lt;&lt; 1 | 1)</span></span><br><span class="line">    <span class="keyword">int</span> l, r, v, flag;</span><br><span class="line">&#125;tr[N &lt;&lt; <span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].v = tr[<span class="built_in">l</span>(x)].v + tr[<span class="built_in">r</span>(x)].v;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x].v += (tr[x].r - tr[x].l + <span class="number">1</span>) * flag;</span><br><span class="line">    tr[x].flag += flag;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!tr[x].flag) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="built_in">change</span>(<span class="built_in">l</span>(x), tr[x].flag);</span><br><span class="line">    <span class="built_in">change</span>(<span class="built_in">r</span>(x), tr[x].flag);</span><br><span class="line">    tr[x].flag = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tr[x] = &#123;l, r, <span class="number">0</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> tr[x].v = a[l], <span class="built_in"><span class="keyword">void</span></span>();</span><br><span class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">build</span>(x &lt;&lt; <span class="number">1</span>, l, mid);</span><br><span class="line">    <span class="built_in">build</span>(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, mid + <span class="number">1</span>, r);</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= tr[x].l &amp;&amp; tr[x].r &lt;= r) <span class="keyword">return</span> <span class="built_in">change</span>(x, v);</span><br><span class="line">    <span class="built_in">pushdown</span>(x);</span><br><span class="line">    <span class="keyword">int</span> mid = tr[x].l + tr[x].r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) <span class="built_in">modify</span>(x &lt;&lt; <span class="number">1</span>, l, r, v);</span><br><span class="line">    <span class="keyword">if</span>(mid &lt; r) <span class="built_in">modify</span>(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r, v);</span><br><span class="line">    <span class="built_in">pushup</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= tr[x].l &amp;&amp; tr[x].r &lt;= r) <span class="keyword">return</span> tr[x].v;</span><br><span class="line">    <span class="built_in">pushdown</span>(x);</span><br><span class="line">    <span class="keyword">int</span> mid = tr[x].l + tr[x].r &gt;&gt; <span class="number">1</span>, res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(l &lt;= mid) res += <span class="built_in">query</span>(x &lt;&lt; <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">if</span>(r &gt; mid) res += <span class="built_in">query</span>(x &lt;&lt; <span class="number">1</span> | <span class="number">1</span>, l, r);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans[N];</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(T);</span><br><span class="line">    <span class="keyword">while</span>(T --)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">read</span>(n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i]);</span><br><span class="line">        <span class="built_in">build</span>(<span class="number">1</span>, <span class="number">1</span>, n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = n, res = <span class="number">0</span>;i &gt;= <span class="number">1</span>;i --)</span><br><span class="line">        &#123;</span><br><span class="line">            res = <span class="built_in">query</span>(<span class="number">1</span>, <span class="number">1</span>, i) / i;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                ans[i] = res;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(res) <span class="built_in">modify</span>(<span class="number">1</span>, i - res + <span class="number">1</span>, i, <span class="number">-1</span>);</span><br><span class="line">ans[i] = <span class="built_in">query</span>(<span class="number">1</span>, i, i) / (i - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">write</span>(ans[i]), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CF </tag>
            
            <tag> 线段树 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>P4655 [CEOI2017]Building Bridges</title>
      <link href="/2022/05/30/P4655-CEOI2017-Building-Bridges/"/>
      <url>/2022/05/30/P4655-CEOI2017-Building-Bridges/</url>
      
        <content type="html"><![CDATA[<p>精度永远是这么的难调。</p><span id="more"></span><p>$O(n^2)$的暴力<code>dp</code>几乎是送的，不讲。</p><p>设<code>sum[i]</code>表示前<code>i</code>个<code>w</code>的和，<code>f[j]</code>表示以当前点为终点的最优答案。</p><p>所以答案就是：$f(i)= \min (f(j)+sum(i)-sum(j)-w(i)+(h(i)-h(j))^2)$。</p><p>推导一波：<br>$$<br>\begin{aligned}<br>    f(i) - sum + w(i) - h(i)^2 = \min(f(j)-sum(j)-2h(i)h(j)+h(j)^2)<br>\end{aligned}<br>$$<br>令右边这堆东西为 <code>p(j)</code>。</p><p>那么当<code>p(j)&lt;p(k)</code>时：<br>$$<br>\begin{aligned}<br>    p(j)&amp;&lt;p(k) \\<br>    f(j)-sum(j)-2h(i) h(j)+h(j)^2 &amp;&lt; f(k)-sum(k)-2h(i)h(k)+h(k)^2\\<br>    f(j)-sum(j)+h(j)^2-(f(k)-sum(k)+h(k)^2)&amp;&lt;(2h(j)-2h(k))h(i) \\<br>    \frac{f(j)-sum(j)+h(j)^2-(f(k)-sum(k)+h(k)^2)}{2h(j)-2h(k)}&amp;&lt;h(i)<br>\end{aligned}<br>$$<br>这就是很经典的斜率优化$\frac{ \Delta y}{\Delta x}=k$的形式，注意<code>h(i)</code>并不单增，使用<code>cdq</code>分治解决。</p><p>注意精度，凸包形式，斜率不存在的情况。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">const</span> LL Inf = <span class="number">1e18</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> esp = <span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">com</span><span class="params">(<span class="keyword">double</span> x, <span class="keyword">double</span> y)</span> <span class="comment">// here</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">fabs</span>(x - y) &lt;= esp) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; y) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    LL h, sum, f, w, id;</span><br><span class="line">    <span class="keyword">bool</span> <span class="keyword">operator</span>&lt; (Node b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> h &lt; b.h;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;a[N];</span><br><span class="line"><span class="keyword">int</span> hh, tt, q[N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">double</span> <span class="title">get_k</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL x1 = <span class="number">2</span> * a[x].h, x2 = <span class="number">2</span> * a[y].h;</span><br><span class="line">    LL y1 = a[x].f - a[x].sum + a[x].h * a[x].h, y2 = a[y].f - a[y].sum + a[y].h * a[y].h;</span><br><span class="line">    <span class="keyword">if</span>(x1 == x2) <span class="keyword">return</span> y1 &lt; y2 ? Inf : -Inf; <span class="comment">// here</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="keyword">double</span>)(y2 - y1) / (<span class="keyword">double</span>)(x2 - x1);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(hh &lt; tt &amp;&amp; <span class="built_in">com</span>(<span class="built_in">get_k</span>(q[tt], x), <span class="built_in">get_k</span>(q[tt - <span class="number">1</span>], q[tt])) &lt;= <span class="number">0</span>) tt --; <span class="comment">// here</span></span><br><span class="line">    q[++ tt] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">answer</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (a[x].h - a[y].h) * (a[x].h - a[y].h) + a[x].sum - a[y].sum - a[x].w + a[y].f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">cmp_id</span><span class="params">(Node x, Node y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> x.id &lt; y.id;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cdq</span><span class="params">(<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(l == r) <span class="keyword">return</span> ;</span><br><span class="line">    <span class="keyword">int</span> mid = l + r &gt;&gt; <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">cdq</span>(l, mid);</span><br><span class="line">    <span class="built_in">sort</span>(a + l, a + mid + <span class="number">1</span>), <span class="built_in">sort</span>(a + mid + <span class="number">1</span>, a + r + <span class="number">1</span>);</span><br><span class="line">    hh = <span class="number">1</span>, tt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = l;i &lt;= mid;i ++) <span class="built_in">add</span>(i);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = mid + <span class="number">1</span>;i &lt;= r;i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(hh &lt; tt &amp;&amp; <span class="built_in">com</span>(a[i].h, <span class="built_in">get_k</span>(q[hh], q[hh + <span class="number">1</span>])) &gt;= <span class="number">0</span>) hh ++;</span><br><span class="line">        a[i].f = <span class="built_in">min</span>(a[i].f, <span class="built_in">answer</span>(i, q[hh]));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">sort</span>(a + mid + <span class="number">1</span>, a + r + <span class="number">1</span>, cmp_id);</span><br><span class="line">    <span class="built_in">cdq</span>(mid + <span class="number">1</span>, r);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i].h), a[i].f = Inf, a[i].id = i;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i].w), a[i].sum = a[i - <span class="number">1</span>].sum + a[i].w;</span><br><span class="line">    a[<span class="number">1</span>].f = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">cdq</span>(<span class="number">1</span>, n);</span><br><span class="line">    <span class="built_in">write</span>(a[n].f);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> dp </tag>
            
            <tag> 斜率优化 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF662C Binary Table</title>
      <link href="/2022/05/29/CF662C-Binary-Table/"/>
      <url>/2022/05/29/CF662C-Binary-Table/</url>
      
        <content type="html"><![CDATA[<p><code>FWT</code>不会，贺的。</p><span id="more"></span><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>首先我们观察数据范围，发现<code>n</code>和<code>m</code>的范围严重不平衡，得出结论需要枚举每一行是否翻转,提前将每一列状压后我们可以再对每一列贪心，这样就得到了暴力的$O(m2^n)$。</p><p>这个东西发现我们是动不了的，考虑转化这个式子，首先将每一列转化成<code>1</code>的个数最少的状态，枚举每一列显然是不可做的，为了将这个<code>m</code>替换掉，我们将每一行的是否翻转状压成一个二进制数,定义有<code>g(x)</code>个列的状态为<code>F(x)</code>，最后答案就是：$\min(\sum S\sum x [Y=x \ xor \ S]F(Y)*g(x))$，<code>F</code>可以预处理 ，这样枚举的就变成<code>S</code>和<code>x</code>了，复杂度就变为$O(2^{2n})$，但依然无法通过此题。</p><p>再次考虑转化，大佬们都已经看出其中的蹊跷了，这就是<code>FWT</code>模板，套上去就完事了。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">21</span>, M = <span class="number">1e5</span> + <span class="number">5</span>, mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line"><span class="keyword">int</span> a[N][M], b[N];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">1</span> &lt;&lt; N], h[<span class="number">1</span> &lt;&lt; N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">popcount</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = x; i;i -= i &amp; (-i)) cnt ++;</span><br><span class="line"><span class="keyword">return</span> cnt;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">FWT_XOR</span><span class="params">(<span class="keyword">int</span> x[], <span class="keyword">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(op == <span class="number">-1</span>) op = <span class="number">499122177</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; n;i ++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>, a, b;j &lt; (<span class="number">1</span> &lt;&lt; n);j ++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(j &gt;&gt; i &amp; <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">a = x[j], b = x[j | (<span class="number">1</span> &lt;&lt; i)];</span><br><span class="line">x[j] = <span class="number">1ll</span> * (a + b) % mod * op % mod;</span><br><span class="line">x[j | (<span class="number">1</span> &lt;&lt; i)] = <span class="number">1ll</span> * (a - b + mod) % mod * op % mod;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> ans = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="built_in">read</span>(n, m);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= m;j ++)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line"><span class="keyword">while</span>(c != <span class="string">&#x27;0&#x27;</span> &amp;&amp; c != <span class="string">&#x27;1&#x27;</span>) c = <span class="built_in">getchar</span>();</span><br><span class="line">a[i][j] = c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i ++)</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++)</span><br><span class="line">b[i] = (b[i] &lt;&lt; <span class="number">1</span>) + a[j][i];</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= m;i ++) f[b[i]] ++;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">1</span> &lt;&lt; n;i ++) h[i] = <span class="built_in">popcount</span>(i);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; <span class="number">1</span> &lt;&lt; n;i ++) h[i] = <span class="built_in">min</span>(h[i], n - h[i]);</span><br><span class="line"><span class="built_in">FWT_XOR</span>(f, <span class="number">1</span>), <span class="built_in">FWT_XOR</span>(h, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (<span class="number">1</span> &lt;&lt; n);i ++) f[i] = <span class="number">1ll</span> * f[i] * h[i] % mod;</span><br><span class="line"><span class="built_in">FWT_XOR</span>(f, <span class="number">-1</span>);</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; (<span class="number">1</span> &lt;&lt; n);i ++) ans = <span class="built_in">min</span>(ans, f[i]);</span><br><span class="line"><span class="built_in">write</span>(ans);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> FWT </tag>
            
            <tag> 多项式 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CF451E Devu and Flowers</title>
      <link href="/2022/05/27/CF451E-Devu-and-Flowers/"/>
      <url>/2022/05/27/CF451E-Devu-and-Flowers/</url>
      
        <content type="html"><![CDATA[<p><code>MlKE</code>永远的神。</p>  <span id="more"></span><p><a href="https://codeforces.com/problemset/problem/451/E">题目链接</a></p><h1 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h1><p>Devu 有 $n$ 个花瓶，第 $i$ 个花瓶里有 $f_i$ 朵花。他现在要选择 $s$ 朵花。</p><p>你需要求出有多少种方案。两种方案不同当且仅当两种方案中至少有一个花瓶选择花的数量不同。</p><p>答案对 $10^9+7$ 取模。</p><p>$1\le n\le 20,0\le f_i\le 10^{12},0\le s\le 10^{14}$</p><h1 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h1><p>首先考虑$ \forall s \le f_i $的情况，很显然这就是多重集的组合数，答案就是$C_{n+s-1}^{s}$，那么现在思考如何消去$s &gt; f_i$ 的影响，我们设：有$x$个花瓶满足这些花瓶取的花至少为$f_i+1$ 的方案数为$num_x$，其中剩下的花在<strong>所有</strong>花瓶中任意取，很明显，这就可能使有$&gt;x$个花瓶超出自身限制，观察范围，发现$n$小的离谱，那么我们考虑容斥解决误差，枚举每个花瓶是否溢出，然后答案就是：$num_0-num_1+num_2…+(-1)^nnum_n$。</p><p>最后在观察式子，发现没有必要将每个$num$都算出来，枚举时减去$x$为奇数的答案，加上$x$为偶数的答案即可。</p><h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> PII pair<span class="meta-string">&lt;int, int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">20</span>, M = (<span class="number">1</span> &lt;&lt; N) + <span class="number">5</span>, mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">int</span> n, m;</span><br><span class="line">LL a[N + <span class="number">5</span>];</span><br><span class="line"><span class="keyword">int</span> ans;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = <span class="number">1ll</span> * x * res % mod;</span><br><span class="line">        x = <span class="number">1ll</span> * x * x % mod;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">C</span><span class="params">(LL x, LL y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &gt; y) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    x = <span class="built_in">min</span>(y - x, x);</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">1</span>, a = <span class="number">1</span>, b = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= x;i ++) a = <span class="number">1ll</span> * a * (y - i + <span class="number">1</span>) % mod, b = <span class="number">1ll</span> * b * i % mod; </span><br><span class="line">    res = <span class="number">1ll</span> * res * a % mod * <span class="built_in">qpow</span>(b, mod - <span class="number">2</span>) % mod;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">lucas</span><span class="params">(LL x, LL y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; mod &amp;&amp; y &lt; mod) <span class="keyword">return</span> <span class="built_in">C</span>(x, y);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1ll</span> * <span class="built_in">lucas</span>(x / mod, y / mod) * <span class="built_in">C</span>(x % mod, y % mod) % mod;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">read</span>(n, m);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++) <span class="built_in">read</span>(a[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>, cnt, sum;i &lt; (<span class="number">1</span> &lt;&lt; n);i ++)</span><br><span class="line">    &#123;</span><br><span class="line">        cnt = sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= n;j ++)</span><br><span class="line">            <span class="keyword">if</span>((i &gt;&gt; j - <span class="number">1</span>) &amp; <span class="number">1</span>) cnt ++, sum += a[j] + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(sum &gt; n + m - <span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt &amp; <span class="number">1</span>) ans = (ans - <span class="built_in">lucas</span>(n - <span class="number">1</span>, m + n - sum - <span class="number">1</span>)) % mod;</span><br><span class="line">        <span class="keyword">else</span> ans = (ans + <span class="built_in">lucas</span>(n - <span class="number">1</span>, n + m - sum - <span class="number">1</span>)) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">write</span>((ans + mod) % mod);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> CF </tag>
            
            <tag> 数学 </tag>
            
            <tag> 容斥 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>数学杂谈</title>
      <link href="/2022/05/23/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%B0%88/"/>
      <url>/2022/05/23/%E6%95%B0%E5%AD%A6%E6%9D%82%E8%B0%88/</url>
      
        <content type="html"><![CDATA[<p><code>MlKE</code>带飞了。</p><span id="more"></span><p>该死的<code>windows</code>更新，把笔记带走了</p><h1 id="可重集的排列"><a href="#可重集的排列" class="headerlink" title="可重集的排列"></a>可重集的排列</h1><h1 id="错排"><a href="#错排" class="headerlink" title="错排"></a>错排</h1><p>对于长度为$n$的排列，问满足$\forall a_i \neq i$的排列个数。</p><h2 id="前置知识：容斥"><a href="#前置知识：容斥" class="headerlink" title="前置知识：容斥"></a>前置知识：容斥</h2><p>简单介绍一下，容斥满足：</p><ul><li>并集形式：$|A_1 \cup A_2 \cup …A_n| = \sum_{1 \le i \le n}|A_i|-\sum_{1 \le i \le j \le n}|A_i\cap A_j| +….(-1)^{n+1}|A_1 \cap A_2 \cap … A_n$</li><li>交集形式：$| C_S^{\cap_{i=1}^n A_i}| = |C_S^{\cup_{i=1}^n A_i}| = |S| - |\cup_{i= 1}^n A_i| = |S| - \sum|A_i| + \sum |A_i \cap A_j| - …+(-1) ^ n| \cap_{i = 1}^n A_i|$</li></ul><h2 id="理解"><a href="#理解" class="headerlink" title="理解"></a>理解</h2><p>首先我们定义$n$个集合，每个集合$A_i$代表满足$a_i=i$的合法方案那么我们的最终方案就是：$C_S^{\cap_{i=1}^n A_i}$。</p><p>对此我们直接用第二个式子暴力展开然后我们惊讶的发现：$ans = |n!| - |C_n^1 (n-1)!| + |C_n^2 (n-2)!| …+(-1)^n|C_n^n1!|$。</p><p>这个东西我们完全可以搞。</p><h1 id="多重集的组合数"><a href="#多重集的组合数" class="headerlink" title="多重集的组合数"></a>多重集的组合数</h1><p>$n$种数，从中选$m$个数，问不同的方案数。</p><p>先记结论：$C_{n+m-1}^m$。</p><p>这个东西比上面那个东西好证。</p><p>首先我们设选出来的数的种类满足：$1 \le a_1 \le a2 … \le a_m \le n$。</p><p>凭着信息学竞赛的直觉（考场上孤注一掷的暴力来看），这东西根本没法搞。</p><p>为什么没法搞呢？因为这些数可以取等，组合数搞不了，再考虑构造。</p><p>对于所有的数，我们加上自身的下标$-1$，令其为$b_i$。</p><p>然后就满足：$1 \le b_1 \le b_2…\le b_m \le n + m - 1$。</p><p>这就是组合数板子了，套公式就解决了。</p><h1 id="卡特兰数"><a href="#卡特兰数" class="headerlink" title="卡特兰数"></a>卡特兰数</h1><h1 id="斐波拉契数列的循环节"><a href="#斐波拉契数列的循环节" class="headerlink" title="斐波拉契数列的循环节"></a>斐波拉契数列的循环节</h1><p>性质：在模$p$意义下斐波拉契的循环节不超过$6p$。</p><h2 id="如何求出循环节"><a href="#如何求出循环节" class="headerlink" title="如何求出循环节"></a>如何求出循环节</h2><p>下面给出两种做法：</p><h3 id="随机法"><a href="#随机法" class="headerlink" title="随机法"></a>随机法</h3><p>考虑在$10^{10}$左右的级别随机出一个数，将其的值和下一个值与第一个值和第二个值进行比对，如果相同，这说明我们找到一个可行的循环节，将其分解质因数，每次检验其因数是否可行即可。</p><p>考虑这样最多会随机多少次，根据生日悖论，期望随机的个数在$\sqrt {6p}$左右。</p><p>贴下代码：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    res = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &gt; c || c &gt; <span class="string">&#x27;9&#x27;</span>) &#123; <span class="keyword">if</span>(c == <span class="string">&#x27;-&#x27;</span>) flag = <span class="number">1</span>; c = <span class="built_in">getchar</span>();&#125;</span><br><span class="line">    <span class="keyword">while</span>(<span class="string">&#x27;0&#x27;</span> &lt;= c &amp;&amp; c &lt;= <span class="string">&#x27;9&#x27;</span>) res = (res &lt;&lt; <span class="number">3</span>) + (res &lt;&lt; <span class="number">1</span>) + (c ^ <span class="number">48</span>), c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">if</span>(flag) res = -res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>, <span class="keyword">class</span> ...<span class="title">Arg</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(T &amp;res, Arg &amp;...com)</span></span>&#123; <span class="built_in">read</span>(res), <span class="built_in">read</span>(com...);&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &gt; <span class="number">9</span>) <span class="built_in">out</span>(res / <span class="number">10</span>);</span><br><span class="line">    <span class="built_in">putchar</span>(res % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(T res)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(res &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), res = -res;</span><br><span class="line">    <span class="built_in">out</span>(res), <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> N = <span class="number">3e7</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> mod;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">    LL a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">    Node <span class="keyword">operator</span>* (Node b)</span><br><span class="line">    &#123;</span><br><span class="line">        Node c;</span><br><span class="line">        <span class="built_in">memset</span>(c.a, <span class="number">0</span>, <span class="built_in"><span class="keyword">sizeof</span></span>(c.a));</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= <span class="number">2</span>;i ++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">1</span>;j &lt;= <span class="number">2</span>;j ++)</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">1</span>;k &lt;= <span class="number">2</span>;k ++)</span><br><span class="line">                    c.a[i][j] = (c.a[i][j] + <span class="number">1ll</span> * a[i][k] * b.a[k][j] % mod) % mod;</span><br><span class="line">        <span class="keyword">return</span> c;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;o;</span><br><span class="line">LL n, len, p = <span class="number">1e11</span>, cnt = <span class="number">0</span>;</span><br><span class="line"><span class="function">mt19937_64 <span class="title">rnd</span><span class="params">(<span class="number">114514</span>)</span></span>;</span><br><span class="line">std::map&lt;std::pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, LL&gt; mp;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> Node <span class="title">qpow</span><span class="params">(Node x, LL k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node res = x;</span><br><span class="line">    k --;</span><br><span class="line">    <span class="keyword">while</span>(k)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(k &amp; <span class="number">1</span>) res = res * x;</span><br><span class="line">        x = x * x;</span><br><span class="line">        k &gt;&gt;= <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    LL ed = <span class="built_in">rnd</span>() % p + <span class="number">10</span>;</span><br><span class="line">    o.a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>, o.a[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    o.a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>, o.a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    o = <span class="built_in">qpow</span>(o, ed - <span class="number">2</span>);</span><br><span class="line">    LL x = (o.a[<span class="number">1</span>][<span class="number">1</span>] + o.a[<span class="number">2</span>][<span class="number">1</span>]) % mod, y = o.a[<span class="number">1</span>][<span class="number">1</span>] % mod;</span><br><span class="line">    <span class="keyword">if</span> (mp[&#123;x, y&#125;] &amp;&amp; mp[&#123;x, y&#125;] != ed) <span class="keyword">return</span> len = std::<span class="built_in">abs</span>(mp[&#123;x, y&#125;] - ed), <span class="literal">true</span>;</span><br><span class="line">    mp[&#123;x, y&#125;] = ed;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line">LL minn;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> LL <span class="title">query</span><span class="params">(LL limit)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (limit &lt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    o.a[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>, o.a[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">    o.a[<span class="number">2</span>][<span class="number">1</span>] = <span class="number">1</span>, o.a[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">0</span>;</span><br><span class="line">    o = <span class="built_in">qpow</span>(o, limit - <span class="number">2</span>);</span><br><span class="line">    LL x = (o.a[<span class="number">1</span>][<span class="number">1</span>] + o.a[<span class="number">2</span>][<span class="number">1</span>]) % mod, y = o.a[<span class="number">1</span>][<span class="number">1</span>] % mod;</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">char</span> c[N];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, c + <span class="number">1</span>), <span class="built_in">read</span>(mod);</span><br><span class="line">    <span class="keyword">if</span>(mod == <span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(!<span class="built_in">check</span>());</span><br><span class="line">    n = <span class="built_in">strlen</span>(c + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(len == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>;i &lt;= n;i ++)</span><br><span class="line">        minn = (minn * <span class="number">10</span> + c[i] - <span class="string">&#x27;0&#x27;</span>) % len;</span><br><span class="line">    <span class="keyword">if</span>(minn == <span class="number">0</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;0&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(minn &lt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;1&quot;</span>), <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">write</span>(<span class="built_in">query</span>(minn));</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="BSGS"><a href="#BSGS" class="headerlink" title="BSGS"></a>BSGS</h3><p>考虑怎么用$BSGS$计算，一般来说题目中的模数都是质数，我们联想到上一个算法中矩阵快速幂，决定在这上面下文章，设转移矩阵为$A$，则我们的式子为：<br>$$<br>A^x \equiv I \pmod{p}<br>$$<br> $I$是单位矩阵，当$A$在模$p$意义下有逆矩阵时，我们就可以用$BSGS$愉快的求解了。</p><h2 id="其他的一些相关性质"><a href="#其他的一些相关性质" class="headerlink" title="其他的一些相关性质"></a>其他的一些相关性质</h2><p>根据网上一些巨佬的博客：</p><p>设其循环节长度为$len$</p><p>若$5$是模$p$意义下的二次剩余：$len  | p-1$</p><p>若$5$不是模$p$意义下的二次剩余：$len|2p+2$</p>]]></content>
      
      
      
        <tags>
            
            <tag> 数学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title></title>
      <link href="/2022/05/04/test/"/>
      <url>/2022/05/04/test/</url>
      
        <content type="html"><![CDATA[<h1 id="数据结构专场"><a href="#数据结构专场" class="headerlink" title="数据结构专场"></a>数据结构专场</h1><span id="more"></span><p>题目很简单，请<code>AK</code>了的童鞋不要大声喧哗，绝对不卡常。 - by <code>l18q</code></p><table><thead><tr><th>题目名称</th><th>贴贴</th><th>迷航</th><th>礼物</th><th>睡觉</th></tr></thead><tbody><tr><td>题目类型</td><td>传统型</td><td>传统型</td><td>传统型</td><td>传统型</td></tr><tr><td>可执行文件名</td><td>teitie</td><td>star</td><td>kgift</td><td>Sleep</td></tr><tr><td>输入文件名</td><td>tietie.in</td><td>star.in</td><td>kgift.in</td><td>Sleep.in</t